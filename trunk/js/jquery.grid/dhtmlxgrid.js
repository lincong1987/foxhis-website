var globalActiveDHTMLGridObject;String.prototype._dhx_trim=function(){return this.replace(/&nbsp;/g," ").replace(/(^[ \t]*)|([ \t]*$)/g,"")};function dhtmlxArray(a){return dhtmlXHeir((a||new Array()),dhtmlxArray._master)}dhtmlxArray._master={_dhx_find:function(b){for(var a=0;a<this.length;a++){if(b==this[a]){return a}}return -1},_dhx_insertAt:function(c,b){this[this.length]=null;for(var a=this.length-1;a>=c;a--){this[a]=this[a-1]}this[c]=b},_dhx_removeAt:function(a){this.splice(a,1)},_dhx_swapItems:function(a,c){var b=this[a];this[a]=this[c];this[c]=b}};function dhtmlXGridObject(d){if(_isIE){try{document.execCommand("BackgroundImageCache",false,true)}catch(b){}}if(d){if(typeof(d)=="object"){this.entBox=d;this.entBox.id="cgrid2_"+this.uid()}else{this.entBox=document.getElementById(d)}}else{this.entBox=document.createElement("DIV");this.entBox.id="cgrid2_"+this.uid()}this.entBox.innerHTML="";dhtmlxEventable(this);var a=this;this._wcorr=0;this.cell=null;this.row=null;this.iconURL="";this.editor=null;this._f2kE=true;this._dclE=true;this.combos=new Array(0);this.defVal=new Array(0);this.rowsAr={};this.rowsBuffer=dhtmlxArray();this.rowsCol=dhtmlxArray();this._data_cache={};this._ecache={};this._ud_enabled=true;this.xmlLoader=new dtmlXMLLoaderObject(this.doLoadDetails,this,true,this.no_cashe);this._maskArr=[];this.selectedRows=dhtmlxArray();this.UserData={};this._sizeFix=this._borderFix=0;this.entBox.className+=" gridbox";this.entBox.style.width=this.entBox.getAttribute("width")||(window.getComputedStyle?(this.entBox.style.width||window.getComputedStyle(this.entBox,null)["width"]):(this.entBox.currentStyle?this.entBox.currentStyle.width:this.entBox.style.width||0))||"100%";this.entBox.style.height=this.entBox.getAttribute("height")||(window.getComputedStyle?(this.entBox.style.height||window.getComputedStyle(this.entBox,null)["height"]):(this.entBox.currentStyle?this.entBox.currentStyle.height:this.entBox.style.height||0))||"100%";this.entBox.style.cursor="default";this.entBox.onselectstart=function(){return false};var c=function(e){var f=document.createElement("TABLE");f.cellSpacing=f.cellPadding=0;f.style.cssText="width:100%;table-layout:fixed;";f.className=e.substr(2);return f};this.obj=c("c_obj");this.hdr=c("c_hdr");this.hdr.style.marginRight="20px";this.hdr.style.paddingRight="20px";this.objBox=document.createElement("DIV");this.objBox.style.width="100%";this.objBox.style.overflow="auto";this.objBox.appendChild(this.obj);this.objBox.className="objbox";this.hdrBox=document.createElement("DIV");this.hdrBox.style.width="100%";this.hdrBox.style.height="25px";this.hdrBox.style.overflow="hidden";this.hdrBox.className="xhdr";this.preloadImagesAr=new Array(0);this.sortImg=document.createElement("IMG");this.sortImg.style.display="none";this.hdrBox.appendChild(this.sortImg);this.hdrBox.appendChild(this.hdr);this.hdrBox.style.position="relative";this.entBox.appendChild(this.hdrBox);this.entBox.appendChild(this.objBox);this.entBox.grid=this;this.objBox.grid=this;this.hdrBox.grid=this;this.obj.grid=this;this.hdr.grid=this;this.cellWidthPX=[];this.cellWidthPC=[];this.cellWidthType=this.entBox.cellwidthtype||"px";this.delim=this.entBox.delimiter||",";this._csvDelim=",";this.hdrLabels=[];this.columnIds=[];this.columnColor=[];this._hrrar=[];this.cellType=dhtmlxArray();this.cellAlign=[];this.initCellWidth=[];this.fldSort=[];this._srdh=(_isIE&&(document.compatMode!="BackCompat")?24:20);this.imgURL=window.dhx_globalImgPath||"";this.isActive=false;this.isEditable=true;this.useImagesInHeader=false;this.pagingOn=false;this.rowsBufferOutSize=0;dhtmlxEvent(window,"unload",function(){try{if(a.destructor){a.destructor()}}catch(f){}});this.setSkin=function(e){this.skin_name=e;this.entBox.className="gridbox gridbox_"+e;this.skin_h_correction=0;this.enableAlterCss("ev_"+e,"odd_"+e,this.isTreeGrid());this._fixAlterCss();switch(e){case"clear":this._topMb=document.createElement("DIV");this._topMb.className="topMumba";this._topMb.innerHTML="<img style='left:0px' src='"+this.imgURL+"skinC_top_left.gif'><img style='right:20px' src='"+this.imgURL+"skinC_top_right.gif'>";this.entBox.appendChild(this._topMb);this._botMb=document.createElement("DIV");this._botMb.className="bottomMumba";this._botMb.innerHTML="<img style='left:0px' src='"+this.imgURL+"skinD_bottom_left.gif'><img style='right:20px' src='"+this.imgURL+"skinD_bottom_right.gif'>";this.entBox.appendChild(this._botMb);this.entBox.style.position="relative";this.skin_h_correction=20;break;case"dhx_skyblue":case"dhx_web":case"glassy_blue":case"dhx_black":case"dhx_blue":case"modern":case"light":this._srdh=20;this.forceDivInHeader=true;break;case"xp":this.forceDivInHeader=true;if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=25}else{this._srdh=22}break;case"mt":if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=25}else{this._srdh=22}break;case"gray":if((_isIE)&&(document.compatMode!="BackCompat")){this._srdh=22}break;case"sbdark":break}if(_isIE&&this.hdr){var f=this.hdr.parentNode;f.removeChild(this.hdr);f.appendChild(this.hdr)}this.setSizes()};if(_isIE){this.preventIECaching(true)}if(window.dhtmlDragAndDropObject){this.dragger=new dhtmlDragAndDropObject()}this._doOnScroll=function(f,g){this.callEvent("onScroll",[this.objBox.scrollLeft,this.objBox.scrollTop]);this.doOnScroll(f,g)};this.doOnScroll=function(f,g){this.hdrBox.scrollLeft=this.objBox.scrollLeft;if(this.ftr){this.ftr.parentNode.scrollLeft=this.objBox.scrollLeft}if(g){return}if(this._srnd){if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}this._dLoadTimer=window.setTimeout(function(){if(a._update_srnd_view){a._update_srnd_view()}},100)}};this.attachToObject=function(e){e.appendChild(this.globalBox?this.globalBox:this.entBox);this.setSizes()};this.init=function(j){if((this.isTreeGrid())&&(!this._h2)){this._h2=new dhtmlxHierarchy();if((this._fake)&&(!this._realfake)){this._fake._h2=this._h2}this._tgc={imgURL:null}}if(!this._hstyles){return}this.editStop();this.lastClicked=null;this.resized=null;this.fldSorted=this.r_fldSorted=null;this.cellWidthPX=[];this.cellWidthPC=[];if(this.hdr.rows.length>0){this.clearAll(true)}var h=this.hdr.insertRow(0);for(var g=0;g<this.hdrLabels.length;g++){h.appendChild(document.createElement("TH"));h.childNodes[g]._cellIndex=g;h.childNodes[g].style.height="0px"}if(_isIE&&_isIE<8){h.style.position="absolute"}else{h.style.height="auto"}var h=this.hdr.insertRow(_isKHTML?2:1);h._childIndexes=new Array();var f=0;for(var g=0;g<this.hdrLabels.length;g++){h._childIndexes[g]=g-f;if((this.hdrLabels[g]==this.splitSign)&&(g!=0)){if(_isKHTML){h.insertCell(g-f)}h.cells[g-f-1].colSpan=(h.cells[g-f-1].colSpan||1)+1;h.childNodes[g-f-1]._cellIndex++;f++;h._childIndexes[g]=g-f;continue}h.insertCell(g-f);h.childNodes[g-f]._cellIndex=g;h.childNodes[g-f]._cellIndexS=g;this.setColumnLabel(g,this.hdrLabels[g])}if(f==0){h._childIndexes=null}this._cCount=this.hdrLabels.length;if(_isIE){window.setTimeout(function(){a.setSizes()},1)}if(!this.obj.firstChild){this.obj.appendChild(document.createElement("TBODY"))}var e=this.obj.firstChild;if(!e.firstChild){e.appendChild(document.createElement("TR"));e=e.firstChild;if(_isIE&&_isIE<8){e.style.position="absolute"}else{e.style.height="auto"}for(var g=0;g<this.hdrLabels.length;g++){e.appendChild(document.createElement("TH"));e.childNodes[g].style.height="0px"}}this._c_order=null;if(this.multiLine!=true){this.obj.className+=" row20px"}this.sortImg.style.position="absolute";this.sortImg.style.display="none";this.sortImg.src=this.imgURL+"sort_desc.gif";this.sortImg.defLeft=0;if(this.noHeader){this.hdrBox.style.display="none"}else{this.noHeader=false}this.attachHeader();this.attachHeader(0,0,"_aFoot");this.setSizes();if(j){this.parseXML()}this.obj.scrollTop=0;if(this.dragAndDropOff){this.dragger.addDragLanding(this.entBox,this)}if(this._initDrF){this._initD()}if(this._init_point){this._init_point()}};this.setColumnSizes=function(k){var l=0;var g=[];for(var f=0;f<this._cCount;f++){if((this.initCellWidth[f]=="*")&&!this._hrrar[f]){this._awdth=false;g.push(f);continue}if(this.cellWidthType=="%"){if(typeof this.cellWidthPC[f]=="undefined"){this.cellWidthPC[f]=this.initCellWidth[f]}this.cellWidthPX[f]=Math.floor(k*this.cellWidthPC[f]/100)||0}else{if(typeof this.cellWidthPX[f]=="undefined"){this.cellWidthPX[f]=this.initCellWidth[f]}}if(!this._hrrar[f]){l+=this.cellWidthPX[f]*1}}if(g.length){var e=Math.floor((k-l)/g.length);if(e<0){e=1}for(var f=0;f<g.length;f++){var h=Math.max((this._drsclmW?this._drsclmW[g[f]]:0),e);this.cellWidthPX[g[f]]=h;l+=h}if(k>l){var j=g[g.length-1];this.cellWidthPX[j]=this.cellWidthPX[j]+(k-l);l=k}this._setAutoResize()}this.obj.style.width=isNaN(l)?"auto":l+"px";this.hdr.style.width=isNaN(l)?"auto":l+"px";if(this.ftr){this.ftr.style.width=isNaN(l)?"auto":l+"px"}this.chngCellWidth();return l};this.setSizes=function(){if((!this.hdr.rows[0])){return}var q=this.quirks=(_isIE&&document.compatMode=="BackCompat");var f=(this.entBox.offsetWidth-this.entBox.clientWidth)/2;if(this.globalBox){var s=(this.globalBox.offsetWidth-this.globalBox.clientWidth)/2;if(this._delta_x&&!this._realfake){var h=this.globalBox.clientWidth;this.globalBox.style.width=this._delta_x;this.entBox.style.width=Math.max(0,(this.globalBox.clientWidth+(q?s*2:0))-this._fake.entBox.clientWidth)+"px";if(h!=this.globalBox.clientWidth){this._fake._correctSplit(this._fake.entBox.clientWidth)}}if(this._delta_y&&!this._realfake){this.globalBox.style.height=this._delta_y;this.entBox.style.overflow=this._fake.entBox.style.overflow="hidden";this.entBox.style.height=this._fake.entBox.style.height=this.globalBox.clientHeight+(q?s*2:0)+"px"}}else{if(this._delta_x){if(this.entBox.parentNode.tagName=="TD"){this.entBox.style.width="1px";this.entBox.style.width=parseInt(this._delta_x)*this.entBox.parentNode.clientWidth/100-f*2+"px"}else{this.entBox.style.width=this._delta_x}}if(this._delta_y){this.entBox.style.height=this._delta_y}}window.clearTimeout(this._sizeTime);if(!this.entBox.offsetWidth&&(!this.globalBox||!this.globalBox.offsetWidth)){this._sizeTime=window.setTimeout(function(){a.setSizes()},250);return}var w=(((this.entBox.cmp||this._delta_x)&&(this.skin_name||"").indexOf("dhx")==0&&!q)?2:0);var v=(((this.entBox.cmp||this._delta_y)&&(this.skin_name||"").indexOf("dhx")==0&&!q)?2:0);var k=this.parentGrid?false:(this.objBox.scrollHeight>this.objBox.offsetHeight);var t=_isFF?18:18;var u=this.entBox.clientWidth-(this.skin_h_correction||0)*(q?0:1)-w;var n=this.entBox.clientWidth-(this.skin_h_correction||0)-w;var m=this.entBox.clientHeight-v;var o=this.setColumnSizes(n-(k?t:0));var j=this.parentGrid?false:((this.objBox.scrollWidth>this.objBox.offsetWidth)||(this.objBox.style.overflowX=="scroll"));var r=this.hdr.clientHeight;var e=this.ftr?this.ftr.clientHeight:0;var l=u;var p=m-r-e;if(this._awdth&&this._awdth[0]&&this._awdth[1]==99999){j=0}if(this._ahgr){if(this._ahgrMA){p=this.entBox.parentNode.clientHeight-r-e}else{p=this.obj.offsetHeight+(j?t:0)}if(this._ahgrM){if(this._ahgrF){p=Math.min(this._ahgrM,p+r+e)-r-e}else{p=Math.min(this._ahgrM,p)}}if(k&&p>=this.obj.scrollHeight+(j?t:0)){k=false;this.setColumnSizes(n)}}if((this._awdth)&&(this._awdth[0])){if(this.cellWidthType=="%"){this.cellWidthType="px"}if(this._fake){o+=this._fake.entBox.clientWidth}var l=Math.min(Math.max(o+(k?t:0),this._awdth[2]),this._awdth[1]);if(this._fake){l-=this._fake.entBox.clientWidth}}p=Math.max(0,p);this._ff_size_delta=(this._ff_size_delta==0.1)?0.2:0.1;if(!_isFF){this._ff_size_delta=0}this.entBox.style.width=l+(q?2:0)*f+this._ff_size_delta+"px";this.entBox.style.height=p+(q?2:0)*f+r+e+"px";this.objBox.style.height=p+((q&&!k)?2:0)*f+"px";this.hdrBox.style.height=r+"px";if(p!=m){this.doOnScroll(0,!this._srnd)}var g=this["setSizes_"+this.skin_name];if(g){g.call(this)}this.setSortImgPos();if(r!=this.hdr.clientHeight&&this._ahgr){this.setSizes()}};this.setSizes_clear=function(){var g=this.hdr.offsetHeight;var e=this.entBox.offsetWidth;var f=g+this.objBox.offsetHeight;this._topMb.style.top=(g||0)+"px";this._topMb.style.width=(e+20)+"px";this._botMb.style.top=(f-3)+"px";this._botMb.style.width=(e+20)+"px"};this.chngCellWidth=function(){if((_isOpera)&&(this.ftr)){this.ftr.width=this.objBox.scrollWidth+"px"}var e=this._cCount;for(var f=0;f<e;f++){this.hdr.rows[0].cells[f].style.width=this.cellWidthPX[f]+"px";this.obj.rows[0].childNodes[f].style.width=this.cellWidthPX[f]+"px";if(this.ftr){this.ftr.rows[0].cells[f].style.width=this.cellWidthPX[f]+"px"}}};this.setDelimiter=function(e){this.delim=e};this.setInitWidthsP=function(e){this.cellWidthType="%";this.initCellWidth=e.split(this.delim.replace(/px/gi,""));if(!arguments[1]){this._setAutoResize()}};this._setAutoResize=function(){if(this._realfake){return}var f=window;var e=this;dhtmlxEvent(window,"resize",function(){window.clearTimeout(e._resize_timer);if(e._setAutoResize){e._resize_timer=window.setTimeout(function(){e.setSizes();if(e._fake){e._fake._correctSplit()}},100)}})};this.setInitWidths=function(f){if(!f||$.trim(f)==""){return false}this.cellWidthType="px";this.initCellWidth=f.split(this.delim);if(_isFF){for(var e=0;e<this.initCellWidth.length;e++){if(this.initCellWidth[e]!="*"){this.initCellWidth[e]=parseInt(this.initCellWidth[e])}}}};this.enableMultiline=function(e){this.multiLine=convertStringToBoolean(e)};this.enableMultiselect=function(e){this.selMultiRows=convertStringToBoolean(e)};this.setImagePath=function(e){this.imgURL=e};this.setImagesPath=this.setImagePath;this.setIconPath=function(e){this.iconURL=e};this.setIconsPath=this.setIconPath;this.changeCursorState=function(g){var f=g.target||g.srcElement;if(f.tagName!="TD"){f=this.getFirstParentOfType(f,"TD")}if(!f){return}if((f.tagName=="TD")&&(this._drsclmn)&&(!this._drsclmn[f._cellIndex])){return f.style.cursor="default"}var e=(g.layerX||0)+(((!_isIE)&&(g.target.tagName=="DIV"))?f.offsetLeft:0);if((f.offsetWidth-(g.offsetX||(parseInt(this.getPosition(f,this.hdrBox))-e)*-1))<(_isOpera?20:10)){f.style.cursor="E-resize"}else{f.style.cursor="default"}if(_isOpera){this.hdrBox.scrollLeft=this.objBox.scrollLeft}};this.startColResize=function(h){if(this.resized){this.stopColResize()}this.resized=null;var g=h.target||h.srcElement;if(g.tagName!="TD"){g=this.getFirstParentOfType(g,"TD")}var e=h.clientX;var j=this.hdr.offsetWidth;var f=parseInt(g.offsetWidth);if(g.tagName=="TD"&&g.style.cursor!="default"){if((this._drsclmn)&&(!this._drsclmn[g._cellIndex])){return}a._old_d_mm=document.body.onmousemove;a._old_d_mu=document.body.onmouseup;document.body.onmousemove=function(k){if(a){a.doColResize(k||window.event,g,f,e,j)}};document.body.onmouseup=function(){if(a){a.stopColResize()}}}};this.stopColResize=function(){document.body.onmousemove=a._old_d_mm||"";document.body.onmouseup=a._old_d_mu||"";this.setSizes();this.doOnScroll(0,1);this.callEvent("onResizeEnd",[this])};this.doColResize=function(k,f,h,l,n){f.style.cursor="E-resize";this.resized=f;var e=h+(k.clientX-l);var j=n+(k.clientX-l);if(!(this.callEvent("onResize",[f._cellIndex,e,this]))){return}if(_isIE){this.objBox.scrollLeft=this.hdrBox.scrollLeft}if(f.colSpan>1){var m=new Array();for(var g=0;g<f.colSpan;g++){m[g]=Math.round(e*this.hdr.rows[0].childNodes[f._cellIndexS+g].offsetWidth/f.offsetWidth)}for(var g=0;g<f.colSpan;g++){this._setColumnSizeR(f._cellIndexS+g*1,m[g])}}else{this._setColumnSizeR(f._cellIndex,e)}this.doOnScroll(0,1);this.setSizes();if(this._fake&&this._awdth){this._fake._correctSplit()}};this._setColumnSizeR=function(e,h){if(h>((this._drsclmW&&!this._notresize)?(this._drsclmW[e]||10):10)){this.obj.rows[0].childNodes[e].style.width=h+"px";this.hdr.rows[0].childNodes[e].style.width=h+"px";if(this.ftr){this.ftr.rows[0].childNodes[e].style.width=h+"px"}if(this.cellWidthType=="px"){this.cellWidthPX[e]=h}else{var f=parseInt(this.entBox.offsetWidth);if(this.objBox.scrollHeight>this.objBox.offsetHeight){f-=17}var g=Math.round(h/f*100);this.cellWidthPC[e]=g}if(this.sortImg.style.display!="none"){this.setSortImgPos()}}};this.setSortImgState=function(j,h,e,k){e=(e||"asc").toLowerCase();if(!convertStringToBoolean(j)){this.sortImg.style.display="none";this.fldSorted=null;return}if(e=="asc"){this.sortImg.src=this.imgURL+"sort_asc.gif"}else{this.sortImg.src=this.imgURL+"sort_desc.gif"}this.sortImg.style.display="";this.fldSorted=this.hdr.rows[0].childNodes[h];var g=this.hdr.rows[k||1];if(!g){return}for(var f=0;f<g.childNodes.length;f++){if(g.childNodes[f]._cellIndexS==h){this.r_fldSorted=g.childNodes[f];return this.setSortImgPos()}}return this.setSortImgState(j,h,e,(k||1)+1)};this.setSortImgPos=function(f,j,h,e){if(this._hrrar&&this._hrrar[this.r_fldSorted?this.r_fldSorted._cellIndex:f]){return}if(!e){if(!f){var e=this.r_fldSorted}else{var e=this.hdr.rows[h||0].cells[f]}}if(e!=null){var k=this.getPosition(e,this.hdrBox);var g=e.offsetWidth;this.sortImg.style.left=Number(k[0]+g-13)+"px";this.sortImg.defLeft=parseInt(this.sortImg.style.left);this.sortImg.style.top=Number(k[1]+5)+"px";if((!this.useImagesInHeader)&&(!j)){this.sortImg.style.display="inline"}this.sortImg.style.left=this.sortImg.defLeft+"px"}};this.setActive=function(e){if(arguments.length==0){var e=true}if(e==true){if(globalActiveDHTMLGridObject&&(globalActiveDHTMLGridObject!=this)){globalActiveDHTMLGridObject.editStop()}globalActiveDHTMLGridObject=this;this.isActive=true}else{this.isActive=false}};this._doClick=function(g){var j=0;var f=this.getFirstParentOfType(_isIE?g.srcElement:g.target,"TD");if(!f){return}var h=true;if(this.markedCells){var e=0;if(g.shiftKey||g.metaKey){e=1}if(g.ctrlKey){e=2}this.doMark(f,e);return true}if(this.selMultiRows!=false){if(g.shiftKey&&this.row!=null){j=1}if(g.ctrlKey||g.metaKey){j=2}}this.doClick(f,h,j)};this._doContClick=function(g){var f=this.getFirstParentOfType(_isIE?g.srcElement:g.target,"TD");if((!f)||(typeof(f.parentNode.idd)=="undefined")){return true}if(g.button==2||(_isMacOS&&g.ctrlKey)){if(!this.callEvent("onRightClick",[f.parentNode.idd,f._cellIndex,g])){var l=function(n){(n||event).cancelBubble=true;return false};(g.srcElement||g.target).oncontextmenu=l;return l(g)}if(this._ctmndx){if(!(this.callEvent("onBeforeContextMenu",[f.parentNode.idd,f._cellIndex,this]))){return true}if(_isIE){g.srcElement.oncontextmenu=function(){event.cancelBubble=true;return false}}if(this._ctmndx.showContextMenu){var k=window.document.documentElement;var h=window.document.body;var j=new Array((k.scrollLeft||h.scrollLeft),(k.scrollTop||h.scrollTop));if(_isIE){var e=g.clientX+j[0];var m=g.clientY+j[1]}else{var e=g.pageX;var m=g.pageY}this._ctmndx.showContextMenu(e-1,m-1);this.contextID=this._ctmndx.contextMenuZoneId=f.parentNode.idd+"_"+f._cellIndex;this._ctmndx._skip_hide=true}else{f.contextMenuId=f.parentNode.idd+"_"+f._cellIndex;f.contextMenu=this._ctmndx;f.a=this._ctmndx._contextStart;f.a(f,g);f.a=null}g.cancelBubble=true;return false}}else{if(this._ctmndx){if(this._ctmndx.hideContextMenu){this._ctmndx.hideContextMenu()}else{this._ctmndx._contextEnd()}}}return true};this.doClick=function(e,l,k,u){if(!this.selMultiRows){k=0}var t=this.row?this.row.idd:0;this.setActive(true);if(!k){k=0}if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"")}if(e.tagName=="TD"){if(this.checkEvent("onSelectStateChanged")){var f=this.getSelectedId()}var w=this.row;if(k==1){var h=this.rowsCol._dhx_find(e.parentNode);var s=this.rowsCol._dhx_find(this.lastClicked);if(h>s){var n=s;var g=h}else{var n=h;var g=s}for(var q=0;q<this.rowsCol.length;q++){if((q>=n&&q<=g)){if(this.rowsCol[q]&&(!this.rowsCol[q]._sRow)){if(this.rowsCol[q].className.indexOf("rowselected")==-1&&this.callEvent("onBeforeSelect",[this.rowsCol[q].idd,t])){this.rowsCol[q].className+=" rowselected";this.selectedRows[this.selectedRows.length]=this.rowsCol[q]}}else{this.clearSelection();return this.doClick(e,l,0,u)}}}}else{if(k==2){if(e.parentNode.className.indexOf("rowselected")!=-1){e.parentNode.className=e.parentNode.className.replace(/rowselected/g,"");this.selectedRows._dhx_removeAt(this.selectedRows._dhx_find(e.parentNode));var r=true}}}this.editStop();if(typeof(e.parentNode.idd)=="undefined"){return true}if((!r)&&(!e.parentNode._sRow)){if(this.callEvent("onBeforeSelect",[e.parentNode.idd,t])){if(k==0){this.clearSelection()}this.cell=e;if((w==e.parentNode)&&(this._chRRS)){l=false}this.row=e.parentNode;this.row.className+=" rowselected";if(this.cell&&_isIE&&_isIE==8){var o=this.cell.nextSibling;var m=this.cell.parentNode;m.removeChild(this.cell);m.insertBefore(this.cell,o)}if(this.selectedRows._dhx_find(this.row)==-1){this.selectedRows[this.selectedRows.length]=this.row}}else{l=false}}if(this.cell&&this.cell.parentNode.className.indexOf("rowselected")!=-1){this.cell.className=this.cell.className.replace(/cellselected/g,"")+" cellselected"}if(k!=1){if(!this.row){return}}this.lastClicked=e.parentNode;var p=this.row.idd;var j=this.cell;if(l&&typeof(p)!="undefined"&&j&&!r){a.onRowSelectTime=setTimeout(function(){a.callEvent("onRowSelect",[p,j._cellIndex])},100)}if(this.checkEvent("onSelectStateChanged")){var v=this.getSelectedId();if(f!=v){this.callEvent("onSelectStateChanged",[v,f])}}}this.isActive=true;if(u!==false&&this.cell&&this.cell.parentNode.idd){this.moveToVisible(this.cell)}};this.selectAll=function(){this.clearSelection();var f=this.rowsBuffer;if(this.pagingOn){f=this.rowsCol}for(var e=0;e<f.length;e++){this._row(e).className+=" rowselected"}this.selectedRows=dhtmlxArray([].concat(f));if(this.selectedRows.length){this.row=this.selectedRows[0];this.cell=this.row.cells[0]}if((this._fake)&&(!this._realfake)){this._fake.selectAll()}};this.selectCell=function(j,f,k,g,h,e){if(!k){k=false}if(typeof(j)!="object"){j=this._row(j)}if(!j||j==-1){return null}var l=j.childNodes[f];if(!l){l=j.childNodes[0]}if(g){this.doClick(l,k,3,e)}else{this.doClick(l,k,0,e)}if(h){this.editCell()}};this.moveToVisible=function(k,m){if(this.pagingOn){var g=Math.floor(this.getRowIndex(k.parentNode.idd)/this.rowsBufferOutSize)+1;if(g!=this.currentPage){this.changePage(g)}}if(!k.offsetHeight&&this._srnd){var o=this._realfake?this._fake.rowsAr[k.parentNode.idd]:k.parentNode;var l=this.rowsBuffer._dhx_find(o)*this._srdh;return this.objBox.scrollTop=l}try{var e=k.offsetLeft+k.offsetWidth+20;var j=0;if(e>(this.objBox.offsetWidth+this.objBox.scrollLeft)){if(k.offsetLeft>this.objBox.scrollLeft){j=k.offsetLeft-5}}else{if(k.offsetLeft<this.objBox.scrollLeft){e-=k.offsetWidth*2/3;if(e<this.objBox.scrollLeft){j=k.offsetLeft-5}}}if((j)&&(!m)){this.objBox.scrollLeft=j}var e=k.offsetTop+k.offsetHeight+20;if(e>(this.objBox.offsetHeight+this.objBox.scrollTop)){var f=e-this.objBox.offsetHeight}else{if(k.offsetTop<this.objBox.scrollTop){var f=k.offsetTop-5}}if(f){this.objBox.scrollTop=f}}catch(n){}};this.editCell=function(){if(this.editor&&this.cell==this.editor.cell){return}this.editStop();if((this.isEditable!=true)||(!this.cell)){return false}var e=this.cell;if(e.parentNode._locked){return false}this.editor=this.cells4(e);if(this.editor!=null){if(this.editor.isDisabled()){this.editor=null;return false}if(this.callEvent("onEditCell",[0,this.row.idd,this.cell._cellIndex])!=false&&this.editor.edit){this._Opera_stop=(new Date).valueOf();e.className+=" editable";this.editor.edit();this.callEvent("onEditCell",[1,this.row.idd,this.cell._cellIndex])}else{this.editor=null}}};this.editStop=function(j){if(_isOpera){if(this._Opera_stop){if((this._Opera_stop*1+50)>(new Date).valueOf()){return}this._Opera_stop=null}}if(this.editor&&this.editor!=null){this.editor.cell.className=this.editor.cell.className.replace("editable","");if(j){var e=this.editor.val;this.editor.detach();this.editor.setValue(e);this.editor=null;return}if(this.editor.detach()){this.cell.wasChanged=true}var f=this.editor;this.editor=null;var h=this.callEvent("onEditCell",[2,this.row.idd,this.cell._cellIndex,f.getValue(),f.val]);if((typeof(h)=="string")||(typeof(h)=="number")){f[f.setImage?"setLabel":"setValue"](h)}else{if(!h){f[f.setImage?"setLabel":"setValue"](f.val)}}if(this._ahgr&&this.multiLine){this.setSizes()}}};this._nextRowCell=function(f,e,g){f=this._nextRow((this._groups?this.rowsCol:this.rowsBuffer)._dhx_find(f),e);if(!f){return null}return f.childNodes[f._childIndexes?f._childIndexes[g]:g]};this._getNextCell=function(h,e,g){h=h||this.cell;var f=h.parentNode;if(this._tabOrder){g=this._tabOrder[h._cellIndex];if(typeof g!="undefined"){if(g<0){h=this._nextRowCell(f,e,Math.abs(g)-1)}else{h=f.childNodes[g]}}}else{var g=h._cellIndex+e;if(g>=0&&g<this._cCount){if(f._childIndexes){g=f._childIndexes[h._cellIndex]+e}h=f.childNodes[g]}else{h=this._nextRowCell(f,e,(e==1?0:(this._cCount-1)))}}if(!h){if((e==1)&&this.tabEnd){this.tabEnd.focus();this.tabEnd.focus();this.setActive(false)}if((e==-1)&&this.tabStart){this.tabStart.focus();this.tabStart.focus();this.setActive(false)}return null}if(h.style.display!="none"&&(!this.smartTabOrder||!this.cells(h.parentNode.idd,h._cellIndex).isDisabled())){return h}return this._getNextCell(h,e)};this._nextRow=function(g,e){var f=this._row(g+e);if(!f||f==-1){return null}if(f&&f.style.display=="none"){return this._nextRow(g+e,e)}return f};this.scrollPage=function(e){if(!this.rowsBuffer.length){return}var f=this._realfake?this._fake:this;var g=Math.floor((f._r_select||this.getRowIndex(this.row.idd)||0)+(e)*this.objBox.offsetHeight/(this._srdh||20));if(g<0){g=0}if(g>=this.rowsBuffer.length){g=this.rowsBuffer.length-1}if(this._srnd&&!this.rowsBuffer[g]){this.objBox.scrollTop+=Math.floor((e)*this.objBox.offsetHeight/(this._srdh||20))*(this._srdh||20);f._r_select=g}else{this.selectCell(g,this.cell._cellIndex,true,false,false,(this.multiLine||this._srnd));if(!this.multiLine&&!this._srnd&&!this._realfake){this.objBox.scrollTop=this.getRowById(this.getRowId(g)).offsetTop}f._r_select=null}};this.doKey=function(g){if(!g){return true}if((g.target||g.srcElement).value!==window.undefined){var e=(g.target||g.srcElement);if((!e.parentNode)||(e.parentNode.className.indexOf("editable")==-1)){return true}}if((globalActiveDHTMLGridObject)&&(this!=globalActiveDHTMLGridObject)){return globalActiveDHTMLGridObject.doKey(g)}if(this.isActive==false){return true}if(this._htkebl){return true}if(!this.callEvent("onKeyPress",[g.keyCode,g.ctrlKey,g.shiftKey,g])){return false}var f="k"+g.keyCode+"_"+(g.ctrlKey?1:0)+"_"+(g.shiftKey?1:0);if(this.cell){if(this._key_events[f]){if(false===this._key_events[f].call(this)){return true}if(g.preventDefault){g.preventDefault()}g.cancelBubble=true;return false}if(this._key_events.k_other){this._key_events.k_other.call(this,g)}}return true};this.selectRow=function(g,h,f,e){if(typeof(g)!="object"){g=this._row(g)}this.selectCell(g,0,h,f,false,e)};this.wasDblClicked=function(f){var e=this.getFirstParentOfType(_isIE?f.srcElement:f.target,"TD");if(e){var g=e.parentNode.idd;return this.callEvent("onRowDblClicked",[g,e._cellIndex,this.opts])}};this._onHeaderClick=function(h,f){var g=this.grid;f=f||g.getFirstParentOfType(_isIE?event.srcElement:h.target,"TD");if(this.grid.resized==null){if(!(this.grid.callEvent("onHeaderClick",[f._cellIndexS,(h||window.event)]))){return false}g.sortField(f._cellIndexS,false,f)}};this.deleteSelectedRows=function(){var f=this.selectedRows.length;if(f==0){return}var e=this.selectedRows;this.selectedRows=dhtmlxArray();for(var g=f-1;g>=0;g--){var h=e[g];if(!this.deleteRow(h.idd,h)){this.selectedRows[this.selectedRows.length]=h}else{if(h==this.row){var j=g}}}if(j){try{if(j+1>this.rowsCol.length){j--}this.selectCell(j,0,true)}catch(k){this.row=null;this.cell=null}}};this.getSelectedRowId=function(){var e=new Array(0);var g={};for(var f=0;f<this.selectedRows.length;f++){var h=this.selectedRows[f].idd;if(g[h]){continue}e[e.length]=h;g[h]=true}if(e.length==0){return null}else{return e.join(this.delim)}};this.getSelectedCellIndex=function(){if(this.cell!=null){return this.cell._cellIndex}else{return -1}};this.getColWidth=function(e){return parseInt(this.cellWidthPX[e])+((_isFF)?2:0)};this.setColWidth=function(f,e){if(this._hrrar[f]){return}if(this.cellWidthType=="px"){this.cellWidthPX[f]=parseInt(e)-+((_isFF)?2:0)}else{this.cellWidthPC[f]=parseInt(e)}this.setSizes()};this.getRowIndex=function(e){for(var f=0;f<this.rowsBuffer.length;f++){if(this.rowsBuffer[f]&&this.rowsBuffer[f].idd==e){return f}}return -1};this.getRowId=function(e){return this.rowsBuffer[e]?this.rowsBuffer[e].idd:this.undefined};this.setRowId=function(f,e){this.changeRowId(this.getRowId(f),e)};this.changeRowId=function(g,j){if(g==j){return}var h=this.rowsAr[g];h.idd=j;if(this.UserData[g]){this.UserData[j]=this.UserData[g];this.UserData[g]=null}if(this._h2&&this._h2.get[g]){this._h2.get[j]=this._h2.get[g];this._h2.get[j].id=j;delete this._h2.get[g]}this.rowsAr[g]=null;this.rowsAr[j]=h;for(var f=0;f<h.childNodes.length;f++){if(h.childNodes[f]._code){h.childNodes[f]._code=this._compileSCL(h.childNodes[f]._val,h.childNodes[f])}}if(this._mat_links&&this._mat_links[g]){var e=this._mat_links[g];delete this._mat_links[g];for(var k in e){for(var f=0;f<e[k].length;f++){this._compileSCL(e[k][f].original,e[k][f])}}}this.callEvent("onRowIdChange",[g,j])};this.setColumnIds=function(e){this.columnIds=e.split(this.delim)};this.setColumnId=function(e,f){this.columnIds[e]=f};this.getColIndexById=function(f){for(var e=0;e<this.columnIds.length;e++){if(this.columnIds[e]==f){return e}}};this.getColumnId=function(e){return this.columnIds[e]};this.getColumnLabel=function(e,g,j){var h=(j||this.hdr).rows[(g||0)+1];for(var f=0;f<h.cells.length;f++){if(h.cells[f]._cellIndexS==e){return(_isIE?h.cells[f].innerText:h.cells[f].textContent)}}return""};this.getColLabel=this.getColumnLabel;this.getFooterLabel=function(e,f){return this.getColumnLabel(e,f,this.ftr)};this.setRowTextBold=function(e){var f=this.getRowById(e);if(f){f.style.fontWeight="bold"}};this.setRowTextStyle=function(f,e){var j=this.getRowById(f);if(!j){return}for(var g=0;g<j.childNodes.length;g++){var h=j.childNodes[g]._attrs.style||"";if(_isIE){j.childNodes[g].style.cssText=h+"width:"+j.childNodes[g].style.width+";"+e}else{j.childNodes[g].style.cssText=h+"width:"+j.childNodes[g].style.width+";"+e}}};this.setRowColor=function(f,e){var h=this.getRowById(f);for(var g=0;g<h.childNodes.length;g++){h.childNodes[g].bgColor=e}};this.setCellTextStyle=function(g,k,f){var j=this.getRowById(g);if(!j){return}var e=j.childNodes[j._childIndexes?j._childIndexes[k]:k];if(!e){return}var h="";if(_isIE){e.style.cssText=h+"width:"+e.style.width+";"+f}else{e.style.cssText=h+"width:"+e.style.width+";"+f}};this.setRowTextNormal=function(e){var f=this.getRowById(e);if(f){f.style.fontWeight="normal"}};this.doesRowExist=function(e){if(this.getRowById(e)!=null){return true}else{return false}};this.getColumnsNum=function(){return this._cCount};this.moveRowUp=function(f){var h=this.getRowById(f);if(this.isTreeGrid()){return this.moveRowUDTG(f,-1)}var e=this.rowsCol._dhx_find(h);if((h.previousSibling)&&(e!=0)){h.parentNode.insertBefore(h,h.previousSibling);this.rowsCol._dhx_swapItems(e,e-1);this.setSizes();var g=this.rowsBuffer._dhx_find(h);this.rowsBuffer._dhx_swapItems(g,g-1);if(this._cssEven){this._fixAlterCss(e-1)}}};this.moveRowDown=function(f){var h=this.getRowById(f);if(this.isTreeGrid()){return this.moveRowUDTG(f,1)}var e=this.rowsCol._dhx_find(h);if(h.nextSibling){this.rowsCol._dhx_swapItems(e,e+1);if(h.nextSibling.nextSibling){h.parentNode.insertBefore(h,h.nextSibling.nextSibling)}else{h.parentNode.appendChild(h)}this.setSizes();var g=this.rowsBuffer._dhx_find(h);this.rowsBuffer._dhx_swapItems(g,g+1);if(this._cssEven){this._fixAlterCss(e)}}};this.getCombo=function(e){if(!this.combos[e]){this.combos[e]=new dhtmlXGridComboObject()}return this.combos[e]};this.setUserData=function(f,e,g){if(!f){f="gridglobaluserdata"}if(!this.UserData[f]){this.UserData[f]=new Hashtable()}this.UserData[f].put(e,g)};this.getUserData=function(f,e){if(!f){f="gridglobaluserdata"}this.getRowById(f);var g=this.UserData[f];return(g?g.get(e):"")};this.setEditable=function(e){this.isEditable=convertStringToBoolean(e)};this.selectRowById=function(f,g,e,h){if(!h){h=false}this.selectCell(this.getRowById(f),0,h,g,false,e)};this.clearSelection=function(){this.editStop();for(var e=0;e<this.selectedRows.length;e++){var f=this.rowsAr[this.selectedRows[e].idd];if(f){f.className=f.className.replace(/rowselected/g,"")}}this.selectedRows=dhtmlxArray();this.row=null;if(this.cell!=null){this.cell.className=this.cell.className.replace(/cellselected/g,"");this.cell=null}};this.copyRowContent=function(g,h){var e=this.getRowById(g);if(!this.isTreeGrid()){for(var f=0;f<e.cells.length;f++){this.cells(h,f).setValue(this.cells(g,f).getValue())}}else{this._copyTreeGridRowContent(e,g,h)}if(!_isIE){this.getRowById(g).cells[0].height=e.cells[0].offsetHeight}};this.setFooterLabel=function(g,e,f){return this.setColumnLabel(g,e,f,this.ftr)};this.setColumnLabel=function(j,n,e,p){var k=(p||this.hdr).rows[e||1];var f=(k._childIndexes?k._childIndexes[j]:j);if(!k.cells[f]){return}if(!this.useImagesInHeader){var h="<div class='hdrcell'>";if(n.indexOf("img:[")!=-1){var g=n.replace(/.*\[([^>]+)\].*/,"$1");n=n.substr(n.indexOf("]")+1,n.length);h+="<img width='18px' height='18px' align='absmiddle' src='"+g+"' hspace='2'>"}h+=n;h+="</div>";k.cells[f].innerHTML=h;if(this._hstyles[f]){k.cells[f].style.cssText=this._hstyles[f]}}else{k.cells[f].style.textAlign="left";k.cells[f].innerHTML="<img src='"+this.imgURL+""+n+"' onerror='this.src = \""+this.imgURL+"imageloaderror.gif\"'>";var m=new Image();m.src=this.imgURL+""+n.replace(/(\.[a-z]+)/,".des$1");this.preloadImagesAr[this.preloadImagesAr.length]=m;var l=new Image();l.src=this.imgURL+""+n.replace(/(\.[a-z]+)/,".asc$1");this.preloadImagesAr[this.preloadImagesAr.length]=l}if((n||"").indexOf("#")!=-1){var q=n.match(/(^|{)#([^}]+)(}|$)/);if(q){var o="_in_header_"+q[2];if(this[o]){this[o]((this.forceDivInHeader?k.cells[f].firstChild:k.cells[f]),f,n.split(q[0]))}}}};this.setColLabel=function(f,e,g,h){return this.setColumnLabel(f,e,(g||0)+1,h)};this.clearAll=function(h){if(!this.obj.rows[0]){return}if(this._h2){this._h2=new dhtmlxHierarchy();if(this._fake){if(this._realfake){this._h2=this._fake._h2}else{this._fake._h2=this._h2}}}this.limit=this._limitC=0;this.editStop(true);if(this._dLoadTimer){window.clearTimeout(this._dLoadTimer)}if(this._dload){this.objBox.scrollTop=0;this.limit=this._limitC||0;this._initDrF=true}var e=this.rowsCol.length;e=this.obj.rows.length;for(var f=e-1;f>0;f--){var g=this.obj.rows[f];g.parentNode.removeChild(g)}if(h){this._master_row=null;this.obj.rows[0].parentNode.removeChild(this.obj.rows[0]);for(var f=this.hdr.rows.length-1;f>=0;f--){var g=this.hdr.rows[f];g.parentNode.removeChild(g)}if(this.ftr){this.ftr.parentNode.removeChild(this.ftr);this.ftr=null}this._aHead=this.ftr=this.cellWidth=this._aFoot=null;this.cellType=dhtmlxArray();this._hrrar=[];this.columnIds=[];this.combos=[]}this.row=null;this.cell=null;this.rowsCol=dhtmlxArray();this.rowsAr=[];this._RaSeCol=[];this.rowsBuffer=dhtmlxArray();this.UserData=[];this.selectedRows=dhtmlxArray();if(this.pagingOn||this._srnd){this.xmlFileUrl=""}if(this.pagingOn){this.changePage(1)}if(this._contextCallTimer){window.clearTimeout(this._contextCallTimer)}if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;this.setSortImgState(false);this.setSizes();this.callEvent("onClearAll",[])};this.sortField=function(h,n,f){if(this.getRowsNum()==0){return false}var g=this.hdr.rows[0].cells[h];if(!g){return}if(g.tagName=="TH"&&(this.fldSort.length-1)>=g._cellIndex&&this.fldSort[g._cellIndex]!="na"){var k=this.getSortingState();var j=(k[0]==h&&k[1]=="asc")?"des":"asc";if(!this.callEvent("onBeforeSorting",[h,this.fldSort[h],j])){return}this.sortImg.src=this.imgURL+"sort_"+(j=="asc"?"asc":"desc")+".gif";if(this.useImagesInHeader){var m=this.hdr.rows[1].cells[g._cellIndex].firstChild;if(this.fldSorted!=null){var o=this.hdr.rows[1].cells[this.fldSorted._cellIndex].firstChild;o.src=o.src.replace(/(\.asc\.)|(\.des\.)/,".")}m.src=m.src.replace(/(\.[a-z]+)$/,"."+j+"$1")}this.sortRows(g._cellIndex,this.fldSort[g._cellIndex],j);this.fldSorted=g;this.r_fldSorted=f;var l=this.hdr.rows[1];var l=f.parentNode;var e=l._childIndexes?l._childIndexes[g._cellIndex]:g._cellIndex;this.setSortImgPos(false,false,false,f)}};this.enableHeaderImages=function(e){this.useImagesInHeader=e};this.setHeader=function(h,o,n){if(typeof(h)!="object"){var j=this._eSplit(h)}else{j=[].concat(h)}var e=new Array(0);var f=new dhtmlxArray(0);var m=new Array(0);var l=new Array(0);var g=new Array(0);for(var k=0;k<j.length;k++){e[e.length]=Math.round(100/j.length);f[f.length]="ed";m[m.length]="left";l[l.length]="middle";g[g.length]="na"}this.splitSign=o||"#cspan";this.hdrLabels=j;this.cellWidth=e;if(!this.initCellWidth.length){this.setInitWidthsP(e.join(this.delim),true)}this.cellType=f;this.cellAlign=m;this.cellVAlign=l;this.fldSort=g;this._hstyles=n||[]};this._eSplit=function(g){if(![].push){return g.split(this.delim)}var e="r"+(new Date()).valueOf();var f=this.delim.replace(/([\|\+\*\^])/g,"\\$1");return(g||"").replace(RegExp(f,"g"),e).replace(RegExp("\\\\"+e,"g"),this.delim).split(e)};this.getColType=function(e){return this.cellType[e]};this.getColTypeById=function(e){return this.cellType[this.getColIndexById(e)]};this.setColTypes=function(e){this.cellType=dhtmlxArray(e.split(this.delim));this._strangeParams=new Array();for(var f=0;f<this.cellType.length;f++){if((this.cellType[f].indexOf("[")!=-1)){var g=this.cellType[f].split(/[\[\]]+/g);this.cellType[f]=g[0];this.defVal[f]=g[1];if(g[1].indexOf("=")==0){this.cellType[f]="math";this._strangeParams[f]=g[0]}}if(!window["eXcell_"+this.cellType[f]]){dhtmlxError.throwError("Configuration","Incorrect cell type: "+this.cellType[f],[this,this.cellType[f]])}}};this.setColSorting=function(e){this.fldSort=e.split(this.delim)};this.setColAlign=function(f){this.cellAlign=f.split(this.delim);for(var e=0;e<this.cellAlign.length;e++){this.cellAlign[e]=this.cellAlign[e]._dhx_trim()}};this.setColVAlign=function(e){this.cellVAlign=e.split(this.delim)};this.setNoHeader=function(e){this.noHeader=convertStringToBoolean(e)};this.showRow=function(e){this.getRowById(e);if(this._h2){this.openItem(this._h2.get[e].parent.id)}var f=this.getRowById(e).childNodes[0];while(f&&f.style.display=="none"){f=f.nextSibling}if(f){this.moveToVisible(f,true)}};this.setStyle=function(h,k,g,e){this.ssModifier=[h,k,g,g,e];var f=["#"+this.entBox.id+" table.hdr td","#"+this.entBox.id+" table.obj td","#"+this.entBox.id+" table.obj tr.rowselected td.cellselected","#"+this.entBox.id+" table.obj td.cellselected","#"+this.entBox.id+" table.obj tr.rowselected td"];for(var j=0;j<f.length;j++){if(this.ssModifier[j]){if(_isIE){document.styleSheets[0].addRule(f[j],this.ssModifier[j])}else{document.styleSheets[0].insertRule(f[j]+(" {"+this.ssModifier[j]+" };"),document.styleSheets[0].cssRules.length)}}}};this.setColumnColor=function(e){this.columnColor=e.split(this.delim)};this.enableAlterCss=function(h,e,f,g){if(h||e){this.attachEvent("onGridReconstructed",function(){this._fixAlterCss();if(this._fake){this._fake._fixAlterCss()}})}this._cssSP=f;this._cssSU=g;this._cssEven=h;this._cssUnEven=e};this._fixAlterCss=function(g){if(this._h2&&(this._cssSP||this._cssSU)){return this._fixAlterCssTGR(g)}if(!this._cssEven&&!this._cssUnEven){return}g=g||0;var e=g;for(var f=g;f<this.rowsCol.length;f++){if(!this.rowsCol[f]){continue}if(this.rowsCol[f].style.display!="none"){if(this.rowsCol[f]._cntr){e=1;continue}if(this.rowsCol[f].className.indexOf("rowselected")!=-1){if(e%2==1){this.rowsCol[f].className=this._cssUnEven+" rowselected "+(this.rowsCol[f]._css||"")}else{this.rowsCol[f].className=this._cssEven+" rowselected "+(this.rowsCol[f]._css||"")}}else{if(e%2==1){this.rowsCol[f].className=this._cssUnEven+" "+(this.rowsCol[f]._css||"")}else{this.rowsCol[f].className=this._cssEven+" "+(this.rowsCol[f]._css||"")}}e++}}};this.getPosition=function(j,f){if(!f&&!_isChrome){var k=getOffset(j);return[k.left,k.top]}f=f||document.body;var e=j;var h=0;var g=0;while((e)&&(e!=f)){h+=e.offsetLeft-e.scrollLeft;g+=e.offsetTop-e.scrollTop;e=e.offsetParent}if(f==document.body){if(_isIE){g+=document.body.offsetTop||document.documentElement.offsetTop;h+=document.body.offsetLeft||document.documentElement.offsetLeft}else{if(!_isFF){h+=document.body.offsetLeft;g+=document.body.offsetTop}}}return[h,g]};this.getFirstParentOfType=function(f,e){while(f&&f.tagName!=e&&f.tagName!="BODY"){f=f.parentNode}return f};this.objBox.onscroll=function(){this.grid._doOnScroll()};if((!_isOpera)||(_OperaRv>8.5)){this.hdr.onmousemove=function(f){this.grid.changeCursorState(f||window.event)};this.hdr.onmousedown=function(f){return this.grid.startColResize(f||window.event)}}this.obj.onmousemove=this._drawTooltip;this.obj.onclick=function(f){this.grid._doClick(f||window.event);if(this.grid._sclE){this.grid.editCell(f||window.event)}(f||event).cancelBubble=true};if(_isMacOS){this.entBox.oncontextmenu=function(f){f.cancelBubble=true;f.returnValue=false;return this.grid._doContClick(f||window.event)}}else{this.entBox.onmousedown=function(f){return this.grid._doContClick(f||window.event)};this.entBox.oncontextmenu=function(f){if(this.grid._ctmndx){(f||event).cancelBubble=true}return !this.grid._ctmndx}}this.hdr.onclick=this._onHeaderClick;this.sortImg.onclick=function(){a._onHeaderClick.apply({grid:a},[null,a.r_fldSorted])};this.hdr.ondblclick=this._onHeaderDblClick;if(!document.body._dhtmlxgrid_onkeydown){dhtmlxEvent(document,_isOpera?"keypress":"keydown",function(f){if(globalActiveDHTMLGridObject){return globalActiveDHTMLGridObject.doKey(f||window.event)}});document.body._dhtmlxgrid_onkeydown=true}dhtmlxEvent(document.body,"click",function(){if(a.editStop){a.editStop()}});this.entBox.onbeforeactivate=function(){this._still_active=null;this.grid.setActive();event.cancelBubble=true};this.entBox.onbeforedeactivate=function(){if(this.grid._still_active){this.grid._still_active=null}else{this.grid.isActive=false}event.cancelBubble=true};if(this.entBox.style.height.toString().indexOf("%")!=-1){this._delta_y=this.entBox.style.height}if(this.entBox.style.width.toString().indexOf("%")!=-1){this._delta_x=this.entBox.style.width}if(this._delta_x||this._delta_y){this._setAutoResize()}this.setColHidden=this.setColumnsVisibility;this.enableCollSpan=this.enableColSpan;this.setMultiselect=this.enableMultiselect;this.setMultiLine=this.enableMultiline;this.deleteSelectedItem=this.deleteSelectedRows;this.getSelectedId=this.getSelectedRowId;this.getHeaderCol=this.getColumnLabel;this.isItemExists=this.doesRowExist;this.getColumnCount=this.getColumnsNum;this.setSelectedRow=this.selectRowById;this.setHeaderCol=this.setColumnLabel;this.preventIECashing=this.preventIECaching;this.enableAutoHeigth=this.enableAutoHeight;this.getUID=this.uid;if(dhtmlx.image_path){this.setImagePath(dhtmlx.image_path)}if(dhtmlx.skin){this.setSkin(dhtmlx.skin)}return this}dhtmlXGridObject.prototype={getRowAttribute:function(b,a){return this.getRowById(b)._attrs[a]},setRowAttribute:function(c,a,b){this.getRowById(c)._attrs[a]=b},isTreeGrid:function(){return(this.cellType._dhx_find("tree")!=-1)},setRowHidden:function(g,c){var b=convertStringToBoolean(c);var e=this.getRowById(g);if(!e){return}if(e.expand===""){this.collapseKids(e)}if((c)&&(e.style.display!="none")){e.style.display="none";var d=this.selectedRows._dhx_find(e);if(d!=-1){e.className=e.className.replace("rowselected","");for(var a=0;a<e.childNodes.length;a++){e.childNodes[a].className=e.childNodes[a].className.replace(/cellselected/g,"")}this.selectedRows._dhx_removeAt(d)}this.callEvent("onGridReconstructed",[])}if((!c)&&(e.style.display=="none")){e.style.display="";this.callEvent("onGridReconstructed",[])}this.setSizes()},enableRowsHover:function(b,a){this._unsetRowHover(false,true);this._hvrCss=a;if(convertStringToBoolean(b)){if(!this._elmnh){this.obj._honmousemove=this.obj.onmousemove;this.obj.onmousemove=this._setRowHover;if(_isIE){this.obj.onmouseleave=this._unsetRowHover}else{this.obj.onmouseout=this._unsetRowHover}this._elmnh=true}}else{if(this._elmnh){this.obj.onmousemove=this.obj._honmousemove;if(_isIE){this.obj.onmouseleave=null}else{this.obj.onmouseout=null}this._elmnh=false}}},enableEditEvents:function(b,c,a){this._sclE=convertStringToBoolean(b);this._dclE=convertStringToBoolean(c);this._f2kE=convertStringToBoolean(a)},enableLightMouseNavigation:function(a){if(convertStringToBoolean(a)){if(!this._elmn){this.entBox._onclick=this.entBox.onclick;this.entBox.onclick=function(){return true};this.obj._onclick=this.obj.onclick;this.obj.onclick=function(b){var d=this.grid.getFirstParentOfType(b?b.target:event.srcElement,"TD");if(!d){return}this.grid.editStop();this.grid.doClick(d);this.grid.editCell();(b||event).cancelBubble=true};this.obj._onmousemove=this.obj.onmousemove;this.obj.onmousemove=this._autoMoveSelect;this._elmn=true}}else{if(this._elmn){this.entBox.onclick=this.entBox._onclick;this.obj.onclick=this.obj._onclick;this.obj.onmousemove=this.obj._onmousemove;this._elmn=false}}},_unsetRowHover:function(b,d){if(d){opts=this}else{opts=this.grid}if((opts._lahRw)&&(opts._lahRw!=d)){for(var a=0;a<opts._lahRw.childNodes.length;a++){opts._lahRw.childNodes[a].className=opts._lahRw.childNodes[a].className.replace(opts._hvrCss,"")}opts._lahRw=null}},_setRowHover:function(b){var d=this.grid.getFirstParentOfType(b?b.target:event.srcElement,"TD");if(d&&d.parentNode!=this.grid._lahRw){this.grid._unsetRowHover(0,d);d=d.parentNode;if(!d.idd||d.idd=="__filler__"){return}for(var a=0;a<d.childNodes.length;a++){d.childNodes[a].className+=" "+this.grid._hvrCss}this.grid._lahRw=d}this._honmousemove(b)},_autoMoveSelect:function(a){if(!this.grid.editor){var b=this.grid.getFirstParentOfType(a?a.target:event.srcElement,"TD");if(b.parentNode.idd){this.grid.doClick(b,true,0)}}this._onmousemove(a)},destructor:function(){this.editStop(true);if(this._sizeTime){this._sizeTime=window.clearTimeout(this._sizeTime)}this.entBox.className=(this.entBox.className||"").replace(/gridbox.*/,"");if(this.formInputs){for(var c=0;c<this.formInputs.length;c++){this.parentForm.removeChild(this.formInputs[c])}}var b;this.xmlLoader=this.xmlLoader.destructor();for(var c=0;c<this.rowsCol.length;c++){if(this.rowsCol[c]){this.rowsCol[c].grid=null}}for(c in this.rowsAr){if(this.rowsAr[c]){this.rowsAr[c]=null}}this.rowsCol=new dhtmlxArray();this.rowsAr=new Array();this.entBox.innerHTML="";var d=function(){};this.entBox.onclick=this.entBox.onmousedown=this.entBox.onbeforeactivate=this.entBox.onbeforedeactivate=this.entBox.onbeforedeactivate=this.entBox.onselectstart=d;this.setSizes=this._update_srnd_view=this.callEvent=d;this.entBox.grid=this.objBox.grid=this.hdrBox.grid=this.obj.grid=this.hdr.grid=null;for(b in this){if((this[b])&&(this[b].m_obj)){this[b].m_obj=null}this[b]=null}if(this==globalActiveDHTMLGridObject){globalActiveDHTMLGridObject=null}return null},getSortingState:function(){var a=new Array();if(this.fldSorted){a[0]=this.fldSorted._cellIndex;a[1]=(this.sortImg.src.indexOf("sort_desc.gif")!=-1)?"des":"asc"}return a},enableAutoHeight:function(c,b,a){this._ahgr=convertStringToBoolean(c);this._ahgrF=convertStringToBoolean(a);this._ahgrM=b||null;if(arguments.length==1){this.objBox.style.overflowY=c?"hidden":"auto"}if(b=="auto"){this._ahgrM=null;this._ahgrMA=true;this._setAutoResize()}},enableStableSorting:function(a){this._sst=convertStringToBoolean(a);this.rowsCol.stablesort=function(f){var e=this.length-1;for(var d=0;d<this.length-1;d++){for(var c=0;c<e;c++){if(f(this[c],this[c+1])>0){var b=this[c];this[c]=this[c+1];this[c+1]=b}}e--}}},enableKeyboardSupport:function(a){this._htkebl=!convertStringToBoolean(a)},enableContextMenu:function(a){this._ctmndx=a},setScrollbarWidthCorrection:function(a){},enableTooltips:function(b){this._enbTts=b.split(",");for(var a=0;a<this._enbTts.length;a++){this._enbTts[a]=convertStringToBoolean(this._enbTts[a])}},enableResizing:function(b){this._drsclmn=b.split(",");for(var a=0;a<this._drsclmn.length;a++){this._drsclmn[a]=convertStringToBoolean(this._drsclmn[a])}},setColumnMinWidth:function(a,b){if(arguments.length==2){if(!this._drsclmW){this._drsclmW=new Array()}this._drsclmW[b]=a}else{this._drsclmW=a.split(",")}},enableCellIds:function(a){this._enbCid=convertStringToBoolean(a)},lockRow:function(a,c){var b=this.getRowById(a);if(b){b._locked=convertStringToBoolean(c);if((this.cell)&&(this.cell.parentNode.idd==a)){this.editStop()}}},_getRowArray:function(e){var d=new Array();for(var c=0;c<e.childNodes.length;c++){var b=this.cells3(e,c);d[c]=b.getValue()}return d},_launchCommands:function(a){for(var d=0;d<a.length;d++){var c=new Array();for(var b=0;b<a[d].childNodes.length;b++){if(a[d].childNodes[b].nodeType==1){c[c.length]=a[d].childNodes[b].firstChild.data}}this[a[d].getAttribute("command")].apply(this,c)}},_parseHead:function(r){var g=this.xmlLoader.doXPath("./head",r);if(g.length){var b=this.xmlLoader.doXPath("./column",g[0]);var k=this.xmlLoader.doXPath("./settings",g[0]);var l="setInitWidths";var o=false;if(k[0]){for(var t=0;t<k[0].childNodes.length;t++){switch(k[0].childNodes[t].tagName){case"colwidth":if(k[0].childNodes[t].firstChild&&k[0].childNodes[t].firstChild.data=="%"){l="setInitWidthsP"}break;case"splitat":o=(k[0].childNodes[t].firstChild?k[0].childNodes[t].firstChild.data:false);break}}}this._launchCommands(this.xmlLoader.doXPath("./beforeInit/call",g[0]));if(b.length>0){if(this.hdr.rows.length>0){this.clearAll(true)}var n=[[],[],[],[],[],[],[],[],[]];var p=["","width","type","align","sort","color","format","hidden","id"];var q=["",l,"setColTypes","setColAlign","setColSorting","setColumnColor","","","setColumnIds"];for(var h=0;h<b.length;h++){for(var f=1;f<p.length;f++){n[f].push(b[h].getAttribute(p[f]))}n[0].push((b[h].firstChild?b[h].firstChild.data:"").replace(/^\s*((\s\S)*.+)\s*$/gi,"$1"))}this.setHeader(n[0]);for(var h=0;h<q.length;h++){if(q[h]){this[q[h]](n[h].join(this.delim))}}for(var h=0;h<b.length;h++){if((this.cellType[h].indexOf("co")==0)||(this.cellType[h]=="clist")){var e=this.xmlLoader.doXPath("./option",b[h]);if(e.length){var a=new Array();if(this.cellType[h]=="clist"){for(var f=0;f<e.length;f++){a[a.length]=e[f].firstChild?e[f].firstChild.data:""}this.registerCList(h,a)}else{var c=this.getCombo(h);for(var f=0;f<e.length;f++){c.put(e[f].getAttribute("value"),e[f].firstChild?e[f].firstChild.data:"")}}}}else{if(n[6][h]){if((this.cellType[h].toLowerCase().indexOf("calendar")!=-1)||(this.fldSort[h]=="date")){this.setDateFormat(n[6][h])}else{this.setNumberFormat(n[6][h],h)}}}}this.init();var d=n[7].join(this.delim);if(this.setColHidden&&d.replace(/,/g,"")!=""){this.setColHidden(d)}if((o)&&(this.splitAt)){this.splitAt(o)}}this._launchCommands(this.xmlLoader.doXPath("./afterInit/call",g[0]))}var m=this.xmlLoader.doXPath("//rows/userdata",r);if(m.length>0){if(!this.UserData.gridglobaluserdata){this.UserData.gridglobaluserdata=new Hashtable()}for(var f=0;f<m.length;f++){this.UserData.gridglobaluserdata.put(m[f].getAttribute("name"),m[f].firstChild?m[f].firstChild.data:"")}}},getCheckedRows:function(a){var b=new Array();this.forEachRowA(function(c){if(this.cells(c,a).getValue()!=0){b.push(c)}},true);return b.join(",")},checkAll:function(){var b=arguments.length?arguments[0]:1;for(var a=0;a<this.getColumnsNum();a++){if(this.getColType(a)=="ch"){this.setCheckedRows(a,b)}}},uncheckAll:function(){this.checkAll(0)},setCheckedRows:function(b,a){this.forEachRowA(function(c){if(this.cells(c,b).isCheckbox()){this.cells(c,b).setValue(a)}})},_drawTooltip:function(f){var g=this.grid.getFirstParentOfType(f?f.target:event.srcElement,"TD");if(!g||((this.grid.editor)&&(this.grid.editor.cell==g))){return true}var d=g.parentNode;if(!d.idd||d.idd=="__filler__"){return}var b=(f?f.target:event.srcElement);if(d.idd==window.unknown){return true}if(!this.grid.callEvent("onMouseOver",[d.idd,g._cellIndex,(f||window.event)])){return true}if((this.grid._enbTts)&&(!this.grid._enbTts[g._cellIndex])){if(b.title){b.title=""}return true}if(g._cellIndex>=this.grid._cCount){return}var a=this.grid.cells3(d,g._cellIndex);if(!a||!a.cell||!a.cell._attrs){return}if(b._title){a.cell.title=""}if(!a.cell._attrs.title){b._title=true}if(a){b.title=a.cell._attrs.title||(a.getTitle?a.getTitle():(a.getValue()||"").toString().replace(/<[^>]*>/gi,""))}return true},enableCellWidthCorrection:function(a){if(_isFF){this._wcorr=parseInt(a)}},getAllRowIds:function(c){var a=[];for(var b=0;b<this.rowsBuffer.length;b++){if(this.rowsBuffer[b]){a.push(this.rowsBuffer[b].idd)}}return a.join(c||this.delim)},getAllItemIds:function(){return this.getAllRowIds()},preventIECaching:function(a){this.no_cashe=convertStringToBoolean(a);this.xmlLoader.rSeed=this.no_cashe},enableColumnAutoSize:function(a){this._eCAS=convertStringToBoolean(a)},_onHeaderDblClick:function(c){var b=this.grid;var a=b.getFirstParentOfType(_isIE?event.srcElement:c.target,"TD");if(!b._eCAS){return false}b.adjustColumnSize(a._cellIndexS)},adjustColumnSize:function(f,h){if(this._hrrar&&this._hrrar[f]){return}this._notresize=true;var b=0;this._setColumnSizeR(f,20);for(var e=1;e<this.hdr.rows.length;e++){var d=this.hdr.rows[e];d=d.childNodes[(d._childIndexes)?d._childIndexes[f]:f];if((d)&&((!d.colSpan)||(d.colSpan<2))&&d._cellIndex==f){if((d.childNodes[0])&&(d.childNodes[0].className=="hdrcell")){d=d.childNodes[0]}b=Math.max(b,((_isFF||_isOpera)?(d.textContent.length*7):d.scrollWidth))}}var c=this.obj.rows.length;for(var g=1;g<c;g++){var k=this.obj.rows[g];if(!this.rowsAr[k.idd]){continue}if(k._childIndexes&&k._childIndexes[f]!=f||!k.childNodes[f]){continue}if(_isFF||_isOpera||h){k=k.childNodes[f].textContent.length*7}else{k=k.childNodes[f].scrollWidth}if(k>b){b=k}}b+=20+(h||0);this._setColumnSizeR(f,b);this._notresize=false;this.setSizes()},detachHeader:function(a,c){c=c||this.hdr;var b=c.rows[a+1];if(b){b.parentNode.removeChild(b)}this.setSizes()},detachFooter:function(a){this.detachHeader(a,this.ftr)},attachHeader:function(a,d,b){if(typeof(a)=="string"){a=this._eSplit(a)}if(typeof(d)=="string"){d=d.split(this.delim)}b=b||"_aHead";if(this.hdr.rows.length){if(a){this._createHRow([a,d],this[(b=="_aHead")?"hdr":"ftr"])}else{if(this[b]){for(var c=0;c<this[b].length;c++){this.attachHeader.apply(this,this[b][c])}}}}else{if(!this[b]){this[b]=new Array()}this[b][this[b].length]=[a,d,b]}},_createHRow:function(c,l){if(!l){if(this.entBox.style.position!="absolute"){this.entBox.style.position="relative"}var g=document.createElement("DIV");g.className="c_ftr".substr(2);this.entBox.appendChild(g);var o=document.createElement("TABLE");o.cellPadding=o.cellSpacing=0;if(!_isIE){o.width="100%";o.style.paddingRight="20px"}o.style.marginRight="20px";o.style.tableLayout="fixed";g.appendChild(o);o.appendChild(document.createElement("TBODY"));this.ftr=l=o;var f=o.insertRow(0);var a=((this.hdrLabels.length<=1)?c[0].length:this.hdrLabels.length);for(var d=0;d<a;d++){f.appendChild(document.createElement("TH"));f.childNodes[d]._cellIndex=d}if(_isIE&&_isIE<8){f.style.position="absolute"}else{f.style.height="auto"}}var e=c[1];var g=document.createElement("TR");l.rows[0].parentNode.appendChild(g);for(var d=0;d<c[0].length;d++){if(c[0][d]=="#cspan"){var h=g.cells[g.cells.length-1];h.colSpan=(h.colSpan||1)+1;continue}if((c[0][d]=="#rspan")&&(l.rows.length>1)){var q=l.rows.length-2;var p=false;var h=null;while(!p){var h=l.rows[q];for(var b=0;b<h.cells.length;b++){if(h.cells[b]._cellIndex==d){p=b+1;break}}q--}h=h.cells[p-1];h.rowSpan=(h.rowSpan||1)+1;continue}var k=document.createElement("TD");k._cellIndex=k._cellIndexS=d;if(this._hrrar&&this._hrrar[d]&&!_isIE){k.style.display="none"}if(typeof c[0][d]=="object"){k.appendChild(c[0][d])}else{if(this.forceDivInHeader){k.innerHTML="<div class='hdrcell'>"+(c[0][d]||"&nbsp;")+"</div>"}else{k.innerHTML=(c[0][d]||"&nbsp;")}if((c[0][d]||"").indexOf("#")!=-1){var o=c[0][d].match(/(^|{)#([^}]+)(}|$)/);if(o){var m="_in_header_"+o[2];if(this[m]){this[m]((this.forceDivInHeader?k.firstChild:k),d,c[0][d].split(o[0]))}}}}if(e){k.style.cssText=e[d]}g.appendChild(k)}var n=l;if(_isKHTML){if(l._kTimer){window.clearTimeout(l._kTimer)}l._kTimer=window.setTimeout(function(){l.rows[1].style.display="none";window.setTimeout(function(){l.rows[1].style.display=""},1)},500)}},forEachRow:function(c){for(var b in this.rowsAr){if(this.rowsAr[b]&&this.rowsAr[b].idd){c.apply(this,[this.rowsAr[b].idd])}}},forEachRowA:function(c){for(var b=0;b<this.rowsBuffer.length;b++){if(this.rowsBuffer[b]){c.call(this,this._row(b).idd)}}},forEachCell:function(c,b){var d=this.getRowById(c);if(!d){return}for(var a=0;a<this._cCount;a++){b(this.cells3(d,a),a)}},enableAutoWidth:function(c,a,b){this._awdth=[convertStringToBoolean(c),parseInt(a||99999),parseInt(b||0)];if(arguments.length==1){this.objBox.style.overflowX=c?"hidden":"auto"}},updateFromXML:function(a,d,b,c){if(typeof d=="undefined"){d=true}this._refresh_mode=[true,d,b];this.load(a,c)},_refreshFromXML:function(c){if(this._f_rowsBuffer){this.filterBy(0,"")}reset=false;if(window.eXcell_tree){eXcell_tree.prototype.setValueX=eXcell_tree.prototype.setValue;eXcell_tree.prototype.setValue=function(l){var k=this.grid._h2.get[this.cell.parentNode.idd];if(k&&this.cell.parentNode.valTag){this.setLabel(l)}else{this.setValueX(l)}}}var j=this.cellType._dhx_find("tree");c.getXMLTopNode("rows");var d=c.doXPath("//rows")[0].getAttribute("parent")||0;var f={};if(this._refresh_mode[2]){if(j!=-1){this._h2.forEachChild(d,function(k){f[k.id]=true},this)}else{this.forEachRow(function(k){f[k]=true})}}var h=c.doXPath("//row");for(var b=0;b<h.length;b++){var g=h[b];var a=g.getAttribute("id");f[a]=false;var d=g.parentNode.getAttribute("id")||d;if(this.rowsAr[a]&&this.rowsAr[a].tagName!="TR"){if(this._h2){this._h2.get[a].buff.data=g}else{this.rowsBuffer[this.getRowIndex(a)].data=g}this.rowsAr[a]=g}else{if(this.rowsAr[a]){this._process_xml_row(this.rowsAr[a],g,-1);this._postRowProcessing(this.rowsAr[a],true)}else{if(this._refresh_mode[1]){var e={idd:a,data:g,_parser:this._process_xml_row,_locator:this._get_xml_data};if(this._refresh_mode[1]=="top"){this.rowsBuffer.unshift(e)}else{this.rowsBuffer.push(e)}if(this._h2){reset=true;(this._h2.add(a,(g.parentNode.getAttribute("id")||g.parentNode.getAttribute("parent")))).buff=this.rowsBuffer[this.rowsBuffer.length-1]}this.rowsAr[a]=g;g=this._row(this.rowsBuffer.length-1);this._insertRowAt(g,-1)}}}}if(this._refresh_mode[2]){for(a in f){if(f[a]&&this.rowsAr[a]){this.deleteRow(a)}}}this._refresh_mode=null;if(window.eXcell_tree){eXcell_tree.prototype.setValue=eXcell_tree.prototype.setValueX}if(reset){this._Sort()}if(this._f_rowsBuffer){this._f_rowsBuffer=null;this.filterByAll()}},getCustomCombo:function(c,b){var a=this.cells(c,b).cell;if(!a._combo){a._combo=new dhtmlXGridComboObject()}return a._combo},setTabOrder:function(b){var d=b.split(this.delim);this._tabOrder=[];var a=this._cCount||b.length;for(var c=0;c<a;c++){d[c]={c:parseInt(d[c]),ind:c}}d.sort(function(f,e){return(f.c>e.c?1:-1)});for(var c=0;c<a;c++){if(!d[c+1]||(typeof d[c].c=="undefined")){this._tabOrder[d[c].ind]=(d[0].ind+1)*-1}else{this._tabOrder[d[c].ind]=d[c+1].ind}}},i18n:{loading:"Loading",decimal_separator:".",group_separator:","},_key_events:{k13_1_0:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a+1],this.cell._cellIndex,true)},k13_0_1:function(){var a=this.rowsCol._dhx_find(this.row);this.selectCell(this.rowsCol[a-1],this.cell._cellIndex,true)},k13_0_0:function(){this.editStop();this.callEvent("onEnter",[(this.row?this.row.idd:null),(this.cell?this.cell._cellIndex:null)]);this._still_active=true},k9_0_0:function(){this.editStop();if(!this.callEvent("onTab",[true])){return true}var a=this._getNextCell(null,1);if(a){this.selectCell(a.parentNode,a._cellIndex,(this.row!=a.parentNode),false,true);this._still_active=true}},k9_0_1:function(){this.editStop();if(!this.callEvent("onTab",[false])){return false}var a=this._getNextCell(null,-1);if(a){this.selectCell(a.parentNode,a._cellIndex,(this.row!=a.parentNode),false,true);this._still_active=true}},k113_0_0:function(){if(this._f2kE){this.editCell()}},k32_0_0:function(){var a=this.cells4(this.cell);if(!a.changeState||(a.changeState()===false)){return false}},k27_0_0:function(){this.editStop(true)},k33_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage-1)}else{this.scrollPage(-1)}},k34_0_0:function(){if(this.pagingOn){this.changePage(this.currentPage+1)}else{this.scrollPage(1)}},k37_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.collapseKids(this.row)}else{return false}},k39_0_0:function(){if(!this.editor&&this.isTreeGrid()){this.expandKids(this.row)}else{return false}},k40_0_0:function(){var b=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftNext()}else{if(!this.row.idd){return}var a=Math.max((b._r_select||0),this.getRowIndex(this.row.idd))+1;if(this.rowsBuffer[a]){b._r_select=null;this.selectCell(a,this.cell._cellIndex,true);if(b.pagingOn){b.showRow(b.getRowId(a))}}else{this._key_events.k34_0_0.apply(this,[]);if(this.pagingOn&&this.rowsCol[a]){this.selectCell(a,0,true)}}}this._still_active=true},k38_0_0:function(){var b=this._realfake?this._fake:this;if(this.editor&&this.editor.combo){this.editor.shiftPrev()}else{if(!this.row.idd){return}var a=this.getRowIndex(this.row.idd)+1;if(a!=-1&&(!this.pagingOn||(a!=1))){var c=this._nextRow(a-1,-1);this.selectCell(c,this.cell._cellIndex,true);if(b.pagingOn&&c){b.showRow(c.idd)}}else{this._key_events.k33_0_0.apply(this,[])}}this._still_active=true}},_build_master_row:function(){var c=document.createElement("DIV");var b=["<table><tr>"];for(var a=0;a<this._cCount;a++){b.push("<td></td>")}b.push("</tr></table>");c.innerHTML=b.join("");this._master_row=c.firstChild.rows[0]},_prepareRow:function(a){if(!this._master_row){this._build_master_row()}var c=this._master_row.cloneNode(true);for(var b=0;b<c.childNodes.length;b++){c.childNodes[b]._cellIndex=b;if(this._enbCid){c.childNodes[b].id="c_"+a+"_"+b}if(this.dragAndDropOff){this.dragger.addDraggableItem(c.childNodes[b],this)}}c.idd=a;c.grid=this;return c},_process_jsarray_row:function(b,c){b._attrs={};for(var a=0;a<b.childNodes.length;a++){b.childNodes[a]._attrs={}}this._fillRow(b,(this._c_order?this._swapColumns(c):c));return b},_get_jsarray_data:function(b,a){return b[a]},_process_json_row:function(b,c){b._attrs={};for(var a=0;a<b.childNodes.length;a++){b.childNodes[a]._attrs={}}this._fillRow(b,(this._c_order?this._swapColumns(c.data):c.data));return b},_get_json_data:function(b,a){return b.data[a]},_process_csv_row:function(b,c){b._attrs={};for(var a=0;a<b.childNodes.length;a++){b.childNodes[a]._attrs={}}this._fillRow(b,(this._c_order?this._swapColumns(c.split(this.csv.cell)):c.split(this.csv.cell)));return b},_get_csv_data:function(b,a){return b.split(this.csv.cell)[a]},_process_xml_row:function(a,f){var l=this.xmlLoader.doXPath(this.xml.cell,f);var h=[];a._attrs=this._xml_attrs(f);if(this._ud_enabled){var k=this.xmlLoader.doXPath("./userdata",f);for(var d=k.length-1;d>=0;d--){this.setUserData(a.idd,k[d].getAttribute("name"),k[d].firstChild?k[d].firstChild.data:"")}}for(var c=0;c<l.length;c++){var e=l[this._c_order?this._c_order[c]:c];if(!e){continue}var b=a._childIndexes?a._childIndexes[c]:c;var g=e.getAttribute("type");if(a.childNodes[b]){if(g){a.childNodes[b]._cellType=g}a.childNodes[b]._attrs=this._xml_attrs(e)}if(!e.getAttribute("xmlcontent")){if(e.firstChild){e=e.firstChild.data}else{e=""}}h.push(e)}for(c<l.length;c<a.childNodes.length;c++){a.childNodes[c]._attrs={}}if(a.parentNode&&a.parentNode.tagName=="row"){a._attrs.parent=a.parentNode.getAttribute("idd")}this._fillRow(a,h);return a},_get_xml_data:function(b,a){b=b.firstChild;while(true){if(!b){return""}if(b.tagName=="cell"){a--}if(a<0){break}b=b.nextSibling}return(b.firstChild?b.firstChild.data:"")},render_row:function(e){if(!this.rowsBuffer[e]){return -1}if(this.rowsBuffer[e]._parser){var d=this.rowsBuffer[e];if(this.rowsAr[d.idd]&&this.rowsAr[d.idd].tagName=="TR"){return this.rowsBuffer[e]=this.rowsAr[d.idd]}var f=this._prepareRow(d.idd);this.rowsBuffer[e]=f;this.rowsAr[d.idd]=f;d._parser.call(this,f,d.data);this._postRowProcessing(f);return f}return this.rowsBuffer[e]},_get_cell_value:function(e,d,f){return e._locator?(this._c_order&&(d=this._c_order[d]),e._locator.call(this,e.data,d)):this.cells3(e,d)[f?f:"getValue"]()},sortRows:function(g,f,o){o=(o||"asc").toLowerCase();f=f||this.fldSort[g];g=g||0;if(this.isTreeGrid()){this.sortTreeRows(g,f,o)}else{var n={},m=this.cellType[g],l="getValue";m=="link"&&(l="getContent");if(m=="dhxCalendar"||m=="dhxCalendarA"){l="getDate"}for(var k=0;k<this.rowsBuffer.length;k++){n[this.rowsBuffer[k].idd]=this._get_cell_value(this.rowsBuffer[k],g,l)}this._sortRows(g,f,o,n)}this.callEvent("onAfterSorting",[g,f,o])},_fillRow:function(a,h){if(this.editor){this.editStop()}var e=this.opts.columns||h;var b=this.opts.render;for(var f=0;f<a.childNodes.length;f++){var j=a.childNodes[f]._cellIndex;var d=h[j];var g=d;$.each(h,function(m,l){if(m==e[f]){d=l||"";g=l==null?"":(b[m]?b[m](d,h):l);return false}});var c=this.cells4(a.childNodes[f]);if(c){c.setValue(d);c.setLabel(g)}}return a},_postRowProcessing:function(f,h){if(f._attrs["class"]){f._css=f.className=f._attrs["class"]}if(f._attrs.locked){f._locked=true}if(f._attrs.bgColor){f.bgColor=f._attrs.bgColor}var g=0;for(var b=0;b<f.childNodes.length;b++){var j=f.childNodes[b];var e=j._cellIndex;var d=j._attrs.style||f._attrs.style;if(d){j.style.cssText+=";"+d}if(j._attrs["class"]){j.className=j._attrs["class"]}d=j._attrs.align||this.cellAlign[e];if(d){j.align=d}j.vAlign=j._attrs.valign||this.cellVAlign[e];var a=j._attrs.bgColor||this.columnColor[e];if(a){j.bgColor=a}if(j._attrs.colspan&&!h){this.setColspan(f.idd,b+g,j._attrs.colspan);g+=(j._attrs.colspan-1)}if(this._hrrar&&this._hrrar[e]&&!h){j.style.display="none"}}this.callEvent("onRowCreated",[f.idd,f,null])},param:function(b){var d=[];var e=function(a){return a};function f(a,g){d[d.length]=e(a)+"="+e(g)}if(jQuery.isArray(b)||b.jquery){jQuery.each(b,function(){f(this.name,this.value)})}else{for(var c in b){if(jQuery.isArray(b[c])){jQuery.each(b[c],function(){f(c,this)})}else{f(c,jQuery.isFunction(b[c])?b[c]():b[c])}}}return d.join("&").replace(/%20/g,"+")},load:function(a,c,b){this.callEvent("onXLS",[this]);if(arguments.length==2&&typeof c!="function"){b=c;c=null}b=b||"xml";if(!this.xmlFileUrl){this.xmlFileUrl=a}this._data_type=b;this.requestTime={req:{_start:new Date().getTime(),_end:new Date().getTime()},process:{_start:new Date().getTime(),_end:new Date().getTime()}};this.xmlLoader.onloadAction=function(h,e,k,j,f){if(!h.callEvent){return}f=h["_process_"+b](f);if(!h._contextCallTimer){h.callEvent("onXLE",[h,0,0,f])}var g=this.mainObject;if(c){c(g);c=null}};if(this.opts.pager.method.toUpperCase()=="POST"){this.xmlLoader.loadXML(a,"POST",this.param(this.opts.pager.param))}else{this.xmlLoader.loadXML(a)}$(".dhtmlxGrid_selection").css({width:"0px",height:"0px"})},loadXML:function(a,c){var b=this.mainObject;this.load(a,function(){c(b)},"xml")},parse:function(c,b,a){if(arguments.length==2&&typeof b!="function"){a=b;b=null}a=a||"xml";this._data_type=a;c=this["_process_"+a](c);if(!this._contextCallTimer){this.callEvent("onXLE",[this,0,0,c])}if(b){b(this)}},xml:{top:"rows",row:"./row",cell:"./cell",s_row:"row",s_cell:"cell",row_attrs:[],cell_attrs:[]},csv:{row:"\n",cell:","},_xml_attrs:function(b){var c={};if(b.attributes.length){for(var a=0;a<b.attributes.length;a++){c[b.attributes[a].name]=b.attributes[a].value}}return c},_process_xml:function(a){if(!a.doXPath){var c=new dtmlXMLLoaderObject(function(){});if(typeof a=="string"){c.loadXMLString(a)}else{if(a.responseXML){c.xmlDoc=a}else{c.xmlDoc={}}c.xmlDoc.responseXML=a}a=c}if(this._refresh_mode){return this._refreshFromXML(a)}this._parsing=true;var g=a.getXMLTopNode(this.xml.top);if(g.tagName.toLowerCase()!=this.xml.top){return}this._parseHead(g);var f=a.doXPath(this.xml.row,g);var e=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("pos")||0);var d=parseInt(a.doXPath("//"+this.xml.top)[0].getAttribute("total_count")||0);if(d&&!this.rowsBuffer[d-1]){this.rowsBuffer[d-1]=null}if(this.isTreeGrid()){return this._process_tree_xml(a)}for(var b=0;b<f.length;b++){if(this.rowsBuffer[b+e]){continue}var h=f[b].getAttribute("id")||(b+e+1);this.rowsBuffer[b+e]={idd:h,data:f[b],_parser:this._process_xml_row,_locator:this._get_xml_data};this.rowsAr[h]=f[b]}this._dataset();this._parsing=false;return a.xmlDoc.responseXML?a.xmlDoc.responseXML:a.xmlDoc},_process_jsarray:function(data){this._parsing=true;if(data&&data.xmlDoc){eval("data="+data.xmlDoc.responseText+";")}for(var i=0;i<data.length;i++){var id=i+1;this.rowsBuffer.push({idd:id,data:data[i],_parser:this._process_jsarray_row,_locator:this._get_jsarray_data});this.rowsAr[id]=data[i]}this._dataset();this._parsing=false},_process_csv:function(d){this._parsing=true;if(d.xmlDoc){d=d.xmlDoc.responseText}d=d.replace(/\r/g,"");d=d.split(this.csv.row);if(this._csvHdr){this.clearAll();var c=d.splice(0,1)[0].split(this.csv.cell);if(!this._csvAID){c.splice(0,1)}this.setHeader(c.join(this.delim));this.init()}for(var b=0;b<d.length;b++){if(!d[b]&&b==d.length-1){continue}if(this._csvAID){var e=b+1;this.rowsBuffer.push({idd:e,data:d[b],_parser:this._process_csv_row,_locator:this._get_csv_data})}else{var a=d[b].split(this.csv.cell);var e=a.splice(0,1)[0];this.rowsBuffer.push({idd:e,data:a,_parser:this._process_jsarray_row,_locator:this._get_jsarray_data})}this.rowsAr[e]=d[b]}this._dataset();this._parsing=false},_doPagination:function(C,t){var q=this;var w=[];var x=this._endLoadTime?this._endLoadTime:0;var j=this._startLoadTime?this._startLoadTime:0;this.opts.pager.loadingTime=x-j;var g=this.opts.pager;if(t&&!t.flag){var b=C.xmlDoc&&C.xmlDoc.readyState?C.xmlDoc.readyState:"\u672a\u77e5\u72b6\u6001";var A=C.xmlDoc&&b==4?C.xmlDoc.statusText:"\u672a\u77e5\u9519\u8bef";var s=C.xmlDoc?C.xmlDoc.status:"\u672a\u77e5\u72b6\u6001";$(g.id).html("");if(!window.__GRID_ERROR__){window.__GRID_ERROR__=true}if(window.__GRID_ERROR__&&$.colorboxInited){window.__GRID_ERROR__=false;var d="_err_id_"+new Date().getTime();$(".grid-error-layout").remove();var y=$("<div class='grid-error-layout' id='"+d+"'></div>");var B="<div class='grid-error-content'><div class='grid-error-title'>\u63d0\u793a</div>"+t.e+"</div>";y.append(B);$("body").append(y);var m=$("#"+d);var l=this.opts;$.colorbox({iframe:false,inline:true,href:m,fixed:true,opacity:0.1,scrolling:true,overlayClose:false,title:"<font style='font-size:13px'>\u670d\u52a1\u70ed\u7ebf\uff1a400-888-4636\u3000\u670d\u52a1QQ\u7fa4\uff1a12790338</font>",onOpen:function(){m.fadeIn(0)},onClosed:function(){m.fadeOut(0);l.onErrColorboxClose(m,C,t)},onCleanup:function(){m.fadeOut(0)}});return}this._ERROR_=C;if(!document._GRID_ERROR_INDEX_){document._GRID_ERROR_INDEX_=1}var f=document._GRID_ERROR_INDEX_?document._GRID_ERROR_INDEX_++:0;if(!document._GRID_ERROR_CACHE_){document._GRID_ERROR_CACHE_=[]}document._GRID_ERROR_CACHE_[f]={_GRID_ERROR_INDEX_:f,_ONLOADTIME_:this.opts.pager.loadingTime,_DATA_:C,_objBox:$(this.objBox)};if(!document.__SHOW_GRID_ERROR_BY_INDEX_){document.__SHOW_GRID_ERROR_BY_INDEX_=function(F){$(".GRID_ERROR").remove();var G=document._GRID_ERROR_CACHE_[F];var E="<div class='main GRID_ERROR' id='__SHOW_GRID_ERROR_BY_INDEX_"+F+"' style='position: absolute; display:none; padding:0; margin:0'>							<div><b> &nbsp; &nbsp;\u9519\u8bef\u8be6\u60c5 </b> <a style='color:red' onclick='$(this).parent().parent().slideUp(500, function(){$(this).remove();});' href='javascript:;' >\u5173\u95ed</a><hr></div>							<div><table width='100%'>								<tr>									<th width='100'>\u9519\u8bef\u7d22\u5f15</th><td width='0'>"+F+"</td>								</tr>								<tr>									<th>\u8bf7\u6c42\u5730\u5740</th><td><a target='_blank' href='"+G._DATA_.filePath+"'>"+G._DATA_.filePath+'</a></td>								</tr>								<tr>									<th>\u8bf7\u6c42\u72b6\u6001</th><td><b>readyState:</b> "'+G._DATA_.xmlDoc.readyState+'"<b>status: </b>"'+G._DATA_.xmlDoc.status+'"<b>statusText: </b>"'+G._DATA_.xmlDoc.statusText+'"<br></td>								</tr>								<tr>									<th>\u8bf7\u6c42\u7528\u65f6</th><td>'+G._ONLOADTIME_+"ms</td>								</tr>								<tr>									<th>\u54cd\u5e94\u5185\u5bb9</th><td><div id='_ERROR_responseText' style='overflow-y: auto; '>"+G._DATA_.xmlDoc.responseText+"</div></td>								</tr>							</table></div>						</div>";$("body").append($(E));$("#__SHOW_GRID_ERROR_BY_INDEX_"+F).css({position:"absolute",top:G._objBox.offset().top,left:G._objBox.offset().left,width:G._objBox.width(),height:G._objBox.height(),background:"#fff"});$("#_ERROR_responseText").css({height:G._objBox.height()-68});$("#__SHOW_GRID_ERROR_BY_INDEX_"+F).slideDown()}}var h=$("<div class='dhxlayout_progress dhxlayout_progress_error' id='"+o+"_progress'>								<span class='dhxlayout_progress_error_text'>\u53d1\u751f\u9519\u8bef---\u72b6\u6001:"+A+"; \u54cd\u5e94:"+b+"; HTTP\u72b6\u6001\u4ee3\u7801:"+s+"<a href='javascript:document.__SHOW_GRID_ERROR_BY_INDEX_("+f+");'>\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</a></span>								</div>");var o=$(this.hdrBox).parent().attr("id");h.css({top:$(this.objBox).offset().top,left:$(this.objBox).offset().left,height:$(this.objBox).height(),width:$(this.objBox).width()});$("body").append(h);return false}var a=g.pageStatMessage!=""?'<ul>		<li><a class="pager-first">\u9996\u9875</a></li>		<li><a class="pager-prev">\u4e0a\u4e00\u9875</a></li>		<li><a class="pager-next">\u4e0b\u4e00\u9875</a></li>		<li><a class="pager-last">\u5c3e\u9875</a></li>		<li><input class="pager-input" value="{currentPage}"/><a class="pager-go" type="button" value="go" >go</a></li>		<li><span class="pager-detail">\u5171{total}\u6761\u6570\u636e \u5171{pageCount}\u9875 \u6bcf\u9875{pageSize}\u6761 \u73b0\u5728\u663e\u793a\u7b2c {currentPage} \u9875 {xls}{pdf} {print} {showStatus}</span></li>	</ul>':'<ul>		<li><a class="pager-first">\u9996\u9875</a></li>		<li><a class="pager-prev">\u4e0a\u4e00\u9875</a></li>		<li><a class="pager-next">\u4e0b\u4e00\u9875</a></li>		<li><a class="pager-last">\u5c3e\u9875</a></li>		<li><input class="pager-input" value="{currentPage}"/><a class="pager-go" type="button" value="go" >go</a></li>		<li><span class="pager-detail">'+g.pageStatMessage+" {xls}{pdf} </span></li>	</ul>";this.opts.pager.total=!C[g.record]||C[g.record]==null?0:C[g.record];this.opts.pager.total=C.pagination&&C.pagination.total?C.pagination.total:this.opts.pager.total;this.opts.pager.pageCount=Math.ceil(g.total/g.pageSize);if(g.total==0){g.pageCount=0;g.page=1}var v=parseInt((g.page-1)*g.pageSize)+1;var u=parseInt(v)+parseInt(g.pageSize)-1;if(g.total<u){u=g.total}for(i=v;i<=u;i++){w.push(i)}var p="";if($.isArray(g.pageSizeArray)){$.each(g.pageSizeArray,function(E,F){p+="<option value='"+parseInt(F)+"' "+(F==g.pageSize?"selected":"")+">"+parseInt(F)+"</option>"})}a=a.replace(/{total}/g,g.total).replace(/{currentPage}/g,g.page).replace(/{pageCount}/g,g.pageCount);a=a.replace(/{pageSize}/g,"<select class='grid-pager-pageSizeArray'>"+p+"</select>").replace(/{print}/g,"<span class='grid-print-view'>\u6253\u5370</span>").replace(/{xls}/,g.showToXLS==true?"<span class='grid-toXls'>\u5bfc\u51fa</span>":"").replace(/{pdf}/,g.showToPDF==true?"<span class='grid-toPdf'>PDF</span>":"");if(!window._GRID_FN_){window._GRID_FN_={requestTime:{},showReqDetail:function(){var E=new Date(this.requestTime.req._start);var F=new Date(this.requestTime.req._end);var H=new Date(this.requestTime.process._start);var G=new Date(this.requestTime.process._end);alert("\u8bf7\u6c42\u5f00\u59cb: "+E.toLocaleString()+"\n\u8bf7\u6c42\u7ed3\u675f: "+F.toLocaleString()+"\n\u8bf7\u6c42\u7528\u65f6: "+(F-E)+"ms\n\n\u6570\u636e\u5904\u7406\u5f00\u59cb: "+H.toLocaleString()+"\n\u6570\u636e\u5904\u7406\u7ed3\u675f: "+G.toLocaleString()+"\n\u6570\u636e\u5904\u7406\u7528\u65f6: "+(G-H)+"ms\n")}}}a=typeof(g.showStatus)!="undefined"&&g.showStatus==true?a.replace(/{showStatus}/g,' <span class="grid-print-time-detail" onclick="_GRID_FN_.showReqDetail();">\u8017\u65f6</span> '+(g.loadingTime/1000)+"\u79d2"):a.replace(/{showStatus}/g,"");$(g.id).html(a);var l=this;$(g.id).find(".grid-print-view").bind("click",function(){l.printView()});$(g.id).find(".pager-first").bind("click",function(){l._pageBuilder("first")});$(g.id).find(".pager-prev").bind("click",function(){l._pageBuilder("prev")});$(g.id).find(".pager-next").bind("click",function(){l._pageBuilder("next")});$(g.id).find(".pager-last").bind("click",function(){l._pageBuilder("last")});var n=this.opts.pager.pageCount;$(g.id).find(".grid-pager-pageSizeArray").change(function(){var E=$(g.id).find(".grid-pager-pageSizeArray").val();g.pageSize=parseInt(E);l._pageBuilder("input",1)});$(g.id).find(".pager-go").bind("click",function(){var E=$.trim($(g.id).find(".pager-input").val());if(isNaN(E)||parseInt(E)<=0||(n==1&&parseInt(E)==1)){$(g.id).find(".pager-input").val(1);return false}if(parseInt(E)>n){$(g.id).find(".pager-input").val(n)}l._pageBuilder("input",$(g.id).find(".pager-input").val())});$(g.id).find(".grid-toXls").bind("click",function(){var E=g.xls||{};if(E.url&&E.url!=""){try{q.toExcel(E.url,E.mode||"",E.header||"",E.footer||"",E.rows||"",E.name||"")}catch(F){alert("\u5bfc\u51faexcel\u5931\u8d25\uff0c\u539f\u56e0\u662f"+F.message)}}else{alert("\u5bfc\u51faexcel\u5931\u8d25\uff0c\u8bf7\u6307\u5b9a\u5bfc\u51fa\u8def\u5f84")}});$(g.id).find(".pager-input").focus(function(){$(this).select()}).keydown(function(E){E=E||E.event;if(E.keyCode==13){$(g.id).find(".pager-go").click()}});if(g.page==1){$(g.id).find(".pager-first").addClass("pager-disabled");$(g.id).find(".pager-prev").addClass("pager-disabled")}else{$(g.id).find(".pager-first").removeClass("pager-disabled");$(g.id).find(".pager-prev").removeClass("pager-disabled")}if(g.page==g.pageCount){$(g.id).find(".pager-next").addClass("pager-disabled");$(g.id).find(".pager-last").addClass("pager-disabled")}else{$(g.id).find(".pager-next").removeClass("pager-disabled");$(g.id).find(".pager-last").removeClass("pager-disabled")}if(g.total==0){$(g.id).find(".pager-next, .pager-last, .pager-next, .pager-first").removeClass("pager-disabled").addClass("pager-disabled")}if(this.opts.height=="auto"){var c=this.opts.self,e=$(this.hdr),k=$(this.hdrBox),r=$(this.obj),D=$(this.objBox),z=$(this.obj).height();window.clearInterval(this._autoHeight);this._autoHeight=window.setInterval(function(){k.height(e.height());r.height(z+20);D.height(r.height());setTimeout(function(){$(c).height(r.height()+e.height())},100)},1000)}this.requestTime.process._end=new Date().getTime();_GRID_FN_.requestTime=this.requestTime;return w},_pageBuilder:function(b,d){var f=this.opts.pager;if(f.isChanged==true){if(!confirm(f.isContinueByDataChanged)){return false}else{this.opts.pager.isChanged=false}}f.onLoad(b,d);var a=true;switch(b){case"first":if(f.page==1){a=false;break}this.opts.pager.page=1;break;case"prev":if(f.page==1){a=false;break}if(f.page>1){this.opts.pager.page=parseInt(f.page)-1}break;case"next":if(f.page>=f.pageCount){a=false;break}this.opts.pager.page=parseInt(f.page)+1;break;case"last":if(f.page>=f.pageCount){a=false;break}this.opts.pager.page=f.pageCount;break;case"input":if(!d||isNaN(d)||parseInt(d)>f.pageCount||parseInt(d)<=0){a=false;break}this.opts.pager.page=d;break}if(a==true){$(f.id).html("<ul><li><span class='pager-loading'>"+f.loadingMassage+"</span></li></ul>");var h=$(this.hdrBox).parent().attr("id");var c=$("#"+h+"_progress").length==1?$("#"+h+"_progress"):$("<div class='dhxlayout_progress' id='"+h+"_progress'></div>");c.css({top:$(this.objBox).offset().top,left:$(this.objBox).offset().left,height:$(this.objBox).height(),width:$(this.objBox).width()});$("body").append(c);var g=f.param?$.param(f.param):"";var e=f.method.toUpperCase()=="POST"?f.url+"?"+f.pageParmName+"="+f.page+"&"+f.pagesizeParmName+"="+f.pageSize:f.url+"?"+f.pageParmName+"="+f.page+"&"+f.pagesizeParmName+"="+f.pageSize+"&"+g;this._startLoadTime=new Date().getTime();this.clearAndLoad(e,function(j){f._onSuccess(j);f.onComplete(j,f);j.opts.doBindRowClick(j);c.fadeOut((typeof(f.fadeOut)=="undefined"?500:parseInt(f.fadeOut)),function(){c.remove()})},"json")}},_process_json:function(data){this.requestTime.req._end=new Date().getTime();this.requestTime.process._start=new Date().getTime();this._endLoadTime=new Date().getTime();this._parsing=true;var _f=true;var _error={e:"unknow error",flag:false};if(data&&data.xmlDoc){try{eval("data="+data.xmlDoc.responseText+";")}catch(e){_error.e=e;_f=false}}if(data[this.opts.pager.root]==null){_error.e="\u7cfb\u7edf\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\uff0c\u5982\u591a\u6b21\u4e0d\u6210\u529f\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\u3002";_f=false}data=this.opts.pager.dataFilter(data);if(!_f){this.rowsBuffer={rows:[]};if(this.opts.pagerBuilder==true){this._doPagination(data,_error)}this.opts.pager.onError("{flag:false}",_error);return false}var cacheData=tempData={rows:[]};this.cacheData=tempData;var pagerObj=[];if(this.opts.pagerBuilder==true){pagerObj=this._doPagination(data)}if(data.flag){this.opts.pager.onError(data.flag,_error);this.rowsBuffer={rows:[]};return false}var root=this.opts.pager.root||"rows";$.each(data[root],function(i,n){tempData.rows[i]={data:{},id:null};tempData.rows[i].id=n.id;tempData.rows[i].data=n});data=tempData;this.cacheData=tempData;for(var i=0;i<data.rows.length;i++){var id=data.rows[i].id;data.rows[i]["data"]["_rownum"]=pagerObj[i];this.rowsBuffer.push({idd:id,data:data.rows[i],_parser:this._process_json_row,_locator:this._get_json_data});this.rowsAr[id]=data[i]}this._dataset();this._parsing=false},_autoHeight:null,_dataset:function(c,a){if(this._srnd){if(this._fillers){return this._update_srnd_view()}a=Math.min((this._get_view_size()+(this._srnd_pr||0)),this.rowsBuffer.length)}if(this.pagingOn){c=Math.max((c||0),(this.currentPage-1)*this.rowsBufferOutSize);a=Math.min(this.currentPage*this.rowsBufferOutSize,this.rowsBuffer.length)}else{c=c||0;a=a||this.rowsBuffer.length}for(var b=c;b<a;b++){var e=this._row(b);if(e==-1){if(this.xmlFileUrl){if(this.callEvent("onDynXLS",[b,(this._dpref?this._dpref:(a-b))])){this.load(this.xmlFileUrl+getUrlSymbol(this.xmlFileUrl)+"posStart="+b+"&count="+(this._dpref?this._dpref:(a-b)),this._data_type)}}a=b;break}if(!e.parentNode||!e.parentNode.tagName){this._insertRowAt(e,b);if(e._attrs.selected||e._attrs.select){this.selectRow(e,e._attrs.call?true:false,true);e._attrs.selected=e._attrs.select=null}}if(this._ads_count&&b-c==this._ads_count){var d=this;this._context_parsing=this._context_parsing||this._parsing;return this._contextCallTimer=window.setTimeout(function(){d._contextCallTimer=null;d._dataset(b,a);if(!d._contextCallTimer){if(d._context_parsing){d.callEvent("onXLE",[])}else{d._fixAlterCss()}d.callEvent("onDistributedEnd",[]);d._context_parsing=false}},this._ads_time)}}if(this._srnd&&!this._fillers){this._fillers=[this._add_filler(a,this.rowsBuffer.length-a)]}this.setSizes()},_row:function(b){if(!this.rowsBuffer[b]){return -1}if(this.rowsBuffer[b]._parser){var a=this.rowsBuffer[b];if(this.rowsAr[a.idd]&&this.rowsAr[a.idd].tagName=="TR"){return this.rowsBuffer[b]=this.rowsAr[a.idd]}var c=this._prepareRow(a.idd);this.rowsBuffer[b]=c;this.rowsAr[a.idd]=c;a._parser.call(this,c,a.data);this._postRowProcessing(c);return c}return this.rowsBuffer[b]},_get_cell_value:function(b,a,c){if(b._locator){if(this._c_order){a=this._c_order[a]}return b._locator.call(this,b.data,a)}return this.cells3(b,a)[c?c:"getValue"]()},sortRows:function(c,f,b){b=(b||"asc").toLowerCase();f=(f||this.fldSort[c]);c=c||0;if(this.isTreeGrid()){this.sortTreeRows(c,f,b)}else{var a={};var e=this.cellType[c];var g="getValue";if(e=="link"){g="getContent"}if(e=="dhxCalendar"||e=="dhxCalendarA"){g="getDate"}for(var d=0;d<this.rowsBuffer.length;d++){a[this.rowsBuffer[d].idd]=this._get_cell_value(this.rowsBuffer[d],c,g)}this._sortRows(c,f,b,a)}this.callEvent("onAfterSorting",[c,f,b])},_sortCore:function(c,f,b,a,e){var d="sort";if(this._sst){e.stablesort=this.rowsCol.stablesort;d="stablesort"}if(f=="str"){e[d](function(h,g){if(b=="asc"){return a[h.idd]>a[g.idd]?1:-1}else{return a[h.idd]<a[g.idd]?1:-1}})}else{if(f=="int"){e[d](function(j,h){var g=parseFloat(a[j.idd]);g=isNaN(g)?-99999999999999:g;var k=parseFloat(a[h.idd]);k=isNaN(k)?-99999999999999:k;if(b=="asc"){return g-k}else{return k-g}})}else{if(f=="date"){e[d](function(j,h){var g=Date.parse(a[j.idd])||(Date.parse("01/01/1900"));var k=Date.parse(a[h.idd])||(Date.parse("01/01/1900"));if(b=="asc"){return g-k}else{return k-g}})}}}},_sortRows:function(c,d,b,a){this._sortCore(c,d,b,a,this.rowsBuffer);this._reset_view();this.callEvent("onGridReconstructed",[])},_reset_view:function(c){if(!this.obj.rows[0]){return}var a=this.obj.rows[0].parentNode;var d=a.removeChild(a.childNodes[0],true);if(_isKHTML){for(var b=a.parentNode.childNodes.length-1;b>=0;b--){if(a.parentNode.childNodes[b].tagName=="TR"){a.parentNode.removeChild(a.parentNode.childNodes[b],true)}}}else{if(_isIE){for(var b=a.childNodes.length-1;b>=0;b--){a.childNodes[b].removeNode(true)}}else{a.innerHTML=""}}a.appendChild(d);this.rowsCol=dhtmlxArray();if(this._sst){this.enableStableSorting(true)}this._fillers=this.undefined;if(!c){if(_isIE&&this._srnd){this._dataset()}else{this._dataset()}}},deleteRow:function(b,d){if(!d){d=this.getRowById(b)}if(!d){return}this.editStop();if(!this._realfake){if(this.callEvent("onBeforeRowDeleted",[b])==false){return false}}var a=0;if(this.cellType._dhx_find("tree")!=-1&&!this._realfake){a=this._h2.get[b].parent.id;this._removeTrGrRow(d)}else{if(d.parentNode){d.parentNode.removeChild(d)}var g=this.rowsCol._dhx_find(d);if(g!=-1){this.rowsCol._dhx_removeAt(g)}for(var c=0;c<this.rowsBuffer.length;c++){if(this.rowsBuffer[c]&&this.rowsBuffer[c].idd==b){this.rowsBuffer._dhx_removeAt(c);g=c;break}}}this.rowsAr[b]=null;for(var c=0;c<this.selectedRows.length;c++){if(this.selectedRows[c].idd==b){this.selectedRows._dhx_removeAt(c)}}if(this._srnd){for(var c=0;c<this._fillers.length;c++){var e=this._fillers[c];if(!e){continue}if(e[0]>=g){e[0]=e[0]-1}else{if(e[1]>=g){e[1]=e[1]-1}}}this._update_srnd_view()}if(this.pagingOn){this.changePage()}if(!this._realfake){this.callEvent("onAfterRowDeleted",[b,a])}this.callEvent("onGridReconstructed",[]);if(this._ahgr){this.setSizes()}return true},_addRow:function(a,k,g){if(g==-1||typeof g=="undefined"){g=this.rowsBuffer.length}if(typeof k=="string"){k=k.split(this.delim)}var h=this._prepareRow(a);h._attrs={};for(var b=0;b<h.childNodes.length;b++){h.childNodes[b]._attrs={}}this.rowsAr[h.idd]=h;if(this._h2){this._h2.get[h.idd].buff=h}this._fillRow(h,k);this._postRowProcessing(h);if(this._skipInsert){this._skipInsert=false;return this.rowsAr[h.idd]=h}if(this.pagingOn){this.rowsBuffer._dhx_insertAt(g,h);this.rowsAr[h.idd]=h;return h}if(this._fillers){this.rowsCol._dhx_insertAt(g,null);this.rowsBuffer._dhx_insertAt(g,h);if(this._fake){this._fake.rowsCol._dhx_insertAt(g,null)}this.rowsAr[h.idd]=h;var e=false;for(var c=0;c<this._fillers.length;c++){var d=this._fillers[c];if(d&&d[0]<=g&&(d[0]+d[1])>=g){d[1]=d[1]+1;d[2].firstChild.style.height=parseInt(d[2].firstChild.style.height)+this._srdh+"px";e=true;if(this._fake){this._fake._fillers[c][1]++}}if(d&&d[0]>g){d[0]=d[0]+1;if(this._fake){this._fake._fillers[c][0]++}}}if(!e){this._fillers.push(this._add_filler(g,1,(g==0?{parentNode:this.obj.rows[0].parentNode,nextSibling:(this.rowsCol[1])}:this.rowsCol[g-1])))}return h}this.rowsBuffer._dhx_insertAt(g,h);return this._insertRowAt(h,g)},addRow:function(a,d,c){var b=this._addRow(a,d,c);if(!this.dragContext){this.callEvent("onRowAdded",[a])}if(this.pagingOn){this.changePage(this.currentPage)}if(this._srnd){this._update_srnd_view()}b._added=true;if(this._ahgr){this.setSizes()}this.callEvent("onGridReconstructed",[]);return b},_insertRowAt:function(b,c,a){this.rowsAr[b.idd]=b;if(this._skipInsert){this._skipInsert=false;return b}if((c<0)||((!c)&&(parseInt(c)!==0))){c=this.rowsCol.length}else{if(c>this.rowsCol.length){c=this.rowsCol.length}}if(this._cssEven){if((this._cssSP?this.getLevel(b.idd):c)%2==1){b.className+=" "+this._cssUnEven+(this._cssSU?(" "+this._cssUnEven+"_"+this.getLevel(b.idd)):"")}else{b.className+=" "+this._cssEven+(this._cssSU?(" "+this._cssEven+"_"+this.getLevel(b.idd)):"")}}if(!a){if((c==(this.obj.rows.length-1))||(!this.rowsCol[c])){if(_isKHTML){this.obj.appendChild(b)}else{this.obj.firstChild.appendChild(b)}}else{this.rowsCol[c].parentNode.insertBefore(b,this.rowsCol[c])}}this.rowsCol._dhx_insertAt(c,b);return b},getRowById:function(c){var b=this.rowsAr[c];if(b){if(b.tagName!="TR"){for(var a=0;a<this.rowsBuffer.length;a++){if(this.rowsBuffer[a]&&this.rowsBuffer[a].idd==c){return this._row(a)}}if(this._h2){return this._row(null,b.idd)}}return b}return null},cellById:function(b,a){return this.cells(b,a)},cells:function(d,b){if(arguments.length==0){return this.cells4(this.cell)}else{var e=this.getRowById(d)}var a=(e._childIndexes?e.childNodes[e._childIndexes[b]]:e.childNodes[b]);return this.cells4(a)},cellByIndex:function(b,a){return this.cells2(b,a)},cells2:function(d,b){var e=this._row(d);var a=(e._childIndexes?e.childNodes[e._childIndexes[b]]:e.childNodes[b]);return this.cells4(a)},cells3:function(c,b){var a=(c._childIndexes?c.childNodes[c._childIndexes[b]]:c.childNodes[b]);return this.cells4(a)},cells4:function(a){var b=window["eXcell_"+(a._cellType||this.cellType[a._cellIndex])];if(b){return new b(a)}},cells5:function(a,c){var c=c||(a._cellType||this.cellType[a._cellIndex]);if(!this._ecache[c]){if(!window["eXcell_"+c]){var b=eXcell_ro}else{var b=window["eXcell_"+c]}this._ecache[c]=new b(a)}this._ecache[c].cell=a;return this._ecache[c]},dma:function(a){if(!this._ecache){this._ecache={}}if(a&&!this._dma){this._dma=this.cells4;this.cells4=this.cells5}else{if(!a&&this._dma){this.cells4=this._dma;this._dma=null}}},getRowsNum:function(){return this.rowsBuffer.length},enableEditTabOnly:function(a){if(arguments.length>0){this.smartTabOrder=convertStringToBoolean(a)}else{this.smartTabOrder=true}},setExternalTabOrder:function(c,a){var b=this;this.tabStart=(typeof(c)=="object")?c:document.getElementById(c);this.tabStart.onkeydown=function(f){var d=(f||window.event);if(d.keyCode==9){d.cancelBubble=true;b.selectCell(0,0,0,0,1);if(b.smartTabOrder&&b.cells2(0,0).isDisabled()){b._key_events.k9_0_0.call(b)}this.blur();return false}};if(_isOpera){this.tabStart.onkeypress=this.tabStart.onkeydown}this.tabEnd=(typeof(a)=="object")?a:document.getElementById(a);this.tabEnd.onkeydown=this.tabEnd.onkeypress=function(f){var d=(f||window.event);if((d.keyCode==9)&&d.shiftKey){d.cancelBubble=true;b.selectCell((b.getRowsNum()-1),(b.getColumnCount()-1),0,0,1);if(b.smartTabOrder&&b.cells2((b.getRowsNum()-1),(b.getColumnCount()-1)).isDisabled()){b._key_events.k9_0_1.call(b)}this.blur();return false}};if(_isOpera){this.tabEnd.onkeypress=this.tabEnd.onkeydown}},uid:function(){if(!this._ui_seed){this._ui_seed=(new Date()).valueOf()}return this._ui_seed++},clearAndLoad:function(){var a=this._pgn_skin;this._pgn_skin=null;this.clearAll();this._pgn_skin=a;this._startLoadTime=new Date().getTime();this.load.apply(this,arguments)},getStateOfView:function(){if(this.pagingOn){var a=(this.currentPage-1)*this.rowsBufferOutSize;return[this.currentPage,a,Math.min(a+this.rowsBufferOutSize,this.rowsBuffer.length),this.rowsBuffer.length]}return[Math.floor(this.objBox.scrollTop/this._srdh),Math.ceil(parseInt(this.objBox.offsetHeight)/this._srdh),this.rowsBuffer.length]}};(function(){function d(g,h){this[g]=h}function f(g,h){this[g].call(this,h)}function c(g,h){this[g].call(this,h.join(this.delim))}function a(g,k){for(var j=0;j<k.length;j++){if(typeof k[j]=="object"){var l=this.getCombo(j);for(var h in k[j]){l.put(h,k[j][h])}}}}function e(g,r,n){var t=1;var q=[];function s(k,h,u){if(!q[h]){q[h]=[]}if(typeof u=="object"){u.toString=function(){return this.text}}q[h][k]=u}for(var o=0;o<r.length;o++){if(typeof(r[o])=="object"&&r[o].length){for(var m=0;m<r[o].length;m++){s(o,m,r[o][m])}}else{s(o,0,r[o])}}for(var o=0;o<q.length;o++){for(var m=0;m<q[0].length;m++){var p=q[o][m];q[o][m]=(p||"").toString()||"&nbsp;";if(p&&p.colspan){for(var l=1;l<p.colspan;l++){s(m+l,o,"#cspan")}}if(p&&p.rowspan){for(var l=1;l<p.rowspan;l++){s(m,o+l,"#rspan")}}}}this.setHeader(q[0]);for(var o=1;o<q.length;o++){this.attachHeader(q[o])}}var b=[{name:"label",def:"&nbsp;",operation:"setHeader",type:e},{name:"id",def:"",operation:"columnIds",type:d},{name:"width",def:"*",operation:"setInitWidths",type:c},{name:"align",def:"left",operation:"cellAlign",type:d},{name:"valign",def:"middle",operation:"cellVAlign",type:d},{name:"sort",def:"na",operation:"fldSort",type:d},{name:"type",def:"ro",operation:"setColTypes",type:c},{name:"options",def:"",operation:"",type:a}];dhtmlx.extend_api("dhtmlXGridObject",{_init:function(g){return[g.parent]},image_path:"setImagePath",columns:"columns",rows:"rows",headers:"headers",skin:"setSkin",smart_ing:"enableSmartRendering",css:"enableAlterCss",auto_height:"enableAutoHeight",save_hidden:"enableAutoHiddenColumnsSaving",save_cookie:"enableAutoSaving",save_size:"enableAutoSizeSaving",auto_width:"enableAutoWidth",block_selection:"enableBlockSelection",csv_id:"enableCSVAutoID",csv_header:"enableCSVHeader",cell_ids:"enableCellIds",colspan:"enableColSpan",column_move:"enableColumnMove",context_menu:"enableContextMenu",distributed:"enableDistributedParsing",drag:"enableDragAndDrop",drag_order:"enableDragOrder",tabulation:"enableEditTabOnly",header_images:"enableHeaderImages",header_menu:"enableHeaderMenu",keymap:"enableKeyboardSupport",mouse_navigation:"enableLightMouseNavigation",markers:"enableMarkedCells",math_editing:"enableMathEditing",math_serialization:"enableMathSerialization",drag_copy:"enableMercyDrag",multiline:"enableMultiline",multiselect:"enableMultiselect",save_column_order:"enableOrderSaving",hover:"enableRowsHover",rowspan:"enableRowspan",smart:"enableSmartRendering",save_sorting:"enableSortingSaving",stable_sorting:"enableStableSorting",undo:"enableUndoRedo",csv_cell:"setCSVDelimiter",date_format:"setDateFormat",drag_behavior:"setDragBehavior",editable:"setEditable",without_header:"setNoHeader",submit_changed:"submitOnlyChanged",submit_serialization:"submitSerialization",submit_selected:"submitOnlySelected",submit_id:"submitOnlyRowID",xml:"load"},{columns:function(m){for(var g=0;g<b.length;g++){var l=[];for(var h=0;h<m.length;h++){l[h]=m[h][b[g].name]||b[g].def}var k=b[g].type||f;k.call(this,b[g].operation,l,m)}this.init()},rows:function(g){},attachFooter:function(h,g){this.attachHeader(h,g,"_aFoot")},headers:function(h){for(var g=0;g<h.length;g++){this.attachHeader(h[g])}}})})();dhtmlXGridObject.prototype._dp_init=function(a){a.attachEvent("insertCallback",function(b,d){if(this.obj._h2){this.obj.addRow(d,c,null,parent)}else{this.obj.addRow(d,[],0)}var c=this.obj.getRowById(d);if(c){this.obj._process_xml_row(c,b.firstChild);this.obj._postRowProcessing(c)}});a.attachEvent("updateCallback",function(b,d){var c=this.obj.getRowById(d);if(c){this.obj._process_xml_row(c,b.firstChild);this.obj._postRowProcessing(c)}});a.attachEvent("deleteCallback",function(b,c){this.obj.setUserData(c,this.action_param,"true_deleted");this.obj.deleteRow(c)});a._methods=["setRowTextStyle","setCellTextStyle","changeRowId","deleteRow"];this.attachEvent("onEditCell",function(d,e,c){if(a._columns&&!a._columns[c]){return true}var b=this.cells(e,c);if(d==1){if(b.isCheckbox()){a.setUpdated(e,true)}}else{if(d==2){if(b.wasChanged()){a.setUpdated(e,true)}}}return true});this.attachEvent("onRowPaste",function(b){a.setUpdated(b,true)});this.attachEvent("onRowIdChange",function(d,b){var c=a.findRow(d);if(c<a.updatedRows.length){a.updatedRows[c]=b}});this.attachEvent("onSelectStateChanged",function(b){if(a.updateMode=="row"){a.sendData()}return true});this.attachEvent("onEnter",function(c,b){if(a.updateMode=="row"){a.sendData()}return true});this.attachEvent("onBeforeRowDeleted",function(b){if(!this.rowsAr[b]){return true}if(this.dragContext&&a.dnd){window.setTimeout(function(){a.setUpdated(b,true)},1);return true}var c=a.getState(b);if(this._h2){this._h2.forEachChild(b,function(d){a.setUpdated(d.id,false);a.markRow(d.id,true,"deleted")},this)}if(c=="inserted"){a.set_invalid(b,false);a.setUpdated(b,false);return true}if(c=="deleted"){return false}if(c=="true_deleted"){a.setUpdated(b,false);return true}a.setUpdated(b,true,"deleted");return false});this.attachEvent("onRowAdded",function(b){if(this.dragContext&&a.dnd){return true}a.setUpdated(b,true,"inserted");return true});a._getRowData=function(d,m){var g=[];g.gr_id=d;if(this.obj.isTreeGrid()){g.gr_pid=this.obj.getParentId(d)}var b=this.obj.getRowById(d);for(var h=0;h<this.obj._cCount;h++){if(this.obj._c_order){var k=this.obj._c_order[h]}else{var k=h}var l=this.obj.cells(b.idd,h);if(this._changed&&!l.wasChanged()){continue}if(this._endnm){g[this.obj.getColumnId(h)]=l.getValue()}else{g["c"+k]=l.getValue()}}var e=this.obj.UserData[d];if(e){for(var f=0;f<e.keys.length;f++){if(e.keys[f].indexOf("__")!=0){g[e.keys[f]]=e.values[f]}}}var e=this.obj.UserData.gridglobaluserdata;if(e){for(var f=0;f<e.keys.length;f++){g[e.keys[f]]=e.values[f]}}return g};a._clearUpdateFlag=function(c){var d=this.obj.getRowById(c);if(d){for(var b=0;b<this.obj._cCount;b++){this.obj.cells(c,b).cell.wasChanged=false}}};a.checkBeforeUpdate=function(f){var e=true;var b=[];for(var d=0;d<this.obj._cCount;d++){if(this.mandatoryFields[d]){var c=this.mandatoryFields[d].call(this.obj,this.obj.cells(f,d).getValue(),f,d);if(typeof c=="string"){this.messages.push(c);e=false}else{e&=c;b[d]=!c}}}if(!e){this.set_invalid(f,"invalid",b);this.setUpdated(f,false)}return e}};(function(a){a.fn.grid=function(f){var h={setColVAlign:"",onHeaderClick:function(){return true},onRowDblClicked:function(){},onRowClicked:function(){},onErrColorboxClose:function(){},enableSorting:true,onBeforeSorting:function(){return true},onInited:function(){},height:"500px",width:"100%",genData:[],btn:{addBtn:"#addBtn",saveBtn:"#saveBtn",cancelBtn:"#cancelBtn",deleteBtn:"#deleteBtn"},onDoRowAdded:function(){},onDoRowAdd:function(){},onDoRowRm:function(){},onDoRowUpdate:function(){},debug:false,grid:null,listName:"",id:"",pagerId:"",gridPanel:"",url:"",root:"",skin:"dhx_skyblue",autoSkin:true,setSubHeader:[],setHeader:"",columns:[],columnType:[],columnValidate:false,columnValidator:[],customValidate:function(){},css:{onErrorClass:"warn"},render:{},setInitWidths:"",footer:false,footerColumns:"",footerAlign:"",setInitWidthsP:"",setImagePath:"",pagerBuilder:true,cache:null,pager:{id:"",total:0,page:1,pageSize:5,pageCount:0,url:"",root:"",record:"total",pageParmName:"pagination.currentPage",pagesizeParmName:"pagination.pageSize",resetPager:function(){},setParam:function(){},param:{},isContinueByDataChanged:"\u6570\u636e\u5df2\u7ecf\u6539\u53d8,\u5982\u679c\u7ee7\u7eed\u5c06\u4e22\u5931\u6570\u636e,\u662f\u5426\u7ee7\u7eed?",loadingMassage:"\u6570\u636e\u6b63\u5728\u6574\u7406\u4e2d\uff0c\u8bf7\u60a8\u7a0d\u5019...",showStatus:true,isChanged:false,onLoad:function(){},onComplete:function(j){},onSuccess:function(j){},_onSuccess:function(j){if(j.cacheData&&j.cacheData.rows&&j.cacheData.rows.length>0){g.dataManage.list=[];a.each(j.cacheData.rows,function(k,l){a.each(g.columns,function(m){if(g.columnType[m]=="date"){l.data[g.columns[m]]=a.icinfo.date.format({dateObj:l.data[g.columns[m]]})}});l.data.rowid=l.id;g.dataManage.list.push(l.data)})}this.onSuccess(j)},onError:function(j,k){}},onRowClicked:function(l,k,j){},doBindRowClick:function(j){var k=a(j.obj);k.find("td").click(function(n){var l=j.getFirstParentOfType(_isIE?n.srcElement:n.target,"TD");var m=l.parentNode.idd;var o=null;a.each(j.cacheData.rows,function(p,q){if(q.id==m){o=q.data;return false}});j.callEvent("onRowClicked",[o,l._cellIndex,j,l,_isIE?n.srcElement:n.target])})},onRowSelect:function(l,j){var k=this;var m=null;a.each(k.grid.cacheData.rows,function(o,p){if(p.id==l){m=p.data;return false}});if(m==null){return false}a.each(k.columns,function(p,q){var o=k.columns[p];a("#"+o).val(k.render[o]&&(k.columnType[p]!="date"&&k.columnType[p]!="select")?k.render[o](m[o],m):m[o])});a(k.gridPanel).find(k.btn.deleteBtn).css({display:""});if(a.browser.msie&&a.browser.version=="6.0"){a(k.gridPanel).fadeIn(300,function(){k.showRowSelectPanel(l,j,m)})}else{a(k.gridPanel).slideDown(300,function(){k.showRowSelectPanel(l,j,m)})}},onRowSelected:function(k,j,l){},showRowSelectPanel:function(l,j,m){var k=this;a("html,body").animate({scrollTop:a(k.gridPanel).offset().top-10},200);a("#"+k.columns[j]).focus();a(k.gridPanel).find(k.btn.saveBtn).unbind("click").click(function(){var o=k.doFormCheck();if(!o){return false}else{var n=k.grid.getRowIndex(k.grid.getSelectedId());k.grid.deleteSelectedRows();var p=[];a.each(k.columns,function(r){var q=k.columns[r];var s=k.render[q]&&k.columnType[r]!="date"?k.render[q](o[q],o):o[q];p.push(s)});k.grid.addRow(l,p,n);a.each(k.grid.cacheData.rows,function(q,r){if(r.id==l){o.__status=r.data.__status;k.grid.cacheData.rows[q].data=o}});o.rowid=l;o.id=l;k.dataManage._update_(o);k.grid.setSelectedRow(l);k.pager.isChanged=true;k.pager.onChanged(o,"update");k.onDoRowUpdate(m,o);if(a.browser.msie&&a.browser.version=="6.0"){a(k.gridPanel).fadeOut()}else{a(k.gridPanel).slideUp(300)}}});k.onRowSelected(l,j,m)},doRowAdd:function(){var j=this;a.each(j.columns,function(l){var k=j.columns[l];a("#"+k).val("")});j.onDoRowAdd(j.columns,j);a(j.gridPanel).find(j.btn.deleteBtn).css({display:"none"});if(a.browser.msie&&a.browser.version=="6.0"){a(j.gridPanel).fadeIn(300,function(){j.showRowAddPanel()})}else{a(j.gridPanel).slideDown(300,function(){j.showRowAddPanel()})}},showRowAddPanel:function(){var j=this;a("html,body").animate({scrollTop:a(j.gridPanel).offset().top-10},200);a("#"+j.columns[0]).focus();a(j.gridPanel).find(j.btn.saveBtn).unbind("click").click(function(){var k=j.doFormCheck();if(!k){return false}else{j.lastUid=j.grid.uid();var l=[];a.each(j.columns,function(n){var m=j.columns[n];var o=j.render[m]&&j.columnType[n]!="date"?j.render[m](k[m],k):k[m];l.push(o)});j.grid.addRow(j.lastUid,l,0);k.__status="insert";k.rowid=j.lastUid;k.id=j.lastUid;j.grid.cacheData.rows.push({id:j.lastUid,data:k});j.dataManage._insert_(k);j.grid.setSelectedRow(j.lastUid);j.pager.isChanged=true;j.pager.onChanged(k,"insert");j.onDoRowAdded(k);if(a.browser.msie&&a.browser.version=="6.0"){a(j.gridPanel).fadeOut()}else{a(j.gridPanel).slideUp(300)}}})},doRowRm:function(){var k=this;var l=k.grid.getSelectedId();var j={};a.each(k.grid.cacheData.rows,function(m,o){if(o.id==l){j=k.grid.cacheData.rows[m].data;return false}});if(j=={}){alert("ICINFO GRID ERROR:\n grid.doRowRm(null)");return false}j.rowid=l;j.id=l;k.dataManage._delete_(j);k.grid.deleteSelectedRows();k.pager.isChanged=true;k.pager.onChanged(j,"delete");k.onDoRowRm(j);if(a.browser.msie&&a.browser.version=="6.0"){a(k.gridPanel).fadeOut()}else{a(k.gridPanel).slideUp(300)}},doFormCheck:function(){var m=this;var o={};var l=m.css.onErrorClass;var j=m.setHeader.split(",");m.columnValidateFlag=true;a.each(m.columns,function(t){var B=m.columns[t];if(B!="_rownum"){var x=a("#"+B);var A=x.val();o[B]=a("#"+B);x.removeClass(l);if(m.columnValidate==true){if(m.columnValidator[t].required){if(a.trim(A)==""){alert("\u8bf7\u586b\u5199 "+j[t]+"!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].maxlength){var p=parseInt(m.columnValidator[t].maxlength-0);if(A.length>p){alert(j[t]+" \u957f\u5ea6\u4e0d\u80fd\u5927\u4e8e "+p+"!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].minlength){var q=parseInt(m.columnValidator[t].minlength-0);if(A.length<q){alert(j[t]+" \u957f\u5ea6\u4e0d\u80fd\u5c0f\u4e8e "+q+"!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].rangelength){var r=m.columnValidator[t].rangelength;if(A.length<=r||A.length>=r){alert(j[t]+" \u957f\u5ea6\u53ea\u80fd\u5728 "+r[0]+"~"+r[1]+"\u4e4b\u95f4!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t]["min"]){var v=m.columnValidator[t]["min"];if(A<v){alert(j[t]+"\u4e0d\u80fd\u5c0f\u4e8e"+v+"!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t]["max"]){var C=m.columnValidator[t]["max"];if(A>C){alert(j[t]+"\u4e0d\u80fd\u5927\u4e8e"+C+"!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].range){var w=m.columnValidator[t].range;if((A-0)<=w[0]||(A-0)>=w[1]){alert(j[t]+" \u5927\u5c0f\u53ea\u80fd\u5728"+w[0]+"~"+w[1]+"\u4e4b\u95f4!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].number){if(isNaN(A-0)){alert(j[t]+" \u53ea\u80fd\u586b\u5199\u6570\u5b57!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].digits){if(!/^\d+$/.test(A)){alert(j[t]+" \u53ea\u80fd\u586b\u5199\u6574\u6570!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].idNo){var u=function(G){var I=new Array("\u9a8c\u8bc1\u901a\u8fc7!","\u8eab\u4efd\u8bc1\u53f7\u7801\u4f4d\u6570\u4e0d\u5bf9!","\u8eab\u4efd\u8bc1\u53f7\u7801\u51fa\u751f\u65e5\u671f\u8d85\u51fa\u8303\u56f4\u6216\u542b\u6709\u975e\u6cd5\u5b57\u7b26!","\u8eab\u4efd\u8bc1\u53f7\u7801\u6821\u9a8c\u9519\u8bef!","\u8eab\u4efd\u8bc1\u5730\u533a\u975e\u6cd5!");var H={11:"\u5317\u4eac",12:"\u5929\u6d25",13:"\u6cb3\u5317",14:"\u5c71\u897f",15:"\u5185\u8499\u53e4",21:"\u8fbd\u5b81",22:"\u5409\u6797",23:"\u9ed1\u9f99\u6c5f",31:"\u4e0a\u6d77",32:"\u6c5f\u82cf",33:"\u6d59\u6c5f",34:"\u5b89\u5fbd",35:"\u798f\u5efa",36:"\u6c5f\u897f",37:"\u5c71\u4e1c",41:"\u6cb3\u5357",42:"\u6e56\u5317",43:"\u6e56\u5357",44:"\u5e7f\u4e1c",45:"\u5e7f\u897f",46:"\u6d77\u5357",50:"\u91cd\u5e86",51:"\u56db\u5ddd",52:"\u8d35\u5dde",53:"\u4e91\u5357",54:"\u897f\u85cf",61:"\u9655\u897f",62:"\u7518\u8083",63:"\u9752\u6d77",64:"\u5b81\u590f",65:"\u65b0\u7586",71:"\u53f0\u6e7e",81:"\u9999\u6e2f",82:"\u6fb3\u95e8",91:"\u56fd\u5916"};var G,J,E,F,K,D=[];D=G.split("");if(H[parseInt(G.substr(0,2))]==null){return{result:false,e:"\u8eab\u4efd\u8bc1\u53f7\u7801\u4e0d\u6b63\u786e!"}}switch(G.length){case 15:if((parseInt(G.substr(6,2))+1900)%4==0||((parseInt(G.substr(6,2))+1900)%100==0&&(parseInt(G.substr(6,2))+1900)%4==0)){ereg=/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}$/}else{ereg=/^[1-9][0-9]{5}[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}$/}if(ereg.test(G)){return{result:true}}else{return{result:false,e:"\u8eab\u4efd\u8bc1\u53f7\u7801\u51fa\u751f\u65e5\u671f\u8d85\u51fa\u8303\u56f4\u6216\u542b\u6709\u975e\u6cd5\u5b57\u7b26!"}}break;case 18:if(parseInt(G.substr(6,4))%4==0||(parseInt(G.substr(6,4))%100==0&&parseInt(G.substr(6,4))%4==0)){ereg=/^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|[1-2][0-9]))[0-9]{3}[0-9Xx]$/}else{ereg=/^[1-9][0-9]{5}19[0-9]{2}((01|03|05|07|08|10|12)(0[1-9]|[1-2][0-9]|3[0-1])|(04|06|09|11)(0[1-9]|[1-2][0-9]|30)|02(0[1-9]|1[0-9]|2[0-8]))[0-9]{3}[0-9Xx]$/}if(ereg.test(G)){F=(parseInt(D[0])+parseInt(D[10]))*7+(parseInt(D[1])+parseInt(D[11]))*9+(parseInt(D[2])+parseInt(D[12]))*10+(parseInt(D[3])+parseInt(D[13]))*5+(parseInt(D[4])+parseInt(D[14]))*8+(parseInt(D[5])+parseInt(D[15]))*4+(parseInt(D[6])+parseInt(D[16]))*2+parseInt(D[7])*1+parseInt(D[8])*6+parseInt(D[9])*3;J=F%11;K="F";E="10X98765432";K=E.substr(J,1);if(K==D[17]){return{result:true}}else{return{result:false,e:"\u8eab\u4efd\u8bc1\u53f7\u7801\u51fa\u751f\u65e5\u671f\u8d85\u51fa\u8303\u56f4\u6216\u542b\u6709\u975e\u6cd5\u5b57\u7b26!"}}}else{return{result:false,e:"\u8eab\u4efd\u8bc1\u53f7\u7801\u51fa\u751f\u65e5\u671f\u8d85\u51fa\u8303\u56f4\u6216\u542b\u6709\u975e\u6cd5\u5b57\u7b26!"}}break;default:return{result:false,e:"\u8eab\u4efd\u8bc1\u53f7\u7801\u4f4d\u6570\u4e0d\u5bf9!"};break}};var s=u(A);if(!s.result){alert(j[t]+" \u683c\u5f0f\u4e0d\u6b63\u786e\uff0c"+s.e+"!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].tel){if(!/(\d{3}-\d{8}|\d{4}-\d{7}|\d{4}-\d{8}|\d{7}|\d{8}|\d{10})/.test(A)){alert(j[t]+" \u683c\u5f0f\u6709\u8bef\uff0c\u8bf7\u8f93\u5165\u6b63\u786e\u768411\u4f4d\u624b\u673a\u53f7\u7801,\u5982 13888888888!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].phone){if(!/^1[3|4|5|8]\d{9}$/.test(A)){alert(j[t]+" \u683c\u5f0f\u6709\u8bef\uff0c\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801,\n\u5982010-86212345\u30010571-88234636\u3001\n\r88234636\u30014008884636!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].accept){var y=m.columnValidator[t].accept;y=(typeof y=="string"?y.replace(/,/g,"|"):y.join("|")).split("|");if(a.inArray(A,y)==-1){alert(j[t]+" \u53ea\u80fd\u586b\u5199 "+y.join("|").replace(/\|/g,",")+"\u4e2d\u7684\u503c!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].email){var z=A;if(!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(z)){alert("\u8bf7\u5728 "+j[t]+" \u5185\u586b\u5199\u6b63\u786e\u7684email!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}if(m.columnValidator[t].url){var z=A;if(!/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(z)){alert("\u8bf7\u5728 "+j[t]+" \u5185\u586b\u5199\u6b63\u786e\u7684url!");m.columnValidateFlag=false;x.addClass(l).focus();return false}}}}});if(!m.columnValidateFlag){return false}var n=m.customValidate(o);if(n==false){return false}var k={};a.each(m.columns,function(q){var p=m.columns[q];k[p]=a.trim(a("#"+p).val())});return k},hidePanel:function(){a(this.gridPanel).slideUp(200)},dataManage:{list:[],_insert_:function(j){var k=this;j.__status="insert";k.list.push(j)},_delete_:function(k){var l=this,j=null;a.each(l.list,function(m,o){if(o.id==k.id){j=m}});if(j!=null){if(k.__status=="insert"){l.list.splice(j,1)}else{k.__status="delete";l.list[j]=k}}},_update_:function(k){var m=this;var j=null;var l=a.grep(m.list,function(p,o){return(k.__status=="insert")});a.each(m.list,function(q,r){var o=k.__status=="insert"?k.rowid:k.id;var p=r.__status=="insert"?r.rowid:r.id;if(p==o){k.id=r.id;k.rowid=r.rowid;j=q;return false}});if(j!=null){k.__status=(typeof(k.__status)=="undefined"||k.__status=="update"||k.__status=="")?"update":"insert";m.list[j]=k}},_gen_:function(n){var k=this,m=[],l=[];for(var j=0;j<k.list.length;j++){l.push(a.extend({},k.list[j]))}m=a.grep(l,function(p,o){return p.__status!=""});a.each(m,function(o,p){delete m[o]._rownum;if(p.__status=="insert"){delete m[o].id;delete m[o].rowid}if(p.__status=="update"||p.__status=="delete"){delete m[o].rowid}if(g.genData.length>0){a.each(g.genData,function(r,q){a.each(q,function(t,s){m[o][t]=s})})}});if(n){m=n(m)}return m},_getGroupList_:function(){var m=this,j=[],l=[],k=[];j=a.grep(m.list,function(o){return o.__status=="update"});l=a.grep(m.list,function(o){return o.__status=="delete"});k=a.grep(m.list,function(o){return o.__status=="insert"});return{_update:j,_delete:l,_insert:k}}},doLoad:function(){var o=this;o.pager.id=o.pagerId;o.pager.url=o.url;o.pager.root=o.root;o.grid=new dhtmlXGridObject(e.attr("id"));var n=o.grid;if(!o.setColSorting||o.setColSorting==""){o.setColSorting=[];a.each(o.columns,function(){o.setColSorting.push("str")});o.setColSorting=o.setColSorting.join(",")}if(!o.setColAlign||o.setColAlign==""){o.setColAlign=[];a.each(o.columns,function(){o.setColAlign.push("center")});o.setColAlign=o.setColAlign.join(",")}if(!o.setColTypes||o.setColTypes==""){o.setColTypes=[];a.each(o.columns,function(){o.setColTypes.push("ro")});o.setColTypes=o.setColTypes.join(",")}o._setInitWidthsP="";if(!o.setInitWidthsP||o.setInitWidthsP==""){var m=[];var j=o.columns.length;a.each(o.columns,function(){m.push(100/j)});o._setInitWidthsP=m.join(",")}if(o.setInitWidths!=""){if(o.debug&&o.columns.length!=o.setInitWidths.split(",").length){alert(d+"\u5217\u8868\u5b57\u6bb5\u6570("+o.columns.length+")\u4e0e\u8bbe\u7f6e\u5bbd\u5ea6\u7684\u4e2a\u6570("+o.setInitWidths.split(",").length+")\u4e0d\u4e00\u81f4")}n.setInitWidths(o.setInitWidths)}else{n.setInitWidthsP(o.setInitWidthsP==""?o._setInitWidthsP:o.setInitWidthsP)}if(!o.headerAlign||o.headerAlign==""){o.headerAlign=[];a.each(o.columns,function(p){o.headerAlign.push("text-align:center;")})}if(!o.enableEditEvents||o.enableEditEvents==""){o.enableEditEvents=[];a.each(o.columns,function(p){o.enableEditEvents.push(false)})}n.setImagePath(o.setImagePath);n.setHeader(o.setHeader,null,o.headerAlign);if(o.setSubHeader.length>0){a.each(o.setSubHeader,function(p,q){o.grid.attachHeader(q.header,q.style||null,q.align||"")})}if(o.setColVAlign!=""){n.setColVAlign(o.setColVAlign)}n.setColAlign(o.setColAlign);n.setColTypes(o.setColTypes);n.enableEditEvents(o.enableEditEvents);o.skinPath=window._dhtmlxgrid_skinPath||(function(r,p,q){for(p in r){if(r[p].src&&r[p].src.indexOf("dhtmlxcommon.js")!==-1){q=r[p]}}window._dhtmlxgrid_jsPath=q||r[r.length-1];q=window._dhtmlxgrid_jsPath.src.replace(/\\/g,"/");return q.lastIndexOf("/")<0?".":q.substring(0,q.lastIndexOf("/"))}(a("script")));if(o.skin!=""&&o.autoSkin===true){var l=[o.skinPath+"/dhtmlxgrid.css",o.skinPath+"/skins/dhtmlxgrid_"+o.skin+".css"],k;for(i=0;i<=l.length-1;i++){k=document.createElement("link");k.rel="stylesheet";k.href=l[i];window._dhtmlxgrid_jsPath.parentNode.insertBefore(k,window._dhtmlxgrid_jsPath)}}n.setSkin(o.skin);n.setColSorting(o.setColSorting);n.enableStableSorting(true);n.enableBlockSelection(true);n.attachEvent("onBlockSelected",n.copyBlockToClipboard);if(o.footer){n.attachFooter(o.footerColumns,o.footerAlign||"")}n.opts=o;o.grid.init();o.onInited(n);o.getJson()},doReload:function(){var j=this;j.getJson()},getJson:function(){var n=this;var l=n.grid;var j=n.pager;var o=a.param(j.param);var p=a(l.hdrBox).parent().attr("id");a(j.id).html("<ul><li><span class='pager-loading'>"+j.loadingMassage+"</span></li></ul>");var k=a("#"+p+"_progress").length==1?a("#"+p+"_progress"):a("<div class='dhxlayout_progress' id='"+p+"_progress'></div>");k.css({top:a(l.objBox).offset().top,left:a(l.objBox).offset().left,height:a(l.objBox).height(),width:a(l.objBox).width()});a("body").append(k);var m=j.method=="POST"?j.url+"?"+j.pageParmName+"="+j.page+"&"+j.pagesizeParmName+"="+j.pageSize:j.url+"?"+j.pageParmName+"="+j.page+"&"+j.pagesizeParmName+"="+j.pageSize+"&"+o;l.clearAndLoad(m,function(q){try{n.pager._onSuccess(q);n.pager.onComplete(q,n);n.doBindRowClick(q)}catch(r){if(window.console&&window.console["log"]){console.log(r)}}k.fadeOut((typeof(j.fadeOut)=="undefined"?500:parseInt(j.fadeOut)),function(){k.remove()})},"json")},doSearch:function(){var k=this;var j=k.pager;j.resetPager();j.setParam();k.pager.page=1;k.getJson()}};var d="ICINFO GRID DEBUG:\n";var g=a.extend(true,h,f||{});var e=a(this).eq(0);g.self=e;if(g.debug&&e.length==0){alert(d+"div id is not found!")}if(g.pagerId==""){g.pagerId="#"+e.attr("id")+"Pager"}if(a(g.pagerId).length==0){var c=a('<div id="'+g.self.attr("id")+'Pager" class="gridPager"></div>');a(this).after(c);if(g.debug){alert(d+"$(opts.pagerId).length == 0")}}if(!g.pagerBuilder){c.css({display:"none"})}if(g.gridPanel==""){g.gridPanel="#"+e.attr("id")+"Panel"}if(g.debug&&a(g.gridPanel).length==0){alert(d+"$(opts.gridPanel).length == 0")}var b={id:"",method:"GET",total:0,page:1,pageSize:5,pageSizeArray:[5,10,20,50,100],pageCount:0,url:"",root:"",record:"total",pageParmName:"pagination.currentPage",pagesizeParmName:"pagination.pageSize",resetPager:function(){this.total=0;this.page=1;this.pageCount=0},setParam:function(){},param:{},isContinueByDataChanged:"\u6570\u636e\u5df2\u7ecf\u6539\u53d8,\u5982\u679c\u7ee7\u7eed\u5c06\u4e22\u5931\u6570\u636e,\u662f\u5426\u7ee7\u7eed?",loadingMassage:"\u6570\u636e\u6b63\u5728\u6574\u7406\u4e2d\uff0c\u8bf7\u60a8\u7a0d\u5019...",showToPDF:false,pdfURL:"",showToXLS:false,xlsURL:"",showStatus:true,isChanged:false,onLoad:function(){},onComplete:function(j){},onChanged:function(){},dataFilter:function(j){return j},onSuccess:function(j){},_onSuccess:function(j){if(j.cacheData&&j.cacheData.rows&&j.cacheData.rows.length>0){g.dataManage.list=[];a.each(j.cacheData.rows,function(k,l){a.each(g.columns,function(m){if(g.columnType[m]=="date"){l.data[g.columns[m]]=a.icinfo.date.format({dateObj:l.data[g.columns[m]]})}});l.data.rowid=l.id;g.dataManage.list.push(l.data)})}this.onSuccess(j)},onError:function(j,k){}};g.pager=a.extend(true,b,g.pager||{});g.doLoad();g.grid.attachEvent("onBeforeSorting",g.onBeforeSorting);g.grid.attachEvent("onRowSelect",function(k,j){g.onRowSelect(k,j,g)});g.grid.attachEvent("onRowClicked",g.onRowClicked);if(g.debug&&a(g.btn.addBtn).length==0){alert(d+"$(opts.btn.addBtn).length == 0")}if(g.debug&&a(g.btn.saveBtn).length==0){alert(d+"$(opts.btn.saveBtn).length == 0")}if(g.debug&&a(g.btn.cancelBtn).length==0){alert(d+"$(opts.btn.cancelBtn).length == 0")}if(g.debug&&a(g.btn.deleteBtn).length==0){alert(d+"$(opts.btn.deleteBtn).length == 0")}a(g.btn.cancelBtn).click(function(){g.hidePanel()});a(g.btn.addBtn).click(function(){g.doRowAdd()});a(g.btn.deleteBtn).click(function(){g.doRowRm()});e.data({grid:g})}})(jQuery);dhtmlXGridObject.prototype.setRowHidden=function(g,c){var b=convertStringToBoolean(c);var e=this.getRowById(g);if(!e){return}if(e.expand===""){this.collapseKids(e)}if((c)&&(e.style.display!="none")){e.style.display="none";var d=this.selectedRows._dhx_find(e);if(d!=-1){e.className=e.className.replace("rowselected","");for(var a=0;a<e.childNodes.length;a++){e.childNodes[a].className=e.childNodes[a].className.replace(/cellselected/g,"")}this.selectedRows._dhx_removeAt(d)}this.callEvent("onGridReconstructed",[])}if((!c)&&(e.style.display=="none")){e.style.display="";this.callEvent("onGridReconstructed",[])}this.setSizes()};dhtmlXGridObject.prototype.setColumnHidden=function(c,b){if(!this.hdr.rows.length){if(!this._ivizcol){this._ivizcol=[]}return this._ivizcol[c]=b}if((this.fldSorted)&&(this.fldSorted.cellIndex==c)&&(b)){this.sortImg.style.display="none"}var a=convertStringToBoolean(b);if(a){if(!this._hrrar){this._hrrar=new Array()}else{if(this._hrrar[c]){return}}this._hrrar[c]="display:none;";this._hideShowColumn(c,"none")}else{if((!this._hrrar)||(!this._hrrar[c])){return}this._hrrar[c]="";this._hideShowColumn(c,"")}if((this.fldSorted)&&(this.fldSorted.cellIndex==c)&&(!b)){this.sortImg.style.display="inline"}};dhtmlXGridObject.prototype.isColumnHidden=function(a){if((this._hrrar)&&(this._hrrar[a])){return true}return false};dhtmlXGridObject.prototype.setColumnsVisibility=function(a){this.setColHidden(a)};dhtmlXGridObject.prototype.setColHidden=function(b){if(b){this._ivizcol=b.split(",")}if(this.hdr.rows.length&&this._ivizcol){for(var a=0;a<this._ivizcol.length;a++){this.setColumnHidden(a,this._ivizcol[a])}}};dhtmlXGridObject.prototype._fixHiddenRowsAll=function(d,f,h,e){var g=d.rows.length;for(var c=0;c<g;c++){var a=d.rows[c].cells;if(a.length!=this._cCount){for(var b=0;b<a.length;b++){if(a[b]._cellIndex==f){a[b].style[h]=e;break}}}else{a[f].style[h]=e}}};dhtmlXGridObject.prototype._hideShowColumn=function(d,c){var a=d;if((this.hdr.rows[1]._childIndexes)&&(this.hdr.rows[1]._childIndexes[d]!=d)){a=this.hdr.rows[1]._childIndexes[d]}if(c=="none"){this.hdr.rows[0].cells[d]._oldWidth=this.hdr.rows[0].cells[d].style.width;this.hdr.rows[0].cells[d]._oldWidthP=this.cellWidthPC[d];this.obj.rows[0].cells[d].style.width="0px";this._fixHiddenRowsAll(this.obj,d,"display","none");if(this._fixHiddenRowsAllTG){this._fixHiddenRowsAllTG(d,"none")}if((_isOpera&&_OperaRv<9)||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,d,"display","none");if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],d,"display","none")}}this._fixHiddenRowsAll(this.hdr,d,"whiteSpace","nowrap");if(!this.cellWidthPX.length&&!this.cellWidthPC.length){this.cellWidthPX=[].concat(this.initCellWidth)}if(this.cellWidthPX[d]){this.cellWidthPX[d]=0}if(this.cellWidthPC[d]){this.cellWidthPC[d]=0}}else{if(this.hdr.rows[0].cells[d]._oldWidth){var b=this.hdr.rows[0].cells[d];if(_isOpera||_isKHTML||(_isFF)){this._fixHiddenRowsAll(this.hdr,d,"display","")}if(this.ftr){this._fixHiddenRowsAll(this.ftr.childNodes[0],d,"display","")}this.obj.rows[0].cells[d].style.width=this.hdr.rows[0].cells[d]._oldWidth;this._fixHiddenRowsAll(this.obj,d,"display","");if(this._fixHiddenRowsAllTG){this._fixHiddenRowsAllTG(d,"")}b.style.width=b._oldWidth;this._fixHiddenRowsAll(this.hdr,d,"whiteSpace","normal");if(b._oldWidthP){this.cellWidthPC[d]=b._oldWidthP}if(b._oldWidth){this.cellWidthPX[d]=parseInt(b._oldWidth)}}}this.setSizes();if((!_isIE)&&(!_isFF)){this.obj.border=1;this.obj.border=0}};dhtmlXGridObject.prototype.enableBlockSelection=function(b){if(typeof this._bs_mode=="undefined"){var a=this;this.obj.onmousedown=function(c){if(a._bs_mode){a._OnSelectionStart((c||event),this)}return true};this._CSVRowDelimiter=this.csv.row;this.attachEvent("onResize",function(){a._HideSelection();return true});this.attachEvent("onFilterEnd",this._HideSelection)}if(b===false){this._bs_mode=false;return this._HideSelection()}else{this._bs_mode=true}};dhtmlXGridObject.prototype.forceLabelSelection=function(a){this._strictText=convertStringToBoolean(a)};dhtmlXGridObject.prototype.disableBlockSelection=function(){this.obj.onmousedown=null};dhtmlXGridObject.prototype._OnSelectionStart=function(c,d){var b=this;if(c.button==2){return}var e=c.srcElement||c.target;if(this.editor){if(e.tagName&&(e.tagName=="INPUT"||e.tagName=="TEXTAREA")){return}this.editStop()}if(!b.isActive){b.setActive(true)}var g=this.getPosition(this.obj);var a=c.clientX-g[0]+document.body.scrollLeft;var f=c.clientY-g[1]+document.body.scrollTop;this._CreateSelection(a-4,f-4);if(e==this._selectionObj){this._HideSelection();this._startSelectionCell=null}else{while(e.tagName.toLowerCase()!="td"){e=e.parentNode}this._startSelectionCell=e}this.obj.onmousedown=null;this.obj[_isIE?"onmouseleave":"onmouseout"]=function(h){if(b._blsTimer){window.clearTimeout(b._blsTimer)}};this.obj.onmmold=this.obj.onmousemove;this._init_pos=[a,f];this._selectionObj.onmousemove=this.obj.onmousemove=function(h){h=h||c;h.returnValue=false;b._OnSelectionMove(h)};this._oldDMP=document.body.onmouseup;document.body.onmouseup=function(h){h=h||c;b._OnSelectionStop(h,this);return true};document.body.onselectstart=function(){return false}};dhtmlXGridObject.prototype._getCellByPos=function(a,d){a=a;d=d;var b=0;for(var c=0;c<this.obj.rows.length;c++){d-=this.obj.rows[c].offsetHeight;if(d<=0){b=this.obj.rows[c];break}}if(!b||!b.idd){return null}for(var c=0;c<this._cCount;c++){a-=this.obj.rows[0].childNodes[c].offsetWidth;if(a<=0){while(true){if(b._childIndexes&&b._childIndexes[c+1]==b._childIndexes[c]){b=b.previousSibling}else{return this.cells(b.idd,c).cell}}}}return null};dhtmlXGridObject.prototype._OnSelectionMove=function(e){var p=this;this._ShowSelection();var m=this.getPosition(this.obj);var h=e.clientX-m[0]+document.body.scrollLeft;var g=e.clientY-m[1]+document.body.scrollTop;if((Math.abs(this._init_pos[0]-h)<5)&&(Math.abs(this._init_pos[1]-g)<5)){return this._HideSelection()}if(this._startSelectionCell==null){this._endSelectionCell=this._startSelectionCell=this.getFirstParentOfType(e.srcElement||e.target,"TD")}else{if(e.srcElement||e.target){if((e.srcElement||e.target).className=="dhtmlxGrid_selection"){this._endSelectionCell=(this._getCellByPos(h,g)||this._endSelectionCell)}else{var o=this.getFirstParentOfType(e.srcElement||e.target,"TD");if(o.parentNode.idd){this._endSelectionCell=o}}}}var f=this.objBox.scrollLeft+this.objBox.clientWidth;var c=this.objBox.scrollTop+this.objBox.clientHeight;var k=this.objBox.scrollLeft;var j=this.objBox.scrollTop;var d=false;if(this._blsTimer){window.clearTimeout(this._blsTimer)}if(h+20>=f){this.objBox.scrollLeft=this.objBox.scrollLeft+20;d=true}else{if(h-20<k){this.objBox.scrollLeft=this.objBox.scrollLeft-20;d=true}}if(g+20>=c&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop+20;d=true}else{if(g-20<j&&!this._realfake){this.objBox.scrollTop=this.objBox.scrollTop-20;d=true}}this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._endSelectionCell);if(d){var n=e.clientX;var l=e.clientY;this._blsTimer=window.setTimeout(function(){p._OnSelectionMove({clientX:n,clientY:l})},100)}};dhtmlXGridObject.prototype._OnSelectionStop=function(b){var a=this;if(this._blsTimer){window.clearTimeout(this._blsTimer)}this.obj.onmousedown=function(d){if(a._bs_mode){a._OnSelectionStart((d||b),this)}return true};this.obj.onmousemove=this.obj.onmmold||null;this._selectionObj.onmousemove=null;document.body.onmouseup=this._oldDMP||null;if(parseInt(this._selectionObj.style.width)<2&&parseInt(this._selectionObj.style.height)<2){this._HideSelection()}else{var c=this.getFirstParentOfType(b.srcElement||b.target,"TD");if((!c)||(!c.parentNode.idd)){c=this._endSelectionCell}if(!c){return this._HideSelection()}while(c.tagName.toLowerCase()!="td"){c=c.parentNode}this._stopSelectionCell=c;this._selectionArea=this._RedrawSelectionPos(this._startSelectionCell,this._stopSelectionCell);this.callEvent("onBlockSelected",[])}document.body.onselectstart=function(){}};dhtmlXGridObject.prototype._RedrawSelectionPos=function(m,g){var k={};k.LeftTopCol=m._cellIndex;k.LeftTopRow=this.getRowIndex(m.parentNode.idd);k.RightBottomCol=g._cellIndex;k.RightBottomRow=this.getRowIndex(g.parentNode.idd);var d=m.offsetWidth;var c=m.offsetHeight;m=this.getPosition(m,this.obj);var n=g.offsetWidth;var h=g.offsetHeight;g=this.getPosition(g,this.obj);if(m[0]<g[0]){var e=m[0];var f=g[0]+n}else{var j=k.RightBottomCol;k.RightBottomCol=k.LeftTopCol;k.LeftTopCol=j;var e=g[0];var f=m[0]+d}if(m[1]<g[1]){var l=m[1];var a=g[1]+h}else{var j=k.RightBottomRow;k.RightBottomRow=k.LeftTopRow;k.LeftTopRow=j;var l=g[1];var a=m[1]+c}var o=f-e;var b=a-l;this._selectionObj.style.left=e+"px";this._selectionObj.style.top=l+"px";this._selectionObj.style.width=o+"px";this._selectionObj.style.height=b+"px";return k};dhtmlXGridObject.prototype._CreateSelection=function(a,c){if(this._selectionObj==null){var b=document.createElement("div");b.style.position="absolute";b.style.display="none";b.className="dhtmlxGrid_selection";this._selectionObj=b;this._selectionObj.onmousedown=function(d){d=d||event;if(d.button==2||(_isMacOS&&d.ctrlKey)){return this.parentNode.grid.callEvent("onBlockRightClick",["BLOCK",d])}};this._selectionObj.oncontextmenu=function(d){(d||event).cancelBubble=true;return false};this.objBox.appendChild(this._selectionObj)}this._selectionObj.style.width="0px";this._selectionObj.style.height="0px";this._selectionObj.style.left=a+"px";this._selectionObj.style.top=c+"px";this._selectionObj.startX=a;this._selectionObj.startY=c};dhtmlXGridObject.prototype._ShowSelection=function(){if(this._selectionObj){this._selectionObj.style.display=""}};dhtmlXGridObject.prototype._HideSelection=function(){if(this._selectionObj){this._selectionObj.style.display="none"}this._selectionArea=null};dhtmlXGridObject.prototype.copyBlockToClipboard=function(){if(this._selectionArea!=null){var c=new Array();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}for(var a=this._selectionArea.LeftTopRow;a<=this._selectionArea.RightBottomRow;a++){var b=this._serializeRowToCVS(this.rowsBuffer[a],null,this._selectionArea.LeftTopCol,this._selectionArea.RightBottomCol+1);if(!this._csvAID){c[c.length]=b.substr(b.indexOf(this.csv.cell)+1)}else{c[c.length]=b}}c=c.join(this._CSVRowDelimiter);this.toClipBoard(c)}};dhtmlXGridObject.prototype.pasteBlockFromClipboard=function(){var f=this.fromClipBoard();if(this._selectionArea!=null){var q=this._selectionArea.LeftTopRow;var a=this._selectionArea.LeftTopCol}else{if(this.cell!=null&&!this.editor){var q=this.getRowIndex(this.cell.parentNode.idd);var a=this.cell._cellIndex}else{return false}}f=f.split(this._CSVRowDelimiter);if((f.length>1)&&(f[f.length-1]=="")){f.splice(f.length-1,1)}for(var h=0;h<f.length;h++){f[h]=f[h].split(this.csv.cell)}var g=q+f.length;var o=a+f[0].length;if(o>this._cCount){o=this._cCount}var d=0;for(var h=q;h<g;h++){var r=this.render_row(h);if(r==-1){continue}var c=0;for(var e=a;e<o;e++){var m=this.cells3(r,e);if(m.isDisabled()){c++;continue}if(this._onEditUndoRedo){this._onEditUndoRedo(2,r.idd,e,f[d][c],m.getValue())}if(m.combo){var p=m.combo.values;for(var b=0;b<p.length;b++){if(f[d][c]==p[b]){m.setValue(m.combo.keys[b]);p=null;break}}if(p!=null){m.setValue(f[d][c++])}else{c++}}else{m[m.setImage?"setLabel":"setValue"](f[d][c++])}m.cell.wasChanged=true}this.callEvent("onRowPaste",[r.idd]);d++}};dhtmlXGridObject.prototype.loadCSVFile=function(b,a){this.load(b,a,"csv")};dhtmlXGridObject.prototype.enableCSVAutoID=function(a){this._csvAID=convertStringToBoolean(a)};dhtmlXGridObject.prototype.enableCSVHeader=function(a){this._csvHdr=convertStringToBoolean(a)};dhtmlXGridObject.prototype.setCSVDelimiter=function(a){this.csv.cell=a};dhtmlXGridObject.prototype._csvAID=true;dhtmlXGridObject.prototype.loadCSVString=function(a){this.parse(a,"csv")};dhtmlXGridObject.prototype.serializeToCSV=function(h){this.editStop();if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText||h){this._agetm="getTitle"}else{this._agetm="getValue"}}var f=[];if(this._csvHdr){for(var e=1;e<this.hdr.rows.length;e++){var b=[];for(var g=0;g<this._cCount;g++){if((!this._srClmn)||(this._srClmn[g])){b.push(this.getColumnLabel(g,e-1))}}f.push(b.join(this.csv.cell))}}var g=0;var d=this.rowsBuffer.length;for(g;g<d;g++){var c=this._serializeRowToCVS(null,g);if(c!=""){f.push(c)}}return f.join(this.csv.row)};dhtmlXGridObject.prototype._serializeRowToCVS=function(a,j,c,g){var h=new Array();if(!a){a=this.render_row(j);if(this._fake&&!this._fake.rowsAr[a.idd]){this._fake.render_row(j)}}if(!this._csvAID){h[h.length]=a.idd}c=c||0;g=g||this._cCount;var l=false;var d=c;while(a.childNodes[c]._cellIndex>d&&c){c--}for(var k=c;d<g;k++){if(!a.childNodes[k]){break}var b=a.childNodes[k]._cellIndex;if((!this._srClmn)||(this._srClmn[b])){var e=a.childNodes[k];var f=this.cells(a.idd,b);while(d!=b){d++;h.push("");if(d>=g){break}}if(d>=g){break}d++;if(f.cell){zxVal=f[this._agetm]()}else{zxVal=""}if((this._chAttr)&&(f.wasChanged())){l=true}h[h.length]=((zxVal===null)?"":zxVal);if(this._ecspn&&e.colSpan&&e.colSpan>1){e=e.colSpan-1;for(var m=0;m<e;m++){h[h.length]="";d++}}}else{d++}}if((this._onlChAttr)&&(!l)){return""}return h.join(this.csv.cell)};dhtmlXGridObject.prototype.toClipBoard=function(b){if(window.clipboardData){window.clipboardData.setData("Text",b)}else{try{(new Clipboard()).copy(b)}catch(a){try{clip.setText(b)}catch(a){}}}};dhtmlXGridObject.prototype.fromClipBoard=function(){if(window.clipboardData){return window.clipboardData.getData("Text")}else{return(new Clipboard()).paste()}};dhtmlXGridObject.prototype.cellToClipboard=function(c,b){if((!c)||(!b)){if(!this.selectedRows[0]){return}c=this.selectedRows[0].idd;b=this.cell._cellIndex}var a=this.cells(c,b);this.toClipBoard(((a.getLabel?a.getLabel():a.getValue())||"").toString())};dhtmlXGridObject.prototype.updateCellFromClipboard=function(c,b){if((!c)||(!b)){if(!this.selectedRows[0]){return}c=this.selectedRows[0].idd;b=this.cell._cellIndex}var a=this.cells(c,b);a[a.setImage?"setLabel":"setValue"](this.fromClipBoard())};dhtmlXGridObject.prototype.rowToClipboard=function(c){var a="";if(this._mathSerialization){this._agetm="getMathValue"}else{if(this._strictText){this._agetm="getTitle"}else{this._agetm="getValue"}}if(c){a=this._serializeRowToCVS(this.getRowById(c))}else{for(var b=0;b<this.selectedRows.length;b++){if(a){a+=this.csv.row}a+=this._serializeRowToCVS(this.selectedRows[b])}}this.toClipBoard(a)};dhtmlXGridObject.prototype.updateRowFromClipboard=function(e){var a=this.fromClipBoard();if(!a){return}if(e){var d=this.getRowById(e)}else{var d=this.selectedRows[0]}if(!d){return}a=(a.split(this.csv.row)[0]).split(this.csv.cell);if(!this._csvAID){a.splice(0,1)}for(var c=0;c<a.length;c++){var b=this.cells3(d,c);b[b.setImage?"setLabel":"setValue"](a[c])}};dhtmlXGridObject.prototype.addRowFromClipboard=function(){var a=this.fromClipBoard();if(!a){return}var c=a.split(this.csv.row);for(var b=0;b<c.length;b++){if(c[b]){a=c[b].split(this.csv.cell);if(this._csvAID){this.addRow(this.getRowsNum()+2,a)}else{if(this.rowsAr[a[0]]){a[0]=this.uid()}this.addRow(a[0],a.slice(1))}}}};dhtmlXGridObject.prototype.gridToClipboard=function(){this.toClipBoard(this.serializeToCSV())};dhtmlXGridObject.prototype.gridFromClipboard=function(){var a=this.fromClipBoard();if(!a){return}this.loadCSVString(a)};dhtmlXGridObject.prototype.getXLS=function(f){if(!this.xslform){this.xslform=document.createElement("FORM");this.xslform.action=(f||"")+"xls.php";this.xslform.method="post";this.xslform.target=(_isIE?"_blank":"");document.body.appendChild(this.xslform);var e=document.createElement("INPUT");e.type="hidden";e.name="csv";this.xslform.appendChild(e);var d=document.createElement("INPUT");d.type="hidden";d.name="csv_header";this.xslform.appendChild(d)}var g=this.serializeToCSV();this.xslform.childNodes[0].value=g;var c=[];var a=this._cCount;for(var b=0;b<a;b++){c.push(this.getHeaderCol(b))}c=c.join(",");this.xslform.childNodes[1].value=c;this.xslform.submit()};dhtmlXGridObject.prototype.printView=function(n,b){var l="<style>TD {font-family:Arial;text-align:center;padding-left:2px;padding-right:2px; font-size:12px;};\n td.filter input, td.filter select {display:none;};\n </style>";var u=null;if(this._fake){u=[].concat(this._hrrar);for(var t=0;t<this._fake._cCount;t++){this._hrrar[t]=null}}l+="<base href='"+document.location.href+"'></base>";if(!this.parentGrid){l+=(n||"")}l+='<table width="100%" border="2px" cellpadding="0" cellspacing="0">';var m=Math.max(this.rowsBuffer.length,this.rowsCol.length);var k=this._cCount;var o=this._printWidth();l+='<tr class="header_row_1">';for(var t=0;t<k;t++){if(this._hrrar&&this._hrrar[t]){continue}var f=this.hdr.rows[1].cells[this.hdr.rows[1]._childIndexes?this.hdr.rows[1]._childIndexes[parseInt(t)]:t];var a=(f.colSpan||1);var y=(f.rowSpan||1);for(var s=1;s<a;s++){o[t]+=o[s]}l+='<td rowspan="'+y+'" width="'+o[t]+'%" style="background-color:lightgrey;" colspan="'+a+'">'+this.getHeaderCol(t)+"</td>";t+=a-1}l+="</tr>";for(var t=2;t<this.hdr.rows.length;t++){if(_isIE){l+="<tr style='background-color:lightgrey' class='header_row_"+t+"'>";var e=this.hdr.rows[t].childNodes;for(var s=0;s<e.length;s++){if(!this._hrrar||!this._hrrar[e[s]._cellIndex]){l+=e[s].outerHTML}}l+="</tr>"}else{l+="<tr class='header_row_"+t+"' style='background-color:lightgrey'>"+(this._fake?this._fake.hdr.rows[t].innerHTML:"")+this.hdr.rows[t].innerHTML+"</tr>"}}for(var t=0;t<m;t++){l+="<tr>";if(this.rowsCol[t]&&this.rowsCol[t]._cntr){l+=this.rowsCol[t].innerHTML.replace(/<img[^>]*>/gi,"")+"</tr>";continue}if(this.rowsCol[t]&&this.rowsCol[t].style.display=="none"){continue}var h;if(this.rowsCol[t]){h=this.rowsCol[t].idd}else{if(this.rowsBuffer[t]){h=this.rowsBuffer[t].idd}else{continue}}for(var s=0;s<k;s++){if(this._hrrar&&this._hrrar[s]){continue}if(this.rowsAr[h]&&this.rowsAr[h].tagName=="TR"){var x=this.cells(h,s);if(x._setState){var p=""}else{if(x.getContent){p=x.getContent()}else{if(x.getImage||x.combo){var p=x.cell.innerHTML}else{var p=x.getValue()||x.cell.innerHTML||0}}}}else{var p=this._get_cell_value(this.rowsBuffer[t],s)}var q=this.columnColor[s]?"background-color:"+this.columnColor[s]+";":"";var r=this.cellAlign[s]?"text-align:"+this.cellAlign[s]+";":"";var v=x.getAttribute("colspan");l+='<td style="'+q+r+'" '+(v?'colSpan="'+v+'"':"")+">"+(p===""?"&nbsp;":p)+"</td>";if(v){s+=v-1}}l+="</tr>";if(this.rowsCol[t]&&this.rowsCol[t]._expanded){var g=this.cells4(this.rowsCol[t]._expanded.ctrl);if(g.getSubGrid){l+='<tr><td colspan="'+k+'">'+g.getSubGrid().printView()+"</td></tr>"}else{l+='<tr><td colspan="'+k+'">'+this.rowsCol[t]._expanded.innerHTML+"</td></tr>"}}}if(this.ftr){for(var t=1;t<this.ftr.childNodes[0].rows.length;t++){l+="<tr style='background-color:lightgrey'>"+((this._fake)?this._fake.ftr.childNodes[0].rows[t].innerHTML:"")+this.ftr.childNodes[0].rows[t].innerHTML+"</tr>"}}l+="</table>";if(this.parentGrid){return l}l+=(b||"");var w=window.open("","_blank");w.document.write(l);w.document.write("<script>window.onerror=function(){return true;}<\/script>");w.document.close();if(this._fake){this._hrrar=u}};dhtmlXGridObject.prototype._printWidth=function(){var e=[];var d=0;for(var c=0;c<this._cCount;c++){var a=this.getColWidth(c);e.push(a);d+=a}var g=[];var b=0;for(var c=0;c<e.length;c++){var f=Math.floor((e[c]/d)*100);b+=f;g.push(f)}g[g.length-1]+=100-b;return g};dhtmlXGridObject.prototype.loadObject=function(a){};dhtmlXGridObject.prototype.loadJSONFile=function(a){};dhtmlXGridObject.prototype.serializeToObject=function(){};dhtmlXGridObject.prototype.serializeToJSON=function(){};if(!window.clipboardData){window.clipboardData={_make:function(){var b=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!b){return null}var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!a){return null}a.addDataFlavor("text/unicode");var c=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);this._p=[b,a,c];return true},setData:function(a,d){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){dhtmlxError.throwError("\u4e0d\u597d\u610f\u601d\uff0c\u590d\u5236\u9047\u5230\u95ee\u9898\u4e86","\u539f\u56e0\u662f\u526a\u8d34\u677f\u6743\u9650\u4e0d\u8db3\uff0c\u8bf7\u60a8\u4f7f\u7528IE\u7cfb\u5217\u6d4f\u89c8\u5668\uff01",[a,d]);return""}if(!this._make()){return false}this._p[2].data=d;this._p[1].setTransferData("text/unicode",this._p[2],d.length*2);var b=Components.interfaces.nsIClipboard;this._p[0].setData(this._p[1],null,b.kGlobalClipboard)},getData:function(a){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(c){dhtmlxError.throwError("\u4e0d\u597d\u610f\u601d\uff0c\u9ecf\u8d34\u9047\u5230\u95ee\u9898\u4e86","\u539f\u56e0\u662f\u526a\u8d34\u677f\u6743\u9650\u4e0d\u8db3\uff0c\u8bf7\u60a8\u4f7f\u7528IE\u7cfb\u5217\u6d4f\u89c8\u5668\uff01",[a]);return""}if(!this._make()){return false}this._p[0].getData(this._p[1],this._p[0].kGlobalClipboard);var b=new Object();var d=new Object();try{this._p[1].getTransferData("text/unicode",d,b)}catch(c){return""}if(d){d=d.value.QueryInterface(Components.interfaces.nsISupportsString)}if(d){return d.data.substring(0,b.value/2)}return""}}}dhtmlXGridObject.prototype.toPDF=function(b,k,j,p,r,c){k=k||"color";var e=k=="full_color";var l=c||"Excel\u5bfc\u51fa-"+new Date().getFullYear()+"\u5e74"+(new Date().getMonth()+1)+"\u6708"+new Date().getDate()+"\u65e5";var a=this;a._asCDATA=true;eXcell_ch.prototype.getContent=function(){return this.getValue()};eXcell_ra.prototype.getContent=function(){return this.getValue()};function f(v){var A=[];for(var y=1;y<a.hdr.rows.length;y++){A[y]=[];for(var x=0;x<a._cCount;x++){var C=a.hdr.rows[y].childNodes[x];if(!A[y][x]){A[y][x]=[0,0]}if(C){A[y][C._cellIndexS]=[C.colSpan,C.rowSpan]}}}var z="<rows profile='"+v+"'";if(j){z+=" header='"+j+"'"}if(p){z+=" footer='"+p+"'"}z+="><head>"+a._serialiseExportConfig(A).replace(/^<head/,"<columns").replace(/head>$/,"columns>");for(y=2;y<a.hdr.rows.length;y++){var t=0;var F=a.hdr.rows[y];var B="";for(x=0;x<a._cCount;x++){var E=A[y][x];var D=((E[0]&&E[0]>1)?' colspan="'+E[0]+'" ':"");if(E[1]&&E[1]>1){D+=' rowspan="'+E[1]+'" ';t=-1}var u="";for(var w=0;w<F.cells.length;w++){if(F.cells[w]._cellIndexS==x){if(F.cells[w].getElementsByTagName("SELECT").length){u=""}else{u=_isIE?F.cells[w].innerText:F.cells[w].textContent}u=u.replace(/[ \n\r\t\xA0]+/," ");break}}if(!u||u==" "){t++}B+="<column"+D+"><![CDATA["+u+"]]></column>"}if(t!=a._cCount){z+="\n<columns>"+B+"</columns>"}}z+="</head>\n";return z}function q(){var s=[];if(r){for(var t=0;t<r.length;t++){s.push(h(a.getRowIndex(r[t])))}}else{for(var t=0;t<a.getRowsNum();t++){s.push(h(t))}}return s.join("\n")}function g(){var u=["<foot>"];if(!a.ftr){return""}for(var v=1;v<a.ftr.rows.length;v++){u.push("<columns>");var y=a.ftr.rows[v];for(var t=0;t<a._cCount;t++){if(a._srClmn&&!a._srClmn[t]){continue}if(a._hrrar[t]){continue}for(var s=0;s<y.cells.length;s++){var x="";var w="";if(y.cells[s]._cellIndexS==t){x=_isIE?y.cells[s].innerText:y.cells[s].textContent;x=x.replace(/[ \n\r\t\xA0]+/," ");if(y.cells[s].colSpan&&y.cells[s].colSpan!=1){w=" colspan='"+y.cells[s].colSpan+"' "}break}}u.push("<column"+w+"><![CDATA["+x+"]]></column>")}u.push("</columns>")}u.push("</foot>");return u.join("\n")}function n(t,s){return(window.getComputedStyle?(window.getComputedStyle(t,null)[s]):(t.currentStyle?t.currentStyle[s]:null))||""}function h(w){if(!a.rowsBuffer[w]){return""}var v=a.render_row(w);if(v.style.display=="none"){return""}var t="<row>";for(var u=0;u<a._cCount;u++){if(((!a._srClmn)||(a._srClmn[u]))&&(!a._hrrar[u])){var s=a.cells(v.idd,u);if(e){var y=n(s.cell,"color");var x=n(s.cell,"backgroundColor");if(x=="transparent"||x=="rgba(0, 0, 0, 0)"){x="rgb(255,255,255)"}t+="<cell bgColor='"+x+"' textColor='"+y+"'>"}else{t+="<cell>"}t+="<![CDATA["+(s.getContent?s.getContent():s.getTitle())+"]]></cell>"}}return t+"</row>"}function o(){var s="</rows>";return s}var m="form_"+a.uid();var d=$("<form id='"+m+"' name='"+m+"' method=post target='_blank' action='"+b+"'></form>");$("body").append(d);d.css({display:"none"});d.append("<textarea name='grid_xml' id='grid_xml_"+m+"' ></textarea><input id='grid_name_"+m+"' name='grid_name' value='' />");$("#grid_name_"+m).val(l);$("#grid_xml_"+m).val(f(k).replace("\u2013","-")+q()+g()+o());d.submit();d.remove()};dhtmlXGridObject.prototype._serialiseExportConfig=function(e){var b="<head>";for(var d=0;d<this.hdr.rows[0].cells.length;d++){if(this._srClmn&&!this._srClmn[d]){continue}var c=this.fldSort[d];if(c=="cus"){c=this._customSorts[d].toString();c=c.replace(/function[\ ]*/,"").replace(/\([^\f]*/,"")}var f=e[1][d];var h=((f[1]&&f[1]>1)?' rowspan="'+f[1]+'" ':"")+((f[0]&&f[0]>1)?' colspan="'+f[0]+'" ':"");b+="<column "+h+" width='"+this.getColWidth(d)+"' align='"+this.cellAlign[d]+"' type='"+this.cellType[d]+"' sort='"+(c||"na")+"' color='"+(this.columnColor[d]||"")+"'"+(this.columnIds[d]?(" id='"+this.columnIds[d]+"'"):"")+">";if(this._asCDATA){b+="<![CDATA["+this.getHeaderCol(d)+"]]>"}else{b+=this.getHeaderCol(d)}var g=this.getCombo(d);if(g){for(var a=0;a<g.keys.length;a++){b+="<option value='"+g.keys[a]+"'>"+g.values[a]+"</option>"}}b+="</column>"}return b+="</head>"};dhtmlXGridObject.prototype.toExcel=dhtmlXGridObject.prototype.toPDF;
