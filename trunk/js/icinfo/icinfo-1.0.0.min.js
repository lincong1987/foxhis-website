/*
 * The Icinfo Javascript Lite Lib Red Star.
 *
 * http://www.icinfo.com.cn
 *
 * editor lc
 * date 2012-8-14 17:30:04
 *
 * based on baidu tangram 1.5.2.2
 * http://tangram.baidu.com
 */
var R,icinfo=R=icinfo||{version:"1.0.0",PERIOD:".",debug:false,noop:function(){}};window.console=window.console||{log:function(){}};icinfo.namespace=function(){var c=arguments,k,g=0,f,h,b;for(;g<c.length;g++){k=this;b=c[g];if(b.indexOf(this.PERIOD)>-1){h=b.split(this.PERIOD);for(f=(h[0]=="icinfo")?1:0;f<h.length;f++){k[h[f]]=k[h[f]]||{};k=k[h[f]]}}else{k[b]=k[b]||{};k=k[b]}}return k};icinfo.string=icinfo.string||{};icinfo.string.trim=function(a){return String(a).replace(new RegExp("(^[\\s\\t\\xa0\\u3000]+)|([\\u3000\\xa0\\s\\t]+\x24)","g"),"")};icinfo.trim=icinfo.string.trim;icinfo.string.byteLength=function(a){return String(a).replace(/[^\x00-\xff]/g,"ci").length};icinfo.byteLength=icinfo.string.byteLength;icinfo.string.byteSubstr=function(c,b,a){c=String(c);a=a||"";if(b<0||icinfo.string.byteLength(c)<=b){return c+a}c=c.substr(0,b).replace(/([^\x00-\xff])/g,"\x241 ").substr(0,b).replace(/[^\x00-\xff]$/,"").replace(/([^\x00-\xff]) /g,"\x241");return c+a};icinfo.byteSubstr=icinfo.string.byteSubstr;icinfo.string.toCamel=function(a){if(a.indexOf("-")<0&&a.indexOf("_")<0){return a}return a.replace(/[-_][^-_]/g,function(b){return b.charAt(1).toUpperCase()})};icinfo.toCamel=icinfo.string.toCamel;icinfo.string.decodeHTML=function(a){var b=String(a).replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&");return b.replace(/&#([\d]+);/g,function(d,c){return String.fromCharCode(parseInt(c,10))})};icinfo.decodeHTML=icinfo.string.decodeHTML;icinfo.string.encodeHTML=function(a){return String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")};icinfo.encodeHTML=icinfo.string.encodeHTML;icinfo.array=icinfo.array||{};icinfo.array.indexOf=function(f,b,d){var a=f.length,c=b;d=d|0;if(d<0){d=Math.max(0,a+d)}for(;d<a;d++){if(d in f&&f[d]===b){return d}}return -1};icinfo.array.contains=function(a,b){return(icinfo.array.indexOf(a,b)>=0)};icinfo.array.unique=function(f,g){var b=f.length,a=f.slice(0),d,c;if("function"!==typeof g){g=function(i,h){return i===h}}while(--b>0){c=a[b];d=b;while(d--){if(g(c,a[d])){a.splice(b,1);break}}}return a};icinfo.array.hash=function(f,b){var g={},d=b&&b.length,c=0,a=f.length;for(;c<a;c++){g[f[c]]=(d&&d>c)?b[c]:true}return g};icinfo.array.remove=function(c,b){var a=c.length;while(a--){if(a in c&&c[a]===b){c.splice(a,1)}}return c};icinfo.array.reduce=function(g,c,d){var b=0,a=g.length,f=0;if(arguments.length<3){for(;b<a;b++){d=g[b++];f=1;break}if(!f){return}}for(;b<a;b++){if(b in g){d=c(d,g[b],b,g)}}return d};icinfo.array.map=function(g,f,b){var d=[],c=0,a=g.length;for(;c<a;c++){d[c]=f.call(b||g,g[c],c)}return d};icinfo.cookie=icinfo.cookie||{};icinfo.cookie._isValidKey=function(a){return(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+\x24')).test(a)};icinfo.cookie.setRaw=function(c,d,b){if(!icinfo.cookie._isValidKey(c)){return}b=b||{};var a=b.expires;if("number"===typeof b.expires){a=new Date();a.setTime(a.getTime()+b.expires)}document.cookie=c+"="+d+(b.path?"; path="+b.path:"")+(a?"; expires="+a.toGMTString():"")+(b.domain?"; domain="+b.domain:"")+(b.secure?"; secure":"")};icinfo.cookie.set=function(b,c,a){icinfo.cookie.setRaw(b,encodeURIComponent(c),a)};icinfo.cookie.getRaw=function(b){if(icinfo.cookie._isValidKey(b)){var c=new RegExp("(^| )"+b+"=([^;]*)(;|\x24)"),a=c.exec(document.cookie);if(a){return a[2]||null}}return null};icinfo.cookie.get=function(a){var b=icinfo.cookie.getRaw(a);if("string"===typeof b){b=decodeURIComponent(b);return b}return null};icinfo.date=icinfo.date||{};icinfo.date.now=function(){return(new Date()).getTime()};icinfo.now=icinfo.date.now;icinfo.date.parse=function(c){var a=new RegExp("^\\d+(\\-|\\/)\\d+(\\-|\\/)\\d+\x24");if("string"===typeof c){if(a.test(c)||isNaN(Date.parse(c))){var g=c.split(/ |T/),b=g.length>1?g[1].split(/[^\d]/):[0,0,0],f=g[0].split(/[^\d]/);return new Date(f[0]-0,f[1]-1,f[2]-0,b[0]-0,b[1]-0,b[2]-0)}else{return new Date(c)}}return new Date()};icinfo.date.format=function(o){o=o||{};var d={date:null,dateObj:null,time:null,format:"{yyyy}-{MM}-{dd}"};var b=icinfo.extend(d,o);if(b.date===null&&b.dateObj===null&&b.time===null){return""}var c=null;if(b.date!==null){c=icinfo.date.parse(b.date)}if(b.time!==null){c=new Date();c.setTime(b.time)}if(b.dateObj!==null){c=new Date();if(!b.dateObj.time){return""}c.setTime(b.dateObj.time)}if(!(c instanceof Date)){return""}var p=("Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday").split("_");var k=("Sun_Mon_Tue_Wed_Thu_Fri_Sat").split("_");var n=("\u661f\u671f\u65e5,\u661f\u671f\u4e00,\u661f\u671f\u4e8c,\u661f\u671f\u4e09,\u661f\u671f\u56db,\u661f\u671f\u4e94,\u661f\u671f\u516d").split(",");var j=("\u5468\u65e5,\u5468\u4e00,\u5468\u4e8c,\u5468\u4e09,\u5468\u56db,\u5468\u4e94,\u5468\u516d").split(",");var m=("\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d").split(",");var g=("January,February,March,April,May,June,July,August,September,October,November,December").split(",");var h=("Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec").split(",");var a=("\u4e00\u6708,\u4e8c\u6708,\u4e09\u6708,\u56db\u6708,\u4e94\u6708,\u516d\u6708,\u4e03\u6708,\u516b\u6708,\u4e5d\u6708,\u5341\u6708,\u5341\u4e00\u6708,\u5341\u4e8c\u6708").split(",");var i=("\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d,\u4e03,\u516b,\u4e5d,\u5341,\u5341\u4e00,\u5341\u4e8c").split(",");var l={yyyy:c.getFullYear().toString(),yyy:c.getYear().toString(),M:(c.getMonth()+1).toString(),MM:icinfo.number.pad((c.getMonth()+1),2),MMM:h[c.getMonth()],MMMM:g[c.getMonth()],MC:a[c.getMonth()],MCS:i[c.getMonth()],dd:icinfo.number.pad(c.getDate(),2),d:c.getDate().toString(),HH:icinfo.number.pad(c.getHours(),2),H:c.getHours().toString(),mm:icinfo.number.pad(c.getMinutes(),2),m:c.getMinutes().toString(),ss:icinfo.number.pad(c.getSeconds(),2),s:c.getSeconds().toString(),w:c.getDay().toString(),DD:p[c.getDay()],D:k[c.getDay()],DCL:n[c.getDay()],DC:j[c.getDay()],DCS:m[c.getDay()]};var f=b.format;if(icinfo.trim(f)===""){return""}return f.replace(/{yyyy}/g,l.yyyy).replace(/{yyy}/g,l.yyy).replace(/{MMMM}/g,l.MMMM).replace(/{MMM}/g,l.MMM).replace(/{MM}/g,l.MM).replace(/{MC}/g,l.MC).replace(/{MCS}/g,l.MCS).replace(/{M}/g,l.M).replace(/{dd}/g,l.dd).replace(/{d}/g,l.d).replace(/{HH}/g,l.HH).replace(/{H}/g,l.H).replace(/{mm}/g,l.mm).replace(/{m}/g,l.m).replace(/{ss}/g,l.ss).replace(/{s}/g,l.s).replace(/{w}/g,l.w).replace(/{DD}/g,l.DD).replace(/{DCL}/g,l.DCL).replace(/{DCS}/g,l.DCS).replace(/{DC}/g,l.DC).replace(/{D}/g,l.D)};icinfo.object=icinfo.object||{};icinfo.object.extend=function(c,a){for(var b in a){if(a.hasOwnProperty(b)){c[b]=a[b]}}return c};icinfo.extend=icinfo.object.extend;icinfo.object.keys=function(d){var a=[],c=0,b;for(b in d){if(d.hasOwnProperty(b)){a[c++]=b}}return a};icinfo.object.values=function(d){var a=[],c=0,b;for(b in d){if(d.hasOwnProperty(b)){a[c++]=d[b]}}return a};icinfo.object.each=function(f,c){var b,a,d;if("function"===typeof c){for(a in f){if(f.hasOwnProperty(a)){d=f[a];b=c.call(f,d,a);if(b===false){break}}}}return f};icinfo.object.map=function(d,c){var b={};for(var a in d){if(d.hasOwnProperty(a)){b[a]=c(d[a],a)}}return b};icinfo.number=icinfo.number||{};icinfo.number.encomma=function(b,a){if(!a||a<1){a=3}b=String(b).split(".");b[0]=b[0].replace(new RegExp("(\\d)(?=(\\d{"+a+"})+$)","ig"),"$1,");return b.join(".")};icinfo.number.decomma=function(a){return a.toString().replace(/\,|\./g,"")};icinfo.number.pad=function(d,c){var f="",b=(d<0),a=String(Math.abs(d));if(a.length<c){f=(new Array(c-a.length+1)).join("0")}return(b?"-":"")+f+a};icinfo.number.random=function(b,a){return Math.floor(Math.random()*(a-b+1)+b)};icinfo.url=icinfo.url||{};icinfo.url.parse=function(a){a=a||location.href;var g=a.substr(a.lastIndexOf("?")+1),c=g.split("&"),f=c.length,l={},d=0,j,h,k,b;for(;d<f;d++){if(!c[d]){continue}b=c[d].split("=");j=b[0];h=b[1];k=l[j];if("undefined"===typeof k){l[j]=h}else{if(icinfo.lang.isArray(k)){k.push(h)}else{l[j]=[k,h]}}}return l};icinfo.url.getParameter=function(c,b){b=b||location.href;var d=new RegExp("(^|&|\\?|#)"+c+"=([^&#]*)(&|\x24|#)","");var a=b.match(d);if(a){return a[2]}return null};icinfo.url.escape=function(a){return String(a).replace(/[#%&+=\/\\\ \ \f\r\n\t]/g,function(b){return"%"+(256+b.charCodeAt()).toString(16).substring(1).toUpperCase()})};icinfo.platform=icinfo.platform||{};icinfo.platform.isAndroid=/android/i.test(navigator.userAgent);icinfo.platform.isIphone=/iphone/i.test(navigator.userAgent);icinfo.platform.isX11=/x11/i.test(navigator.userAgent);icinfo.platform.isMac=/macintosh/i.test(navigator.userAgent);icinfo.platform.isWindows=/windows/i.test(navigator.userAgent);icinfo.platform.isX11=/x11/i.test(navigator.userAgent);icinfo.lang=icinfo.lang||{};icinfo.uuid=icinfo.lang.uuid=100000000;icinfo.lang.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};icinfo.lang.isBoolean=function(a){return typeof a==="boolean"};icinfo.lang.isDate=function(a){return Object.toString.call(a)==="[object Date]"&&a.toString()!=="Invalid Date"&&!isNaN(a)};icinfo.lang.isElement=function(a){return !!(a&&a.nodeName&&a.nodeType==1)};icinfo.lang.isFunction=function(a){return"[object Function]"===Object.prototype.toString.call(a)};icinfo.lang.isNumber=function(a){return"[object Number]"===Object.prototype.toString.call(a)&&isFinite(a)};icinfo.lang.isObject=function(a){return"function"===typeof a||!!(a&&"object"===typeof a)};icinfo.lang.isString=function(a){return"[object String]"===Object.prototype.toString.call(a)};icinfo.lang.toArray=function(b){if(b===null||b===undefined){return[]}if(icinfo.lang.isArray(b)){return b}if(typeof b.length!=="number"||typeof b==="string"||icinfo.lang.isFunction(b)){return[b]}if(b.item){var a=b.length,c=new Array(a);while(a--){c[a]=b[a]}return c}return[].slice.call(b)};icinfo.isArray=icinfo.lang.isArray;icinfo.isBoolean=icinfo.lang.isBoolean;icinfo.isDate=icinfo.lang.isDate;icinfo.isElement=icinfo.lang.isElement;icinfo.isFunction=icinfo.lang.isFunction;icinfo.isNumber=icinfo.lang.isNumber;icinfo.isObject=icinfo.lang.isObject;icinfo.isString=icinfo.lang.isString;icinfo.toArray=icinfo.lang.toArray;icinfo.browser=icinfo.browser||{};icinfo.browser.ie=icinfo.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?(document.documentMode||+RegExp["\x241"]):undefined;icinfo.browser.firefox=/firefox\/(\d+\.\d+)/i.test(navigator.userAgent)?+RegExp["\x241"]:undefined;icinfo.browser.chrome=/chrome\/(\d+\.\d+)/i.test(navigator.userAgent)?+RegExp["\x241"]:undefined;icinfo.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);icinfo.browser.isStrict=document.compatMode==="CSS1Compat";icinfo.browser.isWebkit=/webkit/i.test(navigator.userAgent);try{if(/(\d+\.\d+)/.test(external.max_version)){icinfo.browser.maxthon=+RegExp["\x241"]}}catch(e){}icinfo.browser.opera=/opera(\/| )(\d+(\.\d+)?)(.+?(version\/(\d+(\.\d+)?)))?/i.test(navigator.userAgent)?+(RegExp["\x246"]||RegExp["\x242"]):undefined;icinfo.browser.safari=/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(navigator.userAgent)&&!/chrome/i.test(navigator.userAgent)?+(RegExp["\x241"]||RegExp["\x242"]):undefined;icinfo.history=icinfo.history||{};(function(){var f;var d;var c;function h(i){var j=c.contentWindow.document;i=i||"#";j.open();j.write('<script>window.top.location.hash="'+i+'";<\/script>');j.close();j.location.hash=i}function g(){d&&d();f=(window.location.hash.replace(/^#/,"")||"");console.log("_hashChangeCallBack>>",f)}function a(){var i=location.hash.replace(/^#/,"");if(i!==f){c?h(i):g()}}function b(i){f=("");if(i){d=i}if(icinfo.browser.ie){c=document.createElement("iframe");c.style.display="none";document.body.appendChild(c);h(window.location.hash);c.attachEvent("onload",function(){g()});setInterval(a,100)}else{if(icinfo.browser.firefox<3.6){setInterval(a,100)}else{if(f!==location.hash.replace(/^#/,"")){f=(window.location.hash.replace(/^#/,"")||"")}window.onhashchange=g;console.log("icinfo.history.listen>>>",f)}}}icinfo.history.listen=b})();icinfo.json=icinfo.json||{};icinfo.json.parse=function(a){return(new Function("return ("+a+")"))()};icinfo.json.decode=icinfo.json.parse;icinfo.json.stringify=(function(){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function a(g){if(/["\\\x00-\x1f]/.test(g)){g=g.replace(/["\\\x00-\x1f]/g,function(h){var i=b[h];if(i){return i}i=h.charCodeAt();return"\\u00"+Math.floor(i/16).toString(16)+(i%16).toString(16)})}return'"'+g+'"'}function d(n){var h=["["],j=n.length,g,k,m;for(k=0;k<j;k++){m=n[k];switch(typeof m){case"undefined":case"function":case"unknown":break;default:if(g){h.push(",")}h.push(icinfo.json.stringify(m));g=1}}h.push("]");return h.join("")}function c(g){return g<10?"0"+g:g}function f(g){return'"'+g.getFullYear()+"-"+c(g.getMonth()+1)+"-"+c(g.getDate())+"T"+c(g.getHours())+":"+c(g.getMinutes())+":"+c(g.getSeconds())+'"'}return function(l){switch(typeof l){case"undefined":return"undefined";case"number":return isFinite(l)?String(l):"null";case"string":return a(l);case"boolean":return String(l);default:if(l===null){return"null"}else{if(l instanceof Array){return d(l)}else{if(l instanceof Date){return f(l)}else{var h=["{"],k=icinfo.json.stringify,g,j;for(var i in l){if(Object.prototype.hasOwnProperty.call(l,i)){j=l[i];switch(typeof j){case"undefined":case"unknown":case"function":break;default:if(g){h.push(",")}g=1;h.push(k(i)+":"+k(j))}}}h.push("}");return h.join("")}}}}}})();icinfo.json.encode=icinfo.json.stringify;icinfo.forEach=function(a,f,d){var c,g,b;if(typeof f=="function"&&a){if(typeof a.length=="number"){for(c=0,g=a.length;c<g;c++){b=a[c]||(a.charAt&&a.charAt(c));f.call(d||null,b,c,a)}}else{if(typeof a=="number"){for(c=0;c<a;c++){f.call(d||null,c,c,c)}}else{if(typeof a=="object"){for(c in a){if(a.hasOwnProperty(c)){f.call(d||null,a[c],c,a)}}}}}}return a};icinfo.type=(function(){var b={},a=[,"HTMLElement","Attribute","Text",,,,,"Comment","Document",,"DocumentFragment",],d="Array Boolean Date Error Function Number RegExp String",c=b.toString;icinfo.forEach(d.split(" "),function(f){b["[object "+f+"]"]=f.toLowerCase();icinfo["is"+f]=function(g){return icinfo.type(g)==f.toLowerCase()}});return function(g){var f=typeof g;return f!="object"?f:g==null?"null":g._type_||b[c.call(g)]||a[g.nodeType]||(g==g.window?"Window":"")||"object"}})();icinfo.data=icinfo.data||{};icinfo.data.set=function(b,c){var d=window.top,a=d["$ICINFO_CACHE$"]||{};d["$ICINFO_CACHE$"]=a;return a[b]=c};icinfo.data.get=function(b){var c=window.top,a=c["$ICINFO_CACHE$"]||{};c["$ICINFO_CACHE$"]=a;return a[b]};icinfo.data.remove=function(b){var a=window.top["$ICINFO_CACHE$"];if(a&&a[b]){delete a[b]}};icinfo.data.clear=function(){window.top["$ICINFO_CACHE$"]={}};icinfo.data.getAll=function(){var b=window.top,a=b["$ICINFO_CACHE$"]||{};b["$ICINFO_CACHE$"]=a;return a};icinfo.loader={};icinfo.loader.css=function(a,d){var c=document.getElementsByTagName("HEAD")[0];var b=document.createElement("link");console.log("link>> created");link.type="text/css";link.rel="stylesheet";link.href=a+=(a.indexOf("?")>0?"&":"?");c.insertBefore(b,c.firstChild);if(d){d()}};icinfo.loader.js=function(b,d){var c=document.getElementsByTagName("HEAD")[0];var a=document.createElement("script");console.log("script>> created");a.src=b+=(b.indexOf("?")>0?"&":"?")+"_timestamp="+~new Date;a.charset="utf-8";a.async=false;console.log("script>> src attr setted >>> ",b);c.insertBefore(a,c.firstChild);console.log("script>> loading...");a.onload=a.onreadystatechange=function(){console.log("script>> script.onreadystatechanged >>> ",this.readyState);if((!this.readyState)||this.readyState==="loaded"||this.readyState==="complete"){if(d){d()}}};a.onerror=function(){a.onload=a.onerror=undefined;console.log("script>> load fail");c.removeChild(a)}};icinfo.api={proxy:""};icinfo.api.getApp=function(a){};icinfo.api.getAppWindow=function(a){};icinfo.api.message=function(a){if(icinfo.api.proxy===""){console.log("icinfo.api.proxy is undefined");return}icinfo.api.send("message",{message:a})};icinfo.api.dialog=function(a){if(icinfo.api.proxy===""){console.log("icinfo.api.proxy is undefined");return}icinfo.api.send("dialog",a)};icinfo.api.send=function(c,a){var h="proxy_"+new Date().getTime();var f={proxy:h,type:c,data:a};var d=encodeURIComponent(icinfo.json.encode(f));var g=icinfo.api.proxy+"#"+d;if(icinfo.ie&&g.length>2000){console.log("icinfo.api.proxy: Message Body Is Too Large.");return}var b=document.createElement("iframe");b.src=g;b.name=b.id=f.proxy;b.style.display="none";document.body.insertBefore(b);console.log("proxy>>> ",icinfo.api.proxy+"#"+d)};icinfo.form={};icinfo.form.arrayToInput=function(b,d,c){var a=[];$.each(d,function(g,h){for(var f in h){a.push("<input type='hidden' name='"+b+"["+g+"]."+f+"' value='"+(c&&c[f]?c[f](h[f],h,this):h[f])+"' />\n")}});return a.join("")};icinfo.form.arraySerialize=function(a,d,c){if(typeof a!=="string"){return{}}var b={};$.each(d,function(g,h){for(var f in h){b[a+"["+g+"]."+f]=c&&c[f]?c[f](h[f],h,this):h[f]}});return b};icinfo.form.validate=function(){return};icinfo.seal={list:{},host:"",controller:{},defaults:{errors:[],namespace:"",top:0,left:0,height:161,width:161,position:"absolute",id:"",content:"",entName:"",className:"",classid:"clsid:3C78C8A9-AF7C-4430-A332-21A2D59F9AEA",strEnterpriseName:"",SignatureID:"",SignatureCert:"",iGetSignData:"",success:icinfo.noop,error:icinfo.noop,onControllerInit:icinfo.noop,onSealInit:icinfo.noop,onSealCreate:icinfo.noop,onSealCreateComplete:icinfo.noop}};icinfo.seal.server={UploadSignInfoUrl:"/rest/sign-rest!localSignedXML.xml",RemoteSignUrl:"/rest/sign-rest!remoteSignedXML.xml",DownloadSignInfoUrl:"/rest/sign-rest!getSignedInfoXML.xml",DownloadSignCertUrl:"/rest/sign-rest!getSignedCertXML.xml",DownloadSignImgUrl:"/rest/sign-rest!getSignedImgXML.xml",RemoteVerifyUrl:"/rest/sign-rest!checkSignInfoXML.xml",DownloadUserInfoUrl:"/rest/user-rest!getSealsOfUserByCertXML.xml",DownloadThumbnailUrl:"/rest/seal-rest"};icinfo.seal.events={OnPreCreateSealElement:"create",OnElementResize:"resize",OnRemoteVerifyEnd:"verify",OnRemoteVerifyError:"verifyError",OnSignEnd:"sign",OnElementDelete:"remove"};icinfo.seal.event={create:function(b){var c=document.createElement("object");c.setAttribute("classid","clsid:3C78C8A9-AF7C-4430-A332-21A2D59F9AEA");c.style.position=b.position;c.style.top=b.top;c.style.left=b.left;c.style.width=b.width;c.style.height=b.height;try{var a=icinfo.seal.define(b.namespace);document.body.appendChild(c);a.iShieldNotify(0);a.iInitControl(c,c);a.iFillControl(c,c);if(!icinfo.seal.list[b.namespace]){icinfo.seal.list[b.namespace]=[]}c.signId=c.SignatureID;icinfo.seal.list[b.namespace].push({options:b,seal:c});b.success(c,a,b)}catch(d){b.error("message",d.message)}},resize:function(){},verify:function(){},verifyError:function(){},sign:function(){},remove:function(){},width:function(a,b){if(!b){a.style.width=parseInt(b)+"px"}return parseInt(a.style.width,10)},height:function(a,b){if(!b){a.style.width=parseInt(b)+"px"}return parseInt(a.style.width,10)},offset:function(a,b){if(!b){a.style.top=parseInt(b.top||0)+"px";a.style.top=parseInt(b.top||0)+"px"}return{top:parseInt(a.style.top,10),left:parseInt(a.style.left,10)}}};icinfo.seal.define=function(c,a,d){if(c in this.controller){if(d){d(this)}return this.controller[c]}var b=icinfo.isString(a)?document.getElementById(a):a;if(!b){b=document.createElement("object");b.id=c;b.style.display="none";b.setAttribute("classid","CLSID:8040AA3B-40EC-4038-8EE1-1A1D6198FDE2");document.body.appendChild(b)}this.controller[c]=b;if(d){d(this)}return this.controller[c]};icinfo.seal.init=function(b){b.errors=[];var c=this;if(!icinfo.ie||!b.namespace||c.host.replace(/ /g,"")===""){b.errors.push("message","Icinfo Seal Environment Error.");return null}if(b.namespace in this.controller){return this.controller[b.namespace]}var a=this.define(b.namespace,b.namespace);try{icinfo.object.each(c.server,function(g,f){a[f]=c.host+""+g});a.attachEvent("OnPreCreateSealElement",function(){c.event.create(b)});a.iInitialize();if(0!==a.iIsInitialized()){b.errors.push("message","Icinfo Seal Controller Is Not Initialized.");return null}}catch(d){b.error("message","Icinfo Seal Controller Initialize Error.",b.errors)}return this.controller[b.namespace]};icinfo.seal.error=function(a){var b={cus:0,sys:0};try{b.cus=a.iErrorCode(0);b.sys=a.iErrorCode(1)}catch(c){}return b};icinfo.seal.create=function(d){var c=this;var b=icinfo.extend(this.defaults,d);b.signId=(b.signId||b.SignatureID||"").toString();if(b.signId.replace(/ /g,"")!==""){this.load(d);return}var a=null;try{a=c.init(b);if(a===null){b.errors.push("message","Icinfo Seal Controller Is Not Defined.");return}}catch(f){b.error("error",f.message,b.errors);return}try{a.iSealSign(b.content,"MaskContent",0,0)}catch(f){b.error("error",c.error(a),b.errors);return}};icinfo.seal.load=function(d){var c=this;var b=icinfo.extend(this.defaults,d);if(!b.signId||b.signId.toString().replace(/ /g,"")===""){b.error("message","Icinfo Seal signId Is Not Defined.",b.errors);return}var a=null;try{a=c.init(b);if(a===null){b.error("message","Icinfo Seal Controller Is Not Defined.",b.errors);return}}catch(f){b.error("error",f.message,b.errors);return}try{a.iLoadHtmlSeal(b.signId,2759,0,0)}catch(f){b.error("error",c.error(a),b.errors);return}};icinfo.cert={version:"1.0.1",host:"",ra:"",i18n:"zh-cn",defaults:{errors:[],support:"1;3",namespace:"HX_CERT",controller:null,nbxh:"",randCode:"",myKey:"",keytype:"",keysn:"",data:{},timeout:30000,onGetKeyCount:function(){return true},onGetCertCount:function(){return true},onBeforeFormat:function(){return true},onFormat:icinfo.noop(),onAfterFormat:icinfo.noop(),onInit:icinfo.noop(),success:icinfo.noop(),error:icinfo.noop()},ERR:{render:function(d,c){var a=icinfo.cert;var b=this[a.i18n]&&this[a.i18n][d]&&this[a.i18n][d];if(typeof c=="undefined"){return b}if(!icinfo.isObject(c)||!icinfo.isArray(c)){b=b.replace(new RegExp("\\{0\\}","gi"),c)}if(icinfo.isObject(c)){icinfo.object.each(c,function(g,f){b=b.replace(new RegExp("\\{"+f+"\\}","gi"),g)})}if(icinfo.isArray(c)){icinfo.array.map(c,function(g,f){b=b.replace(new RegExp("\\{"+f+"\\}","gi"),g)})}return b},"en-us":{1:"Icinfo Cert Environment Error.",2:"Icinfo Cert Key SetSupportKeyTypes({0}) Error.",3:"Icinfo Cert Key Count({0}) Error.",4:"Icinfo Cert Controller Initialize Error.",5:"Icinfo Cert Controller Is Not Defined.",6:"Icinfo Cert Get Ra Server Error When KeyType Is {0}.",7:"Icinfo Cert Format Error(rastate is {0}).",8:"Icinfo Cert Format Error.",9:"Icinfo Cert Host Is Not Defined.",10:"Icinfo Cert jQuery Is Not Defined.",11:"Icinfo Cert CertCount({0}) Over 1 Is Not Allowed, Please Format Key First.",12:"Icinfo Cert Ra Error ({0} {1} {2}).",13:"Icinfo Cert Create Error.",14:"Icinfo Cert Can Not Caught Key Info Error.",15:"Icinfo Cert Can Not Caught Key Serial Number Error."},"zh-cn":{1:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u73af\u5883\u68c0\u6d4b\u5931\u8d25\u3002",2:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u8bbe\u7f6ekey\u7c7b\u578b({0})\u5f02\u5e38\u3002",3:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u68c0\u6d4bkey\u6570\u91cf({0})\u5f02\u5e38\u3002",4:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u521d\u59cb\u5316\u5931\u8d25\u3002",5:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u65e0\u6cd5\u83b7\u53d6\u3002",6:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u6ca1\u6709\u5b9a\u4e49RA\u8bf7\u6c42\u5730\u5740\u5728Key\u7c7b\u578b\u4e3a{0}\u65f6\u3002",7:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u683c\u5f0f\u5316\u5931\u8d25(RA\u72b6\u6001\u7801\u4e3a{0})\u3002",8:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u683c\u5f0f\u5316\u5931\u8d25",9:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\uff0c\u8bc1\u4e66\u5904\u7406\u670d\u52a1\u5730\u5740\u6ca1\u6709\u914d\u7f6e\u3002",10:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\uff0c\u6ca1\u6709jQuery\u73af\u5883\u3002",11:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\uff0cKey\u5185\u6709{0}\u5f20\u4ee5\u4e0a\u8bc1\u4e66\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u8bf7\u5148\u6267\u884c\u683c\u5f0f\u5316\u3002",12:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\uff0cRA\u8fd4\u56de\u4e86\u9519\u8bef{0} {1} {2}\u3002",13:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\u3002",14:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\uff0c\u65e0\u6cd5\u83b7\u53d6Key\u4fe1\u606f\uff0c\u53ef\u80fd\u662f\u7528\u6237\u53d6\u6d88\u4e86\u64cd\u4f5c\u3002",15:"\u6c47\u4fe1\u5b89\u5168\u63a7\u4ef6\u5236\u8bc1\u5931\u8d25\uff0c\u65e0\u6cd5\u83b7\u53d6Key\u5e8f\u5217\u53f7\u3002"}},event:{onCreateZJCARequest:icinfo.noop,onCreatePKCS10request:icinfo.noop,onInstallPKCS7X509Cert:icinfo.noop,onInstallPfxCert:icinfo.noop,onSetKeyTypes:icinfo.noop,onGetKeyCount:icinfo.noop,onGetCertCount:icinfo.noop,onGetLastCert:icinfo.noop,onGetKeyType:icinfo.noop,onGetSn:icinfo.noop,onGetKeyInfo:icinfo.noop,onGetGetCspList:icinfo.noop,onGetErr:icinfo.noop,onFormatKey:icinfo.noop,onUnLockey:icinfo.noop,onCreateZJCACert:icinfo.noop}};icinfo.cert.define=function(b){if(!this.controller){var a=document.createElement("object");a.id=b;a.style.display="none";a.setAttribute("classid","CLSID:1DECBA92-5007-4A94-BDF7-BC4B553D3BCB");document.body.insertBefore(a);this.controller=a}return this.controller};icinfo.cert.init=function(b){b.errors=[];var a=this;if(!icinfo.ie||!b.namespace){b.errors.push(a.ERR.render(1));return null}this.controller=this.define(b.namespace);try{var c=a.setKeyTypes(a.controller,b.support);if(c!=0){b.errors.push(a.ERR.render(2,c));return}var d=a.controller.GetKeyCount();if(b.onGetKeyCount(d,a)==false){return}if(d!=1){b.errors.push(a.ERR.render(3,d));return}}catch(f){b.errors.push(a.ERR.render(4))}b.onInit(this.controller);return this.controller};icinfo.cert.createZJCARequest=function(a){var b=a?a.CreateZJCACertRequest():this.controller.CreateZJCACertRequest();this.event.onCreateZJCARequest(b);return b};icinfo.cert.getCertCount=function(a){var b=a?a.GetCertCountInKey():this.controller.GetCertCountInKey();this.event.onGetCertCount(b);return b};icinfo.cert.createZJCACert=function(a,b){var c=a?a.InstallZJCACert(b):this.controller.InstallZJCACert(b);this.event.onCreateZJCACert(c);return c};icinfo.cert.setKeyTypes=function(a,b){var c=a?a.SetSupportKeyTypes(b):this.controller.SetSupportKeyTypes(b);this.event.onSetKeyTypes(c,b);return c};icinfo.cert.getKeyCount=function(a){var b=a?a.GetKeyCount():this.controller.GetKeyCount();this.onGetKeyCount(b);return b};icinfo.cert.getLastCert=function(a,c){var b=a?a.GetNewestCertInKey(c):this.controller.GetNewestCertInKey(c);this.event.onGetLastCert(b);return b};icinfo.cert.getErr=function(a){var b=a?a.GetHxLastErrInfo():this.controller.GetHxLastErrInfo();this.event.onGetErr(b);return b};icinfo.cert.createPKCS10request=function(a){var b=a?a.CreatePKCS10requestByCAPI():this.controller.CreatePKCS10requestByCAPI();this.event.onCreatePKCS10request(b);return b};icinfo.cert.installPKCS7X509Cert=function(a,b){var c=a?a.InstallPKCS7X509CertByCAPI(b):this.controller.InstallPKCS7X509CertByCAPI(b);this.event.onInstallPKCS7X509Cert(c);return c};icinfo.cert.installPfxCert=function(a,c,b){var d=a?a.InstallPfxCertByCAPI(c,b):this.controller.InstallPfxCertByCAPI(c,b);this.event.onInstallPfxCert(d);return d};icinfo.cert.getKeyType=function(a){var b=a?a.GetCurKeyType():this.controller.GetCurKeyType();this.event.onGetKeyType(b);return b};icinfo.cert.getSn=function(a){var b=a?a.GetKeySN():this.controller.GetKeySN();this.event.onGetSn(b);return b};icinfo.cert.getKeyInfo=function(a){var b=a?a.GetOnlineKeyInfo():this.controller.GetOnlineKeyInfo();this.event.onGetKeyInfo(b);return b};icinfo.cert.getGetCspList=function(b,a){var c=b?b.GetSysCspList(a):this.controller.GetSysCspList(a);this.event.onGetGetCspList(c);return c};icinfo.cert.formatKey=function(a,b){var c=a?a.FormatKey(b):this.controller.FormatKey(b);this.event.onFormatKey(c);return c};icinfo.cert.unLockKey=function(a,b,d){var c=a?a.UnLockKey(b,d):this.controller.UnLockKey(b,d);this.event.onUnLockey(c);return c};icinfo.cert.create=function(b){var a=this;var j=icinfo.extend(this.defaults,b);if(a.host.replace(/ /g,"")===""){j.error("message",a.ERR.render(9),j.errors);return}if(!jQuery){j.error("message",a.ERR.render(10),j.errors);return}var d=a.init(j);if(!d){j.error("message",a.ERR.render(5),j.errors);return}var g=0;var c="";var f="";var i="";try{c=a.createZJCARequest(d);if(icinfo.string.trim(c)==""){j.error("error",a.ERR.render(14),j.errors);return}g=a.getCertCount(d);if(j.onGetCertCount(g,c,f,i)==false){j.error("message",a.ERR.render(11,g),j.errors);return}if(g>1){j.error("message",a.ERR.render(11,g),j.errors);return}f=a.getKeyType(d)=="1"?"OLDKEY":"NEWKEY";i=a.getSn(d);if(icinfo.string.trim(i)==""){j.error("error",a.ERR.render(15),j.errors);return}jQuery.ajax({type:"post",dataType:"json",url:a.host,data:{"cert.nbxh":j.nbxh,"cert.randCode":j.randCode,"cert.myKey":c,"cert.keytype":f,"cert.keysn":i},error:function(m,l,k){alert("ajax error");j.error("error",a.ERR.render(12,[m.toString(),l.toString(),k.toString()]))},success:function(l){var m="";try{m=a.createZJCACert(d,l.raCode);if(m==0){j.success(l.raCode,c,f,i)}else{j.error("error",a.ERR.render(12,[l.raCode,"",""]))}}catch(k){j.error("error",a.ERR.render(12,[l.raCode,k.meaasge,""]))}}})}catch(h){j.error("error",a.ERR.render(13),(function(k){j.errors.push(k);try{j.errors.push(a.getErr(d))}catch(l){}return j.errors.join(", ")})(h));return}};icinfo.cert.format=function(f){var b=this;var d=icinfo.extend(this.defaults,f);var a=b.init(d);if(!a){d.error("message",b.ERR.render(5),d.errors);return}var g="";var c="";try{g=b.getKeyType(a);if(d.onBeforeFormat(g,a)==false){return}if(g==1&&b.ra.replace(/ /g,"")==""){d.error("message",b.ERR.render(6,g),d.errors);return}c=b.formatKey(a,g==1?b.ra:"");if(c==0){d.success(c,g,a)}else{d.errors.push(b.ERR.render(7,c))}}catch(h){d.error("error",b.ERR.render(8),(function(i){d.errors.push(i);return d.errors.join(", ")})(h),(function(){var j="";try{j=b.getErr(a)}catch(i){}return j})())}};icinfo.dom={_remove:function(a){this.empty(a);if(a.parentNode){a.parentNode.removeChild(a)}return a},remove:function(a){var d=this;if(icinfo.lang.isArray(a)){var c,b=0;for(;(c=a[b])!=null;b++){d._remove(c)}}else{d._remove(a)}return a},empty:function(a){if(icinfo.lang.isArray(a)){var c,b=0;for(;(c=a[b])!=null;b++){this._empty(c)}}else{this._empty(a)}return a},_empty:function(a){while(a.firstChild){a.removeChild(a.firstChild)}},show:function(a){},hide:function(a){}};icinfo.namespace("icinfo.singleton");icinfo.singleton=function(b){var a;return function(){return a||(a=b.apply(this,arguments))}};icinfo.namespace("icinfo.ui.progress");icinfo.ui.progress={version:"1.0.0",options:{value:0,max:100,top:0,left:0,position:"absolute",info:"\u8bf7\u7a0d\u7b49...",mask:true,change:icinfo.noop,complete:icinfo.noop},min:0,init:function(a){this.options=icinfo.extend(this.options,a);this._init();this._info();this._refreshValue()},destroy:function(){this.mask.style.display="none"},value:function(b,a){if(typeof b==="undefined"){return this._value()}if(typeof a!=="undefined"){this.info(a)}this._setOption("value",b);return this},info:function(a){if(typeof a!=="undefined"){this._setOption("info",a);this._info()}},_info:function(){this.msgDiv.innerHTML=this.options.info||""},_init:function(){if(!this.element){var b=document.createElement("div");var a=document.createElement("div");var c=document.createElement("div");this.mask=this.options.mask===true?icinfo.ui.mask.init():document.body;this.mask.insertBefore(c);this.mask.insertBefore(b);b.insertBefore(a);b.className="icinfo-ui-progressbar";a.className="icinfo-ui-progressbar-value";c.className="icinfo-ui-progressbar-msg";this.valueDiv=a;this.element=b;this.msgDiv=c}this.mask.style.display="block";return b},_refreshValue:function(){var b=this.value(),a=this._percentage();if(this.oldValue!==b){this.oldValue=b;this.options.change.call(this,this)}this.valueDiv.style.width=a.toFixed(0)+"%";this.element.setAttribute("aria-valuenow",b)},_setOption:function(a,b){if(a==="value"){this.options.value=b;this._refreshValue();if(this._value()===this.options.max){this.options.complete.call(this,this)}}else{this.options[a]=b}},_value:function(){var a=this.options.value;if(!icinfo.isNumber(parseInt(a,10))){a=0}return Math.min(this.options.max,Math.max(this.min,a))},_percentage:function(){return 100*this._value()/this.options.max}};icinfo.namespace("icinfo.ui.mask");icinfo.ui.mask={version:"1.0.0",options:{parent:document.body,position:"absolute"},init:function(a){this.options=icinfo.extend(this.options,a);this.options.parent=this.options.parent||document.body;return this._init()},destroy:function(){this.element.style.display="none"},_init:function(){if(!this.element){var a=document.createElement("div");a.className="icinfo-ui-mask";console.log(this.options.parent);this.options.parent.insertBefore(a);this.element=a}this.element.style.display="block";return this.element}};icinfo.loaded=true;
